"use strict";(self.webpackChunkprofile_page_2023=self.webpackChunkprofile_page_2023||[]).push([[179],{493:()=>{function At(n){return"function"==typeof n}function rl(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Yc=rl(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function sl(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Di{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(At(i))try{i()}catch(s){e=s instanceof Yc?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Pv(s)}catch(o){e=e??[],o instanceof Yc?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Yc(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Pv(e);else{if(e instanceof Di){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&sl(t,e)}remove(e){const{_finalizers:t}=this;t&&sl(t,e),e instanceof Di&&e._removeParent(this)}}Di.EMPTY=(()=>{const n=new Di;return n.closed=!0,n})();const Iv=Di.EMPTY;function Rv(n){return n instanceof Di||n&&"closed"in n&&At(n.remove)&&At(n.add)&&At(n.unsubscribe)}function Pv(n){At(n)?n():n.unsubscribe()}const Ds={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Zc={setTimeout(n,e,...t){const{delegate:i}=Zc;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Zc;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Lv(n){Zc.setTimeout(()=>{const{onUnhandledError:e}=Ds;if(!e)throw n;e(n)})}function Nv(){}const Q1=rf("C",void 0,void 0);function rf(n,e,t){return{kind:n,value:e,error:t}}let Es=null;function Jc(n){if(Ds.useDeprecatedSynchronousErrorHandling){const e=!Es;if(e&&(Es={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Es;if(Es=null,t)throw i}}else n()}class sf extends Di{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Rv(e)&&e.add(this)):this.destination=oT}static create(e,t,i){return new ol(e,t,i)}next(e){this.isStopped?lf(function tT(n){return rf("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?lf(function eT(n){return rf("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?lf(Q1,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const iT=Function.prototype.bind;function af(n,e){return iT.call(n,e)}class rT{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Kc(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Kc(i)}else Kc(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Kc(t)}}}class ol extends sf{constructor(e,t,i){let r;if(super(),At(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Ds.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&af(e.next,s),error:e.error&&af(e.error,s),complete:e.complete&&af(e.complete,s)}):r=e}this.destination=new rT(r)}}function Kc(n){Ds.useDeprecatedSynchronousErrorHandling?function nT(n){Ds.useDeprecatedSynchronousErrorHandling&&Es&&(Es.errorThrown=!0,Es.error=n)}(n):Lv(n)}function lf(n,e){const{onStoppedNotification:t}=Ds;t&&Zc.setTimeout(()=>t(n,e))}const oT={closed:!0,next:Nv,error:function sT(n){throw n},complete:Nv},cf="function"==typeof Symbol&&Symbol.observable||"@@observable";function Cs(n){return n}function Fv(n){return 0===n.length?Cs:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let on=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function cT(n){return n&&n instanceof sf||function lT(n){return n&&At(n.next)&&At(n.error)&&At(n.complete)}(n)&&Rv(n)}(t)?t:new ol(t,i,r);return Jc(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Ov(i))((r,s)=>{const o=new ol({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[cf](){return this}pipe(...t){return Fv(t)(this)}toPromise(t){return new(t=Ov(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Ov(n){var e;return null!==(e=n??Ds.Promise)&&void 0!==e?e:Promise}const uT=rl(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Mr=(()=>{class n extends on{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new kv(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new uT}next(t){Jc(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Jc(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Jc(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?Iv:(this.currentObservers=null,s.push(t),new Di(()=>{this.currentObservers=null,sl(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new on;return t.source=this,t}}return n.create=(e,t)=>new kv(e,t),n})();class kv extends Mr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:Iv}}function Bv(n){return At(n?.lift)}function fn(n){return e=>{if(Bv(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function pn(n,e,t,i,r){return new dT(n,e,t,i,r)}class dT extends sf{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function ot(n,e){return fn((t,i)=>{let r=0;t.subscribe(pn(i,s=>{i.next(n.call(e,s,r++))}))})}function Ts(n){return this instanceof Ts?(this.v=n,this):new Ts(n)}function mT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Vv(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const Hv=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Gv(n){return At(n?.then)}function Wv(n){return At(n[cf])}function $v(n){return Symbol.asyncIterator&&At(n?.[Symbol.asyncIterator])}function jv(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const qv=function yT(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Xv(n){return At(n?.[qv])}function Yv(n){return function pT(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(m,p){s.push([h,f,m,p])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof Ts?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(m){d(s[0][3],m)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Ts(t.read());if(r)return yield Ts(void 0);yield yield Ts(i)}}finally{t.releaseLock()}})}function Zv(n){return At(n?.getReader)}function Bi(n){if(n instanceof on)return n;if(null!=n){if(Wv(n))return function vT(n){return new on(e=>{const t=n[cf]();if(At(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Hv(n))return function _T(n){return new on(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Gv(n))return function xT(n){return new on(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Lv)})}(n);if($v(n))return Jv(n);if(Xv(n))return function wT(n){return new on(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Zv(n))return function bT(n){return Jv(Yv(n))}(n)}throw jv(n)}function Jv(n){return new on(e=>{(function MT(n,e){var t,i,r,s;return function hT(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=mT(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Sr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function _n(n,e,t=1/0){return At(e)?_n((i,r)=>ot((s,o)=>e(i,s,r,o))(Bi(n(i,r))),t):("number"==typeof e&&(t=e),fn((i,r)=>function ST(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=p=>c<i?m(p):l.push(p),m=p=>{s&&e.next(p),c++;let g=!1;Bi(t(p,u++)).subscribe(pn(e,v=>{r?.(v),s?f(v):e.next(v)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const v=l.shift();o?Sr(e,o,()=>m(v)):m(v)}h()}catch(v){e.error(v)}}))};return n.subscribe(pn(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function Mo(n=1/0){return _n(Cs,n)}const nr=new on(n=>n.complete());function df(n){return n[n.length-1]}function al(n){return function ET(n){return n&&At(n.schedule)}(df(n))?n.pop():void 0}function Kv(n,e=0){return fn((t,i)=>{t.subscribe(pn(i,r=>Sr(i,n,()=>i.next(r),e),()=>Sr(i,n,()=>i.complete(),e),r=>Sr(i,n,()=>i.error(r),e)))})}function Qv(n,e=0){return fn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function e0(n,e){if(!n)throw new Error("Iterable cannot be null");return new on(t=>{Sr(t,e,()=>{const i=n[Symbol.asyncIterator]();Sr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function an(n,e){return e?function NT(n,e){if(null!=n){if(Wv(n))return function AT(n,e){return Bi(n).pipe(Qv(e),Kv(e))}(n,e);if(Hv(n))return function RT(n,e){return new on(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Gv(n))return function IT(n,e){return Bi(n).pipe(Qv(e),Kv(e))}(n,e);if($v(n))return e0(n,e);if(Xv(n))return function PT(n,e){return new on(t=>{let i;return Sr(t,e,()=>{i=n[qv](),Sr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>At(i?.return)&&i.return()})}(n,e);if(Zv(n))return function LT(n,e){return e0(Yv(n),e)}(n,e)}throw jv(n)}(n,e):Bi(n)}function hf(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new ol({next:()=>{i.unsubscribe(),n()}});return Bi(e(...t)).subscribe(i)}function Et(n){for(let e in n)if(n[e]===Et)return e;throw Error("Could not find renamed property on target object.")}function It(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(It).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function pf(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const kT=Et({__forward_ref__:Et});function mf(n){return n.__forward_ref__=mf,n.toString=function(){return It(this())},n}function Oe(n){return gf(n)?n():n}function gf(n){return"function"==typeof n&&n.hasOwnProperty(kT)&&n.__forward_ref__===mf}function yf(n){return n&&!!n.\u0275providers}const t0="https://g.co/ng/security#xss";class ce extends Error{constructor(e,t){super(Qc(e,t)),this.code=e}}function Qc(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}function $e(n){return"string"==typeof n?n:null==n?"":String(n)}function eu(n,e){throw new ce(-201,!1)}function Ei(n,e){null==n&&function _t(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ge(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Kr(n){return{providers:n.providers||[],imports:n.imports||[]}}function tu(n){return n0(n,nu)||n0(n,s0)}function n0(n,e){return n.hasOwnProperty(e)?n[e]:null}function r0(n){return n&&(n.hasOwnProperty(vf)||n.hasOwnProperty(jT))?n[vf]:null}const nu=Et({\u0275prov:Et}),vf=Et({\u0275inj:Et}),s0=Et({ngInjectableDef:Et}),jT=Et({ngInjectorDef:Et});var ke=(()=>((ke=ke||{})[ke.Default=0]="Default",ke[ke.Host=1]="Host",ke[ke.Self=2]="Self",ke[ke.SkipSelf=4]="SkipSelf",ke[ke.Optional=8]="Optional",ke))();let _f;function Ci(n){const e=_f;return _f=n,e}function o0(n,e,t){const i=tu(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ke.Optional?null:void 0!==e?e:void eu(It(n))}const Pt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),ll={},xf="__NG_DI_FLAG__",iu="ngTempTokenPath",XT="ngTokenPath",YT=/\n/gm,ZT="\u0275",a0="__source";let cl;function So(n){const e=cl;return cl=n,e}function JT(n,e=ke.Default){if(void 0===cl)throw new ce(-203,!1);return null===cl?o0(n,void 0,e):cl.get(n,e&ke.Optional?null:void 0,e)}function Pe(n,e=ke.Default){return(function qT(){return _f}()||JT)(Oe(n),e)}function lt(n,e=ke.Default){return Pe(n,ru(e))}function ru(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function wf(n){const e=[];for(let t=0;t<n.length;t++){const i=Oe(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ce(900,!1);let r,s=ke.Default;for(let o=0;o<i.length;o++){const a=i[o],l=KT(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Pe(r,s))}else e.push(Pe(i))}return e}function ul(n,e){return n[xf]=e,n.prototype[xf]=e,n}function KT(n){return n[xf]}function Qr(n){return{toString:n}.toString()}var ir=(()=>((ir=ir||{})[ir.OnPush=0]="OnPush",ir[ir.Default=1]="Default",ir))(),rr=(()=>{return(n=rr||(rr={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",rr;var n})();const Dr={},yt=[],su=Et({\u0275cmp:Et}),bf=Et({\u0275dir:Et}),Mf=Et({\u0275pipe:Et}),c0=Et({\u0275mod:Et}),Er=Et({\u0275fac:Et}),dl=Et({__NG_ELEMENT_ID__:Et});let tA=0;function hl(n){return Qr(()=>{const t=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===ir.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||yt,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||rr.Emulated,id:"c"+tA++,styles:n.styles||yt,_:null,setInput:null,schemas:n.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=n.dependencies,o=n.features;return r.inputs=h0(n.inputs,i),r.outputs=h0(n.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(u0).filter(d0):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(On).filter(d0):null,r})}function u0(n){return xt(n)||Dn(n)}function d0(n){return null!==n}function As(n){return Qr(()=>({type:n.type,bootstrap:n.bootstrap||yt,declarations:n.declarations||yt,imports:n.imports||yt,exports:n.exports||yt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function h0(n,e){if(null==n)return Dr;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Fn=hl;function xt(n){return n[su]||null}function Dn(n){return n[bf]||null}function On(n){return n[Mf]||null}function li(n,e){const t=n[c0]||null;if(!t&&!0===e)throw new Error(`Type ${It(n)} does not have '\u0275mod' property.`);return t}const Cr=0,ge=1,Ze=2,zt=3,Ui=4,Is=5,En=6,Eo=7,Wt=8,ou=9,au=10,Qe=11,Sf=12,fl=13,f0=14,Co=15,Cn=16,pl=17,To=18,sr=19,ml=20,p0=21,Lt=22,Df=1,m0=2,lu=7,cu=8,Ao=9,kn=10;function ci(n){return Array.isArray(n)&&"object"==typeof n[Df]}function zi(n){return Array.isArray(n)&&!0===n[Df]}function Ef(n){return 0!=(4&n.flags)}function gl(n){return n.componentOffset>-1}function uu(n){return 1==(1&n.flags)}function Vi(n){return null!==n.template}function rA(n){return 0!=(256&n[Ze])}function Rs(n,e){return n.hasOwnProperty(Er)?n[Er]:null}class aA{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ps(){return v0}function v0(n){return n.type.prototype.ngOnChanges&&(n.setInput=cA),lA}function lA(){const n=x0(this),e=n?.current;if(e){const t=n.previous;if(t===Dr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function cA(n,e,t,i){const r=this.declaredInputs[t],s=x0(n)||function uA(n,e){return n[_0]=e}(n,{previous:Dr,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new aA(l&&l.currentValue,e,a===Dr),n[i]=e}Ps.ngInherit=!0;const _0="__ngSimpleChanges__";function x0(n){return n[_0]||null}const Ti=function(n,e,t){};function xn(n){for(;Array.isArray(n);)n=n[Cr];return n}function ui(n,e){return xn(e[n.index])}function M0(n,e){return n.data[e]}function di(n,e){const t=e[n];return ci(t)?t:t[Cr]}function hu(n){return 64==(64&n[Ze])}function es(n,e){return null==e?null:n[e]}function S0(n){n[To]=0}function Tf(n,e){n[Is]+=e;let t=n,i=n[zt];for(;null!==i&&(1===e&&1===t[Is]||-1===e&&0===t[Is]);)i[Is]+=e,t=i,i=i[zt]}const je={lFrame:N0(null),bindingsEnabled:!0};function E0(){return je.bindingsEnabled}function Z(){return je.lFrame.lView}function ct(){return je.lFrame.tView}function Bn(n){return je.lFrame.contextLView=n,n[Wt]}function Un(n){return je.lFrame.contextLView=null,n}function wn(){let n=C0();for(;null!==n&&64===n.type;)n=n.parent;return n}function C0(){return je.lFrame.currentTNode}function or(n,e){const t=je.lFrame;t.currentTNode=n,t.isParent=e}function Af(){return je.lFrame.isParent}function MA(n,e){const t=je.lFrame;t.bindingIndex=t.bindingRootIndex=n,Rf(e)}function Rf(n){je.lFrame.currentDirectiveIndex=n}function Lf(n){je.lFrame.currentQueryIndex=n}function DA(n){const e=n[ge];return 2===e.type?e.declTNode:1===e.type?n[En]:null}function P0(n,e,t){if(t&ke.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ke.Host||(r=DA(s),null===r||(s=s[Co],10&r.type))););if(null===r)return!1;e=r,n=s}const i=je.lFrame=L0();return i.currentTNode=e,i.lView=n,!0}function Nf(n){const e=L0(),t=n[ge];je.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function L0(){const n=je.lFrame,e=null===n?null:n.child;return null===e?N0(n):e}function N0(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function F0(){const n=je.lFrame;return je.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const O0=F0;function Ff(){const n=F0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Vn(){return je.lFrame.selectedIndex}function Ls(n){je.lFrame.selectedIndex=n}function fu(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function pu(n,e,t){k0(n,e,3,t)}function mu(n,e,t,i){(3&n[Ze])===t&&k0(n,e,t,i)}function Of(n,e){let t=n[Ze];(3&t)===e&&(t&=2047,t+=1,n[Ze]=t)}function k0(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[To]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[To]+=65536),(a<s||-1==s)&&(NA(n,t,e,l),n[To]=(4294901760&n[To])+l+2),l++}function NA(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[Ze]>>11<n[To]>>16&&(3&n[Ze])===e){n[Ze]+=2048,Ti(4,a,s);try{s.call(a)}finally{Ti(5,a,s)}}}else{Ti(4,a,s);try{s.call(a)}finally{Ti(5,a,s)}}}const Po=-1;class vl{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Bf(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];U0(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function B0(n){return 3===n||4===n||6===n}function U0(n){return 64===n.charCodeAt(0)}function _l(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||z0(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function z0(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function V0(n){return n!==Po}function gu(n){return 32767&n}function yu(n,e){let t=function BA(n){return n>>16}(n),i=e;for(;t>0;)i=i[Co],t--;return i}let Uf=!0;function vu(n){const e=Uf;return Uf=n,e}const H0=255,G0=5;let UA=0;const ar={};function _u(n,e){const t=W0(n,e);if(-1!==t)return t;const i=e[ge];i.firstCreatePass&&(n.injectorIndex=e.length,zf(i.data,n),zf(e,null),zf(i.blueprint,null));const r=Vf(n,e),s=n.injectorIndex;if(V0(r)){const o=gu(r),a=yu(r,e),l=a[ge].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function zf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function W0(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Vf(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=K0(r),null===i)return Po;if(t++,r=r[Co],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Po}function Hf(n,e,t){!function zA(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(dl)&&(i=t[dl]),null==i&&(i=t[dl]=UA++);const r=i&H0;e.data[n+(r>>G0)]|=1<<r}(n,e,t)}function $0(n,e,t){if(t&ke.Optional||void 0!==n)return n;eu()}function j0(n,e,t,i){if(t&ke.Optional&&void 0===i&&(i=null),!(t&(ke.Self|ke.Host))){const r=n[ou],s=Ci(void 0);try{return r?r.get(e,i,t&ke.Optional):o0(e,i,t&ke.Optional)}finally{Ci(s)}}return $0(i,0,t)}function q0(n,e,t,i=ke.Default,r){if(null!==n){if(1024&e[Ze]){const o=function $A(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&1024&o[Ze]&&!(256&o[Ze]);){const a=X0(s,o,t,i|ke.Self,ar);if(a!==ar)return a;let l=s.parent;if(!l){const c=o[p0];if(c){const u=c.get(t,ar,i);if(u!==ar)return u}l=K0(o),o=o[Co]}s=l}return r}(n,e,t,i,ar);if(o!==ar)return o}const s=X0(n,e,t,i,ar);if(s!==ar)return s}return j0(e,t,i,r)}function X0(n,e,t,i,r){const s=function GA(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(dl)?n[dl]:void 0;return"number"==typeof e?e>=0?e&H0:WA:e}(t);if("function"==typeof s){if(!P0(e,n,i))return i&ke.Host?$0(r,0,i):j0(e,t,i,r);try{const o=s(i);if(null!=o||i&ke.Optional)return o;eu()}finally{O0()}}else if("number"==typeof s){let o=null,a=W0(n,e),l=Po,c=i&ke.Host?e[Cn][En]:null;for((-1===a||i&ke.SkipSelf)&&(l=-1===a?Vf(n,e):e[a+8],l!==Po&&Z0(i,!1)?(o=e[ge],a=gu(l),e=yu(l,e)):a=-1);-1!==a;){const u=e[ge];if(Y0(s,a,u.data)){const d=HA(a,e,t,o,i,c);if(d!==ar)return d}l=e[a+8],l!==Po&&Z0(i,e[ge].data[a+8]===c)&&Y0(s,a,e)?(o=u,a=gu(l),e=yu(l,e)):a=-1}}return r}function HA(n,e,t,i,r,s){const o=e[ge],a=o.data[n+8],u=function xu(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const m=o[f];if(f<l&&t===m||f>=l&&m.type===t)return f}if(r){const f=o[l];if(f&&Vi(f)&&f.type===t)return l}return null}(a,o,t,null==i?gl(a)&&Uf:i!=o&&0!=(3&a.type),r&ke.Host&&s===a);return null!==u?Ns(e,o,u,a):ar}function Ns(n,e,t,i){let r=n[t];const s=e.data;if(function FA(n){return n instanceof vl}(r)){const o=r;o.resolving&&function BT(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ce(-200,`Circular dependency in DI detected for ${n}${t}`)}(function vt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():$e(n)}(s[t]));const a=vu(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ci(o.injectImpl):null;P0(n,i,ke.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function LA(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=v0(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&Ci(l),vu(a),o.resolving=!1,O0()}}return r}function Y0(n,e,t){return!!(t[e+(n>>G0)]&1<<n)}function Z0(n,e){return!(n&ke.Self||n&ke.Host&&e)}class Lo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return q0(this._tNode,this._lView,e,ru(i),t)}}function WA(){return new Lo(wn(),Z())}function Gf(n){return gf(n)?()=>{const e=Gf(Oe(n));return e&&e()}:Rs(n)}function K0(n){const e=n[ge],t=e.type;return 2===t?e.declTNode:1===t?n[En]:null}const Fo="__parameters__";function ko(n,e,t){return Qr(()=>{const i=function Wf(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(Fo)?l[Fo]:Object.defineProperty(l,Fo,{value:[]})[Fo];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Ue{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ge({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Fs(n,e){n.forEach(t=>Array.isArray(t)?Fs(t,e):e(t))}function e_(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function bu(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}const Ml=ul(ko("Optional"),8),Sl=ul(ko("SkipSelf"),4);var ti=(()=>((ti=ti||{})[ti.Important=1]="Important",ti[ti.DashCase=2]="DashCase",ti))();const Kf=new Map;let yI=0;const ep="__ngContext__";function Tn(n,e){ci(e)?(n[ep]=e[ml],function _I(n){Kf.set(n[ml],n)}(e)):n[ep]=e}let tp;function np(n,e){return tp(n,e)}function Tl(n){const e=n[zt];return zi(e)?e[zt]:e}function ip(n){return w_(n[fl])}function rp(n){return w_(n[Ui])}function w_(n){for(;null!==n&&!zi(n);)n=n[Ui];return n}function zo(n,e,t,i,r){if(null!=i){let s,o=!1;zi(i)?s=i:ci(i)&&(o=!0,i=i[Cr]);const a=xn(i);0===n&&null!==t?null==r?C_(e,t,a):Os(e,t,a,r||null,!0):1===n&&null!==t?Os(e,t,a,r||null,!0):2===n?function dp(n,e,t){const i=Eu(n,e);i&&function UI(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function HI(n,e,t,i,r){const s=t[lu];s!==xn(t)&&zo(e,n,i,s,r);for(let a=kn;a<t.length;a++){const l=t[a];Al(l[ge],l,n,e,i,s)}}(e,n,s,t,r)}}function op(n,e,t){return n.createElement(e,t)}function M_(n,e){const t=n[Ao],i=t.indexOf(e),r=e[zt];512&e[Ze]&&(e[Ze]&=-513,Tf(r,-1)),t.splice(i,1)}function ap(n,e){if(n.length<=kn)return;const t=kn+e,i=n[t];if(i){const r=i[pl];null!==r&&r!==n&&M_(r,i),e>0&&(n[t-1][Ui]=i[Ui]);const s=bu(n,kn+e);!function RI(n,e){Al(n,e,e[Qe],2,null,null),e[Cr]=null,e[En]=null}(i[ge],i);const o=s[sr];null!==o&&o.detachView(s[ge]),i[zt]=null,i[Ui]=null,i[Ze]&=-65}return i}function S_(n,e){if(!(128&e[Ze])){const t=e[Qe];t.destroyNode&&Al(n,e,t,3,null,null),function NI(n){let e=n[fl];if(!e)return lp(n[ge],n);for(;e;){let t=null;if(ci(e))t=e[fl];else{const i=e[kn];i&&(t=i)}if(!t){for(;e&&!e[Ui]&&e!==n;)ci(e)&&lp(e[ge],e),e=e[zt];null===e&&(e=n),ci(e)&&lp(e[ge],e),t=e&&e[Ui]}e=t}}(e)}}function lp(n,e){if(!(128&e[Ze])){e[Ze]&=-65,e[Ze]|=128,function BI(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof vl)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];Ti(4,a,l);try{l.call(a)}finally{Ti(5,a,l)}}else{Ti(4,r,s);try{s.call(r)}finally{Ti(5,r,s)}}}}}(n,e),function kI(n,e){const t=n.cleanup,i=e[Eo];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[r=o]():i[r=-o].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)(0,i[s])();e[Eo]=null}}(n,e),1===e[ge].type&&e[Qe].destroy();const t=e[pl];if(null!==t&&zi(e[zt])){t!==e[zt]&&M_(t,e);const i=e[sr];null!==i&&i.detachView(n)}!function xI(n){Kf.delete(n[ml])}(e)}}function D_(n,e,t){return function E_(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Cr];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===rr.None||s===rr.Emulated)return null}return ui(i,t)}}(n,e.parent,t)}function Os(n,e,t,i,r){n.insertBefore(e,t,i,r)}function C_(n,e,t){n.appendChild(e,t)}function T_(n,e,t,i,r){null!==i?Os(n,e,t,i,r):C_(n,e,t)}function Eu(n,e){return n.parentNode(e)}let cp,Au,pp,Iu,R_=function I_(n,e,t){return 40&n.type?ui(n,t):null};function Cu(n,e,t,i){const r=D_(n,i,e),s=e[Qe],a=function A_(n,e,t){return R_(n,e,t)}(i.parent||e[En],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)T_(s,r,t[l],a,!1);else T_(s,r,t,a,!1);void 0!==cp&&cp(s,i,e,t,r)}function Tu(n,e){if(null!==e){const t=e.type;if(3&t)return ui(e,n);if(4&t)return up(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Tu(n,i);{const r=n[e.index];return zi(r)?up(-1,r):xn(r)}}if(32&t)return np(e,n)()||xn(n[e.index]);{const i=L_(n,e);return null!==i?Array.isArray(i)?i[0]:Tu(Tl(n[Cn]),i):Tu(n,e.next)}}return null}function L_(n,e){return null!==e?n[Cn][En].projection[e.projection]:null}function up(n,e){const t=kn+n+1;if(t<e.length){const i=e[t],r=i[ge].firstChild;if(null!==r)return Tu(i,r)}return e[lu]}function hp(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Tn(xn(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)hp(n,e,t.child,i,r,s,!1),zo(e,n,r,a,s);else if(32&l){const c=np(t,i);let u;for(;u=c();)zo(e,n,r,u,s);zo(e,n,r,a,s)}else 16&l?N_(n,e,i,t,r,s):zo(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Al(n,e,t,i,r,s){hp(t,i,n.firstChild,e,r,s,!1)}function N_(n,e,t,i,r,s){const o=t[Cn],l=o[En].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)zo(e,n,r,l[c],s);else hp(n,e,l,o[zt],r,s,!0)}function F_(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function O_(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Bf(n,e,i),null!==r&&F_(n,e,r),null!==s&&function WI(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function Vo(n){return function fp(){if(void 0===Au&&(Au=null,Pt.trustedTypes))try{Au=Pt.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Au}()?.createHTML(n)||n}function B_(n){return function mp(){if(void 0===Iu&&(Iu=null,Pt.trustedTypes))try{Iu=Pt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Iu}()?.createHTML(n)||n}class V_{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${t0})`}}class tR{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Vo(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class nR{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=Vo(e),t}}const rR=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Ir(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function Rl(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const G_=Ir("area,br,col,hr,img,wbr"),W_=Ir("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),$_=Ir("rp,rt"),yp=Rl(G_,Rl(W_,Ir("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Rl($_,Ir("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Rl($_,W_)),vp=Ir("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),j_=Rl(vp,Ir("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ir("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),sR=Ir("script,style,template");class oR{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!yp.hasOwnProperty(t))return this.sanitizedSomething=!0,!sR.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!j_.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;vp[a]&&(n=l,l=(n=String(n)).match(rR)?n:"unsafe:"+n),this.buf.push(" ",o,'="',q_(l),'"')}var n;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();yp.hasOwnProperty(t)&&!G_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(q_(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const aR=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lR=/([^\#-~ |!])/g;function q_(n){return n.replace(/&/g,"&amp;").replace(aR,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(lR,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ru;function _p(n){return"content"in n&&function uR(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Jt=(()=>((Jt=Jt||{})[Jt.NONE=0]="NONE",Jt[Jt.HTML=1]="HTML",Jt[Jt.STYLE=2]="STYLE",Jt[Jt.SCRIPT=3]="SCRIPT",Jt[Jt.URL=4]="URL",Jt[Jt.RESOURCE_URL=5]="RESOURCE_URL",Jt))();function Hi(n){const e=function Pl(){const n=Z();return n&&n[Sf]}();return e?B_(e.sanitize(Jt.HTML,n)||""):function Il(n,e){const t=function eR(n){return n instanceof V_&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${t0})`)}return t===e}(n,"HTML")?B_(function ts(n){return n instanceof V_?n.changingThisBreaksApplicationSecurity:n}(n)):function cR(n,e){let t=null;try{Ru=Ru||function H_(n){const e=new nR(n);return function iR(){try{return!!(new window.DOMParser).parseFromString(Vo(""),"text/html")}catch{return!1}}()?new tR(e):e}(n);let i=e?String(e):"";t=Ru.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=Ru.getInertBodyElement(i)}while(i!==s);return Vo((new oR).sanitizeChildren(_p(t)||t))}finally{if(t){const i=_p(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}(function k_(){return void 0!==pp?pp:typeof document<"u"?document:void 0}(),$e(n))}const Pu=new Ue("ENVIRONMENT_INITIALIZER"),J_=new Ue("INJECTOR",-1),K_=new Ue("INJECTOR_DEF_TYPES");class Q_{get(e,t=ll){if(t===ll){const i=new Error(`NullInjectorError: No provider for ${It(e)}!`);throw i.name="NullInjectorError",i}return t}}function gR(...n){return{\u0275providers:ex(0,n),\u0275fromNgModule:!0}}function ex(n,...e){const t=[],i=new Set;let r;return Fs(e,s=>{const o=s;xp(o,t,[],i)&&(r||(r=[]),r.push(o))}),void 0!==r&&tx(r,t),t}function tx(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];wp(r,s=>{e.push(s)})}}function xp(n,e,t,i){if(!(n=Oe(n)))return!1;let r=null,s=r0(n);const o=!s&&xt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=r0(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)xp(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Fs(s.imports,u=>{xp(u,e,t,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&tx(c,e)}if(!a){const c=Rs(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:yt},{provide:K_,useValue:r,multi:!0},{provide:Pu,useValue:()=>Pe(r),multi:!0})}const l=s.providers;null==l||a||wp(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function wp(n,e){for(let t of n)yf(t)&&(t=t.\u0275providers),Array.isArray(t)?wp(t,e):e(t)}const yR=Et({provide:String,useValue:Et});function bp(n){return null!==n&&"object"==typeof n&&yR in n}function ks(n){return"function"==typeof n}const Mp=new Ue("Set Injector scope."),Lu={},_R={};let Sp;function Nu(){return void 0===Sp&&(Sp=new Q_),Sp}class Rr{}class rx extends Rr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ep(e,o=>this.processProvider(o)),this.records.set(J_,Ho(void 0,this)),r.has("environment")&&this.records.set(Rr,Ho(void 0,this));const s=this.records.get(Mp);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(K_.multi,yt,ke.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=So(this),i=Ci(void 0);try{return e()}finally{So(t),Ci(i)}}get(e,t=ll,i=ke.Default){this.assertNotDestroyed(),i=ru(i);const r=So(this),s=Ci(void 0);try{if(!(i&ke.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function SR(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ue}(e)&&tu(e);a=l&&this.injectableDefInScope(l)?Ho(Dp(e),Lu):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&ke.Self?Nu():this.parent).get(e,t=i&ke.Optional&&t===ll?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[iu]=o[iu]||[]).unshift(It(e)),r)throw o;return function QT(n,e,t,i){const r=n[iu];throw e[a0]&&r.unshift(e[a0]),n.message=function eA(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==ZT?n.slice(2):n;let r=It(e);if(Array.isArray(e))r=e.map(It).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):It(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(YT,"\n  ")}`}("\n"+n.message,r,t,i),n[XT]=r,n[iu]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Ci(s),So(r)}}resolveInjectorInitializers(){const e=So(this),t=Ci(void 0);try{const i=this.get(Pu.multi,yt,ke.Self);for(const r of i)r()}finally{So(e),Ci(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(It(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ce(205,!1)}processProvider(e){let t=ks(e=Oe(e))?e:Oe(e&&e.provide);const i=function wR(n){return bp(n)?Ho(void 0,n.useValue):Ho(function sx(n,e,t){let i;if(ks(n)){const r=Oe(n);return Rs(r)||Dp(r)}if(bp(n))i=()=>Oe(n.useValue);else if(function ix(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...wf(n.deps||[]));else if(function nx(n){return!(!n||!n.useExisting)}(n))i=()=>Pe(Oe(n.useExisting));else{const r=Oe(n&&(n.useClass||n.provide));if(!function bR(n){return!!n.deps}(n))return Rs(r)||Dp(r);i=()=>new r(...wf(n.deps))}return i}(n),Lu)}(e);if(ks(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Ho(void 0,Lu,!0),r.factory=()=>wf(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Lu&&(t.value=_R,t.value=t.factory()),"object"==typeof t.value&&t.value&&function MR(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Oe(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Dp(n){const e=tu(n),t=null!==e?e.factory:Rs(n);if(null!==t)return t;if(n instanceof Ue)throw new ce(204,!1);if(n instanceof Function)return function xR(n){const e=n.length;if(e>0)throw function bl(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new ce(204,!1);const t=function WT(n){const e=n&&(n[nu]||n[s0]);return e?(function $T(n){if(n.hasOwnProperty("name"))return n.name;(""+n).match(/^function\s*([^\s(]+)/)}(n),e):null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ce(204,!1)}function Ho(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Ep(n,e){for(const t of n)Array.isArray(t)?Ep(t,e):t&&yf(t)?Ep(t.\u0275providers,e):e(t)}class DR{}class ox{}class CR{resolveComponentFactory(e){throw function ER(n){const e=Error(`No component factory found for ${It(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let Ll=(()=>{class n{}return n.NULL=new CR,n})();function TR(){return Go(wn(),Z())}function Go(n,e){return new ns(ui(n,e))}let ns=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=TR,n})();class lx{}let RR=(()=>{class n{}return n.\u0275prov=Ge({token:n,providedIn:"root",factory:()=>null}),n})();class Ou{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const PR=new Ou("15.2.2"),Cp={},Tp="ngOriginalError";function Ap(n){return n[Tp]}class Wo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Ap(e);for(;t&&Ap(t);)t=Ap(t);return t||null}}function Pr(n){return n instanceof Function?n():n}function ux(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const dx="ng-template";function GR(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==ux(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function hx(n){return 4===n.type&&n.value!==dx}function WR(n,e,t){return e===(4!==n.type||t?n.value:dx)}function $R(n,e,t){let i=4;const r=n.attrs||[],s=function XR(n){for(let e=0;e<n.length;e++)if(B0(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!WR(n,l,t)||""===l&&1===e.length){if(Gi(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!GR(n.attrs,c,t)){if(Gi(i))return!1;o=!0}continue}const d=jR(8&i?"class":l,r,hx(n),t);if(-1===d){if(Gi(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==ux(f,c,0)||2&i&&c!==h){if(Gi(i))return!1;o=!0}}}}else{if(!o&&!Gi(i)&&!Gi(l))return!1;if(o&&Gi(l))continue;o=!1,i=l|1&i}}return Gi(i)||o}function Gi(n){return 0==(1&n)}function jR(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function YR(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function fx(n,e,t=!1){for(let i=0;i<e.length;i++)if($R(n,e[i],t))return!0;return!1}function px(n,e){return n?":not("+e.trim()+")":e}function JR(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Gi(o)&&(e+=px(s,r),r=""),i=o,s=s||!Gi(i);t++}return""!==r&&(e+=px(s,r)),e}const qe={};function fi(n){mx(ct(),Z(),Vn()+n,!1)}function mx(n,e,t,i){if(!i)if(3==(3&e[Ze])){const s=n.preOrderCheckHooks;null!==s&&pu(e,s,t)}else{const s=n.preOrderHooks;null!==s&&mu(e,s,0,t)}Ls(t)}function _x(n,e=null,t=null,i){const r=xx(n,e,t,i);return r.resolveInjectorInitializers(),r}function xx(n,e=null,t=null,i,r=new Set){const s=[t||yt,gR(n)];return i=i||("object"==typeof n?void 0:It(n)),new rx(s,e||Nu(),i||null,r)}let lr=(()=>{class n{static create(t,i){if(Array.isArray(t))return _x({name:""},i,t,"");{const r=t.name??"";return _x({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=ll,n.NULL=new Q_,n.\u0275prov=Ge({token:n,providedIn:"any",factory:()=>Pe(J_)}),n.__NG_ELEMENT_ID__=-1,n})();function ze(n,e=ke.Default){const t=Z();return null===t?Pe(n,e):q0(wn(),t,Oe(n),e)}function Tx(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Lf(t[i]),o.contentQueries(2,e[s],s)}}}function Bu(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[Cr]=r,d[Ze]=76|i,(null!==u||n&&1024&n[Ze])&&(d[Ze]|=1024),S0(d),d[zt]=d[Co]=n,d[Wt]=t,d[au]=o||n&&n[au],d[Qe]=a||n&&n[Qe],d[Sf]=l||n&&n[Sf]||null,d[ou]=c||n&&n[ou]||null,d[En]=s,d[ml]=function vI(){return yI++}(),d[p0]=u,d[Cn]=2==e.type?n[Cn]:d,d}function qo(n,e,t,i,r){let s=n.data[e];if(null===s)s=function Np(n,e,t,i,r){const s=C0(),o=Af(),l=n.data[e]=function MP(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function bA(){return je.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function yl(){const n=je.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return or(s,!0),s}function Nl(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Fp(n,e,t){Nf(e);try{const i=n.viewQuery;null!==i&&$p(1,i,t);const r=n.template;null!==r&&Ax(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Tx(n,e),n.staticViewQueries&&$p(2,n.viewQuery,t);const s=n.components;null!==s&&function xP(n,e){for(let t=0;t<e.length;t++)HP(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ze]&=-5,Ff()}}function Uu(n,e,t,i){const r=e[Ze];if(128!=(128&r)){Nf(e);try{S0(e),function A0(n){return je.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Ax(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&pu(e,c,null)}else{const c=n.preOrderHooks;null!==c&&mu(e,c,0,null),Of(e,0)}if(function zP(n){for(let e=ip(n);null!==e;e=rp(e)){if(!e[m0])continue;const t=e[Ao];for(let i=0;i<t.length;i++){const r=t[i];512&r[Ze]||Tf(r[zt],1),r[Ze]|=512}}}(e),function UP(n){for(let e=ip(n);null!==e;e=rp(e))for(let t=kn;t<e.length;t++){const i=e[t],r=i[ge];hu(i)&&Uu(r,i,r.template,i[Wt])}}(e),null!==n.contentQueries&&Tx(n,e),o){const c=n.contentCheckHooks;null!==c&&pu(e,c)}else{const c=n.contentHooks;null!==c&&mu(e,c,1),Of(e,1)}!function vP(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Ls(~r);else{const s=r,o=t[++i],a=t[++i];MA(o,s),a(2,e[s])}}}finally{Ls(-1)}}(n,e);const a=n.components;null!==a&&function _P(n,e){for(let t=0;t<e.length;t++)VP(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&$p(2,l,i),o){const c=n.viewCheckHooks;null!==c&&pu(e,c)}else{const c=n.viewHooks;null!==c&&mu(e,c,2),Of(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Ze]&=-41,512&e[Ze]&&(e[Ze]&=-513,Tf(e[zt],-1))}finally{Ff()}}}function Ax(n,e,t,i,r){const s=Vn(),o=2&i;try{Ls(-1),o&&e.length>Lt&&mx(n,e,Lt,!1),Ti(o?2:0,r),t(i,r)}finally{Ls(s),Ti(o?3:1,r)}}function Op(n,e,t){if(Ef(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function kp(n,e,t){E0()&&(function AP(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;gl(t)&&function OP(n,e,t){const i=ui(e,n),r=Ix(t),s=n[au],o=zu(n,Bu(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||_u(t,e),Tn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Ns(e,n,a,t);Tn(c,e),null!==o&&kP(0,a-r,c,l,0,o),Vi(l)&&(di(t.index,e)[Wt]=Ns(e,n,a,t))}}(n,e,t,ui(t,e)),64==(64&t.flags)&&Ox(n,e,t))}function Bp(n,e,t=ui){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Ix(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Up(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Up(n,e,t,i,r,s,o,a,l,c){const u=Lt+i,d=u+r,h=function wP(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:qe);return t}(u,d),f="function"==typeof c?c():c;return h[ge]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function Px(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?Lx(t,e,r,s):i.hasOwnProperty(r)&&Lx(t,e,i[r],s)}return t}function Lx(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function Nx(n,e){const t=di(e,n);16&t[Ze]||(t[Ze]|=32)}function zp(n,e,t,i){if(E0()){const r=null===i?null:{"":-1},s=function RP(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(fx(e,o.selectors,!1))if(i||(i=[]),Vi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),Vp(n,e,a.length)}else i.unshift(o),Vp(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&Fx(n,e,t,o,r,a),r&&function PP(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new ce(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=_l(t.mergedAttrs,t.attrs)}function Fx(n,e,t,i,r,s){for(let c=0;c<i.length;c++)Hf(_u(t,e),n,i[c].type);!function NP(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=Nl(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=_l(t.mergedAttrs,u.hostAttrs),FP(n,t,e,l,u),LP(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function SP(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,m=h?h.outputs:null;l=Px(d.inputs,u,l,h?h.inputs:null),c=Px(d.outputs,u,c,m);const p=null===l||null===o||hx(e)?null:BP(l,u,o);a.push(p)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function Ox(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function SA(){return je.lFrame.currentDirectiveIndex}();try{Ls(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Rf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&IP(l,c)}}finally{Ls(-1),Rf(o)}}function IP(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Vp(n,e,t){e.componentOffset=t,(n.components||(n.components=[])).push(e.index)}function LP(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Vi(e)&&(t[""]=n)}}function FP(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Rs(r.type)),o=new vl(s,Vi(r),ze);n.blueprint[i]=o,t[i]=o,function CP(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function TP(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,Nl(n,t,r.hostVars,qe),r)}function kP(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function BP(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function kx(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null]}function VP(n,e){const t=di(e,n);if(hu(t)){const i=t[ge];48&t[Ze]?Uu(i,t,i.template,t[Wt]):t[Is]>0&&Gp(t)}}function Gp(n){for(let i=ip(n);null!==i;i=rp(i))for(let r=kn;r<i.length;r++){const s=i[r];if(hu(s))if(512&s[Ze]){const o=s[ge];Uu(o,s,o.template,s[Wt])}else s[Is]>0&&Gp(s)}const t=n[ge].components;if(null!==t)for(let i=0;i<t.length;i++){const r=di(t[i],n);hu(r)&&r[Is]>0&&Gp(r)}}function HP(n,e){const t=di(e,n),i=t[ge];(function GP(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),Fp(i,t,t[Wt])}function zu(n,e){return n[fl]?n[f0][Ui]=e:n[fl]=e,n[f0]=e,e}function Wp(n){for(;n;){n[Ze]|=32;const e=Tl(n);if(rA(n)&&!e)return n;n=e}return null}function Vu(n,e,t,i=!0){const r=e[au];r.begin&&r.begin();try{Uu(n,e,n.template,t)}catch(o){throw i&&Vx(e,o),o}finally{r.end&&r.end()}}function $p(n,e,t){Lf(0),e(n,t)}function Bx(n){return n[Eo]||(n[Eo]=[])}function Ux(n){return n.cleanup||(n.cleanup=[])}function Vx(n,e){const t=n[ou],i=t?t.get(Wo,null):null;i&&i.handleError(e)}function jp(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Hu(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=pf(r,a):2==s&&(i=pf(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Gu(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(xn(s)),zi(s))for(let a=kn;a<s.length;a++){const l=s[a],c=l[ge].firstChild;null!==c&&Gu(l[ge],l,c,i)}const o=t.type;if(8&o)Gu(n,e,t.child,i);else if(32&o){const a=np(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=L_(e,t);if(Array.isArray(a))i.push(...a);else{const l=Tl(e[Cn]);Gu(l[ge],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class Fl{get rootNodes(){const e=this._lView,t=e[ge];return Gu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Wt]}set context(e){this._lView[Wt]=e}get destroyed(){return 128==(128&this._lView[Ze])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[zt];if(zi(e)){const t=e[cu],i=t?t.indexOf(this):-1;i>-1&&(ap(e,i),bu(t,i))}this._attachedToViewContainer=!1}S_(this._lView[ge],this._lView)}onDestroy(e){!function Rx(n,e,t,i){const r=Bx(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Ux(n).push(i,r.length-1))}(this._lView[ge],this._lView,null,e)}markForCheck(){Wp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ze]&=-65}reattach(){this._lView[Ze]|=64}detectChanges(){Vu(this._lView[ge],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function LI(n,e){Al(n,e,e[Qe],2,null,null)}(this._lView[ge],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ce(902,!1);this._appRef=e}}class WP extends Fl{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Vu(e[ge],e,e[Wt],!1)}checkNoChanges(){}get context(){return null}}class Hx extends Ll{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=xt(e);return new Ol(t,this.ngModule)}}function Gx(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class jP{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=ru(i);const r=this.injector.get(e,Cp,i);return r!==Cp||t===Cp?r:this.parentInjector.get(e,t,i)}}class Ol extends ox{get inputs(){return Gx(this.componentDef.inputs)}get outputs(){return Gx(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function KR(n){return n.map(JR).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Rr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new jP(e,s):e,a=o.get(lx,null);if(null===a)throw new ce(407,!1);const l=o.get(RR,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=i?function bP(n,e,t){return n.selectRootElement(e,t===rr.ShadowDom)}(c,i,this.componentDef.encapsulation):op(c,u,function $P(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),h=this.componentDef.onPush?288:272,f=Up(0,null,null,1,0,null,null,null,null,null),m=Bu(null,f,null,h,null,null,a,c,l,o,null);let p,g;Nf(m);try{const v=this.componentDef;let _,y=null;v.findHostDirectiveDefs?(_=[],y=new Map,v.findHostDirectiveDefs(v,_,y),_.push(v)):_=[v];const x=function XP(n,e){const t=n[ge],i=Lt;return n[i]=e,qo(t,i,2,"#host",null)}(m,d),b=function YP(n,e,t,i,r,s,o,a){const l=r[ge];!function ZP(n,e,t,i){for(const r of n)e.mergedAttrs=_l(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Hu(e,e.mergedAttrs,!0),null!==t&&O_(i,t,e))}(i,n,e,o);const c=s.createRenderer(e,t),u=Bu(r,Ix(t),null,t.onPush?32:16,r[n.index],n,s,c,a||null,null,null);return l.firstCreatePass&&Vp(l,n,i.length-1),zu(r,u),r[n.index]=u}(x,d,v,_,m,a,c);g=M0(f,Lt),d&&function KP(n,e,t,i){if(i)Bf(n,t,["ng-version",PR.full]);else{const{attrs:r,classes:s}=function QR(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Gi(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Bf(n,t,r),s&&s.length>0&&F_(n,t,s.join(" "))}}(c,v,d,i),void 0!==t&&function QP(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),p=function JP(n,e,t,i,r,s){const o=wn(),a=r[ge],l=ui(o,r);Fx(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Tn(Ns(r,a,o.directiveStart+u,o),r);Ox(a,r,o),l&&Tn(l,r);const c=Ns(r,a,o.directiveStart+o.componentOffset,o);if(n[Wt]=r[Wt]=c,null!==s)for(const u of s)u(c,e);return Op(a,o,n),c}(b,v,_,y,m,[eL]),Fp(f,m,null)}finally{Ff()}return new qP(this.componentType,p,Go(g,m),m,g)}}class qP extends DR{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new WP(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const s=this._rootLView;jp(s[ge],s,r,e,t),Nx(s,this._tNode.index)}}get injector(){return new Lo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function eL(){const n=wn();fu(Z()[ge],n)}function Zp(n,e,t,i,r,s,o,a){const l=Z(),c=ct(),u=n+Lt,d=c.firstCreatePass?function pL(n,e,t,i,r,s,o,a,l){const c=e.consts,u=qo(e,n,4,o||null,es(c,a));zp(e,t,u,es(c,l)),fu(e,u);const d=u.tView=Up(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];or(d,!1);const h=l[Qe].createComment("");Cu(c,l,h,d),Tn(h,l),zu(l,l[u]=kx(h,l,h,d)),uu(d)&&kp(c,l,d),null!=o&&Bp(l,d,a)}function ii(n,e,t){const i=Z();return function An(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}(i,function Ro(){return je.lFrame.bindingIndex++}(),e)&&function pi(n,e,t,i,r,s,o,a){const l=ui(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(jp(n,t,u,i,r),gl(e)&&Nx(t,e.index)):3&e.type&&(i=function DP(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(ct(),function kt(){const n=je.lFrame;return M0(n.tView,n.selectedIndex)}(),i,n,e,i[Qe],t,!1),ii}function Jp(n,e,t,i,r){const o=r?"class":"style";jp(n,t,e.inputs[o],o,i)}function wt(n,e,t,i){const r=Z(),s=ct(),o=Lt+n,a=r[Qe],l=s.firstCreatePass?function yL(n,e,t,i,r,s){const o=e.consts,l=qo(e,n,2,i,es(o,r));return zp(e,t,l,es(o,s)),null!==l.attrs&&Hu(l,l.attrs,!1),null!==l.mergedAttrs&&Hu(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=r[o]=op(a,e,function PA(){return je.lFrame.currentNamespace}()),u=uu(l);return or(l,!0),O_(a,c,l),32!=(32&l.flags)&&Cu(s,r,c,l),0===function gA(){return je.lFrame.elementDepthCount}()&&Tn(c,r),function yA(){je.lFrame.elementDepthCount++}(),u&&(kp(s,r,l),Op(s,l,r)),null!==i&&Bp(r,l),wt}function bt(){let n=wn();Af()?function If(){je.lFrame.isParent=!1}():(n=n.parent,or(n,!1));const e=n;!function vA(){je.lFrame.elementDepthCount--}();const t=ct();return t.firstCreatePass&&(fu(t,n),Ef(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function OA(n){return 0!=(8&n.flags)}(e)&&Jp(t,e,Z(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function kA(n){return 0!=(16&n.flags)}(e)&&Jp(t,e,Z(),e.stylesWithoutHost,!1),bt}function In(n,e,t,i){return wt(n,e,t,i),bt(),In}function em(){return Z()}function ju(n){return!!n&&"function"==typeof n.then}const ow=function sw(n){return!!n&&"function"==typeof n.subscribe};function Wi(n,e,t,i){const r=Z(),s=ct(),o=wn();return function lw(n,e,t,i,r,s,o){const a=uu(i),c=n.firstCreatePass&&Ux(n),u=e[Wt],d=Bx(e);let h=!0;if(3&i.type||o){const p=ui(i,e),g=o?o(p):p,v=d.length,_=o?x=>o(xn(x[i.index])):i.index;let y=null;if(!o&&a&&(y=function _L(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Eo],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,h=!1;else{s=uw(i,e,u,s,!1);const x=t.listen(g,r,s);d.push(s,x),c&&c.push(r,_,v,v+1)}}else s=uw(i,e,u,s,!1);const f=i.outputs;let m;if(h&&null!==f&&(m=f[r])){const p=m.length;if(p)for(let g=0;g<p;g+=2){const b=e[m[g]][m[g+1]].subscribe(s),S=d.length;d.push(s,b),c&&c.push(r,i.index,S,-(S+1))}}}(s,r,r[Qe],o,n,e,i),Wi}function cw(n,e,t,i){try{return Ti(6,e,t),!1!==t(i)}catch(r){return Vx(n,r),!1}finally{Ti(7,e,t)}}function uw(n,e,t,i,r){return function s(o){if(o===Function)return i;Wp(n.componentOffset>-1?di(n.index,e):e);let l=cw(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=cw(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function bn(n=1){return function EA(n){return(je.lFrame.contextLView=function CA(n,e){for(;n>0;)e=e[Co],n--;return e}(n,je.lFrame.contextLView))[Wt]}(n)}function Vt(n,e=""){const t=Z(),i=ct(),r=n+Lt,s=i.firstCreatePass?qo(i,r,1,e,null):i.data[r],o=t[r]=function sp(n,e){return n.createText(e)}(t[Qe],e);Cu(i,t,o,s),or(s,!1)}const sa="en-US";let ib=sa;class oa{}class Ab{}class Ib extends oa{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Hx(this);const i=li(e);this._bootstrapComponents=Pr(i.bootstrap),this._r3Injector=xx(e,t,[{provide:oa,useValue:this},{provide:Ll,useValue:this.componentFactoryResolver}],It(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class fm extends Ab{constructor(e){super(),this.moduleType=e}create(e){return new Ib(this.moduleType,e)}}class uN extends oa{constructor(e,t,i){super(),this.componentFactoryResolver=new Hx(this),this.instance=null;const r=new rx([...e,{provide:oa,useValue:this},{provide:Ll,useValue:this.componentFactoryResolver}],t||Nu(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Qu(n,e,t=null){return new uN(n,e,t).injector}let dN=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=ex(0,t.type),r=i.length>0?Qu([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ge({token:n,providedIn:"environment",factory:()=>new n(Pe(Rr))}),n})();function Rb(n){n.getStandaloneInjector=e=>e.get(dN).getOrCreateStandaloneInjector(n)}function mm(n){return e=>{setTimeout(n,void 0,e)}}const Gn=class kN extends Mr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=mm(s),r&&(r=mm(r)),o&&(o=mm(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Di&&e.add(a),a}};let Nr=(()=>{class n{}return n.__NG_ELEMENT_ID__=VN,n})();const UN=Nr,zN=class extends UN{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tView,r=Bu(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[pl]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[sr];return null!==o&&(r[sr]=o.createEmbeddedView(i)),Fp(i,r,e),new Fl(r)}};function VN(){return function ed(n,e){return 4&n.type?new zN(e,n,Go(n,e)):null}(wn(),Z())}let qi=(()=>{class n{}return n.__NG_ELEMENT_ID__=HN,n})();function HN(){return function $b(n,e){let t;const i=e[n.index];if(zi(i))t=i;else{let r;if(8&n.type)r=xn(i);else{const s=e[Qe];r=s.createComment("");const o=ui(n,e);Os(s,Eu(s,o),r,function zI(n,e){return n.nextSibling(e)}(s,o),!1)}e[n.index]=t=kx(i,e,r,n),zu(e,t)}return new Gb(t,n,e)}(wn(),Z())}const GN=qi,Gb=class extends GN{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Go(this._hostTNode,this._hostLView)}get injector(){return new Lo(this._hostTNode,this._hostLView)}get parentInjector(){const e=Vf(this._hostTNode,this._hostLView);if(V0(e)){const t=yu(e,this._hostLView),i=gu(e);return new Lo(t[ge].data[i+8],t)}return new Lo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Wb(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-kn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,i,r,s){const o=e&&!function wl(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.environmentInjector||d.ngModuleRef}const l=o?e:new Ol(xt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(Rr,null);h&&(s=h)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[ge];if(function mA(n){return zi(n[zt])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[zt],h=new Gb(d,d[En],d[zt]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function FI(n,e,t,i){const r=kn+i,s=t.length;i>0&&(t[r-1][Ui]=e),i<s-kn?(e[Ui]=t[r],e_(t,kn+i,e)):(t.push(e),e[Ui]=null),e[zt]=t;const o=e[pl];null!==o&&t!==o&&function OI(n,e){const t=n[Ao];e[Cn]!==e[zt][zt][Cn]&&(n[m0]=!0),null===t?n[Ao]=[e]:t.push(e)}(o,e);const a=e[sr];null!==a&&a.insertView(n),e[Ze]|=64}(r,i,o,s);const a=up(s,o),l=i[Qe],c=Eu(l,o[lu]);return null!==c&&function PI(n,e,t,i,r,s){i[Cr]=r,i[En]=e,Al(n,i,t,1,r,s)}(r,o[En],l,i,c,a),e.attachToViewContainerRef(),e_(ym(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Wb(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=ap(this._lContainer,t);i&&(bu(ym(this._lContainer),t),S_(i[ge],i))}detach(e){const t=this._adjustIndex(e,-1),i=ap(this._lContainer,t);return i&&null!=bu(ym(this._lContainer),t)?new Fl(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function Wb(n){return n[cu]}function ym(n){return n[cu]||(n[cu]=[])}function nd(...n){}const id=new Ue("Application Initializer");let rd=(()=>{class n{constructor(t){this.appInits=t,this.resolve=nd,this.reject=nd,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(ju(s))t.push(s);else if(ow(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Pe(id,8))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ql=new Ue("AppId",{providedIn:"root",factory:function yM(){return`${Tm()}${Tm()}${Tm()}`}});function Tm(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const vM=new Ue("Platform Initializer"),_M=new Ue("Platform ID",{providedIn:"platform",factory:()=>"unknown"});let y3=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Fr=new Ue("LocaleId",{providedIn:"root",factory:()=>lt(Fr,ke.Optional|ke.SkipSelf)||function v3(){return typeof $localize<"u"&&$localize.locale||sa}()});class x3{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let xM=(()=>{class n{compileModuleSync(t){return new fm(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Pr(li(t).declarations).reduce((o,a)=>{const l=xt(a);return l&&o.push(new Ol(l)),o},[]);return new x3(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const M3=(()=>Promise.resolve(0))();function Am(n){typeof Zone>"u"?M3.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class $t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Gn(!1),this.onMicrotaskEmpty=new Gn(!1),this.onStable=new Gn(!1),this.onError=new Gn(!1),typeof Zone>"u")throw new ce(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function S3(){let n=Pt.requestAnimationFrame,e=Pt.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function C3(n){const e=()=>{!function E3(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Pt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Rm(n),n.isCheckStableRunning=!0,Im(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Rm(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return MM(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),SM(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return MM(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),SM(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Rm(n),Im(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$t.isInAngularZone())throw new ce(909,!1)}static assertNotInAngularZone(){if($t.isInAngularZone())throw new ce(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,D3,nd,nd);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const D3={};function Im(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Rm(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function MM(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function SM(n){n._nesting--,Im(n)}class T3{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Gn,this.onMicrotaskEmpty=new Gn,this.onStable=new Gn,this.onError=new Gn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const DM=new Ue(""),sd=new Ue("");let Nm,Pm=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Nm||(function A3(n){Nm=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$t.assertNotInAngularZone(),Am(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Am(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Pe($t),Pe(Lm),Pe(sd))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),Lm=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Nm?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Or=!1;let rs=null;const EM=new Ue("AllowMultipleToken"),Fm=new Ue("PlatformDestroyListeners"),CM=new Ue("appBootstrapListener");class TM{constructor(e,t){this.name=e,this.token=t}}function IM(n,e,t=[]){const i=`Platform: ${e}`,r=new Ue(i);return(s=[])=>{let o=Om();if(!o||o.injector.get(EM,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function P3(n){if(rs&&!rs.get(EM,!1))throw new ce(400,!1);rs=n;const e=n.get(PM);(function AM(n){const e=n.get(vM,null);e&&e.forEach(t=>t())})(n)}(function RM(n=[],e){return lr.create({name:e,providers:[{provide:Mp,useValue:"platform"},{provide:Fm,useValue:new Set([()=>rs=null])},...n]})}(a,i))}return function N3(n){const e=Om();if(!e)throw new ce(401,!1);return e}()}}function Om(){return rs?.get(PM)??null}let PM=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function NM(n,e){let t;return t="noop"===n?new T3:("zone.js"===n?void 0:n)||new $t(e),t}(i?.ngZone,function LM(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:$t,useValue:r}];return r.run(()=>{const o=lr.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(Wo,null);if(!l)throw new ce(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{ad(this._modules,a),c.unsubscribe()})}),function FM(n,e,t){try{const i=t();return ju(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(rd);return c.runInitializers(),c.donePromise.then(()=>(function rb(n){Ei(n,"Expected localeId to be defined"),"string"==typeof n&&(ib=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Fr,sa)||sa),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=OM({},i);return function I3(n,e,t){const i=new fm(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(od);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new ce(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ce(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(Fm,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Pe(lr))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function OM(n,e){return Array.isArray(e)?e.reduce(OM,n):{...n,...e}}let od=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new on(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new on(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{$t.assertNotInAngularZone(),Am(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{$t.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=function FT(...n){const e=al(n),t=function TT(n,e){return"number"==typeof df(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Bi(i[0]):Mo(t)(an(i,e)):nr}(s,o.pipe(function OT(n={}){const{connector:e=(()=>new Mr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},m=()=>{const p=o;f(),p?.unsubscribe()};return fn((p,g)=>{c++,!d&&!u&&h();const v=l=l??e();g.add(()=>{c--,0===c&&!d&&!u&&(a=hf(m,r))}),v.subscribe(g),!o&&c>0&&(o=new ol({next:_=>v.next(_),error:_=>{d=!0,h(),a=hf(f,t,_),v.error(_)},complete:()=>{u=!0,h(),a=hf(f,i),v.complete()}}),Bi(p).subscribe(o))})(s)}}()))}bootstrap(t,i){const r=t instanceof ox;if(!this._injector.get(rd).done){!r&&function Do(n){const e=xt(n)||Dn(n)||On(n);return null!==e&&e.standalone}(t);throw new ce(405,Or)}let o;o=r?t:this._injector.get(Ll).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function R3(n){return n.isBoundToModule}(o)?void 0:this._injector.get(oa),c=o.create(lr.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(DM,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),ad(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new ce(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;ad(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(CM,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>ad(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ce(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(Pe($t),Pe(Rr),Pe(Wo))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ad(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let km=(()=>{class n{}return n.__NG_ELEMENT_ID__=O3,n})();function O3(n){return function k3(n,e,t){if(gl(n)&&!t){const i=di(n.index,e);return new Fl(i,i)}return 47&n.type?new Fl(e[Cn],e):null}(wn(),Z(),16==(16&n))}const Z3=IM(null,"core",[]);let J3=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Pe(od))},n.\u0275mod=As({type:n}),n.\u0275inj=Kr({}),n})(),Gm=null;function Hs(){return Gm}class eF{}const ri=new Ue("DocumentToken");let Wm=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return function tF(){return Pe(qM)}()},providedIn:"platform"}),n})();const nF=new Ue("Location Initialized");let qM=(()=>{class n extends Wm{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Hs().getBaseHref(this._doc)}onPopState(t){const i=Hs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Hs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){XM()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){XM()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Pe(ri))},n.\u0275prov=Ge({token:n,factory:function(){return function iF(){return new qM(Pe(ri))}()},providedIn:"platform"}),n})();function XM(){return!!window.history.pushState}function $m(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function YM(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function kr(n){return n&&"?"!==n[0]?"?"+n:n}let Gs=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return lt(JM)},providedIn:"root"}),n})();const ZM=new Ue("appBaseHref");let JM=(()=>{class n extends Gs{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??lt(ri).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return $m(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+kr(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+kr(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+kr(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(Pe(Wm),Pe(ZM,8))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rF=(()=>{class n extends Gs{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=$m(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+kr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+kr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(Pe(Wm),Pe(ZM,8))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),jm=(()=>{class n{constructor(t){this._subject=new Gn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function aF(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(YM(KM(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+kr(i))}normalize(t){return n.stripTrailingSlash(function oF(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,KM(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+kr(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+kr(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=kr,n.joinWithSlash=$m,n.stripTrailingSlash=YM,n.\u0275fac=function(t){return new(t||n)(Pe(Gs))},n.\u0275prov=Ge({token:n,factory:function(){return function sF(){return new jm(Pe(Gs))}()},providedIn:"root"}),n})();function KM(n){return n.replace(/\/index.html$/,"")}let dS=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new ZF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){hS("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){hS("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(ze(qi),ze(Nr))},n.\u0275dir=Fn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class ZF{constructor(){this.$implicit=null,this.ngIf=null}}function hS(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${It(e)}'.`)}let wO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=As({type:n}),n.\u0275inj=Kr({}),n})();let DO=(()=>{class n{}return n.\u0275prov=Ge({token:n,providedIn:"root",factory:()=>new EO(Pe(ri),window)}),n})();class EO{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function CO(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=gS(this.window.history)||gS(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function gS(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class tk extends eF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class cg extends tk{static makeCurrent(){!function Q3(n){Gm||(Gm=n)}(new cg)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function nk(){return Kl=Kl||document.querySelector("base"),Kl?Kl.getAttribute("href"):null}();return null==t?null:function ik(n){bd=bd||document.createElement("a"),bd.setAttribute("href",n);const e=bd.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Kl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function WF(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let bd,Kl=null;const wS=new Ue("TRANSITION_ID"),sk=[{provide:id,useFactory:function rk(n,e,t){return()=>{t.get(rd).donePromise.then(()=>{const i=Hs(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[wS,ri,lr],multi:!0}];let ak=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const Md=new Ue("EventManagerPlugins");let Sd=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Pe(Md),Pe($t))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();class bS{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Hs().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let MS=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),Ql=(()=>{class n extends MS{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(Pe(ri))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const ug={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},dg=/%COMP%/g,ES=new Ue("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function CS(n,e){return e.flat(100).map(t=>t.replace(dg,n))}function TS(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let hg=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new fg(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof RS?r.applyToHost(t):r instanceof pg&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case rr.Emulated:s=new RS(o,a,i,this.appId,l);break;case rr.ShadowDom:return new pk(o,a,t,i);default:s=new pg(o,a,i,l)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Pe(Sd),Pe(Ql),Pe(ql),Pe(ES))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();class fg{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(ug[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(IS(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(IS(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=ug[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=ug[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ti.DashCase|ti.Important)?e.style.setProperty(t,i,r&ti.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ti.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,TS(i)):this.eventManager.addEventListener(e,t,TS(i))}}function IS(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class pk extends fg{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=CS(r.id,r.styles);for(const o of s){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class pg extends fg{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=CS(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class RS extends pg{constructor(e,t,i,r,s){const o=r+"-"+i.id;super(e,t,i,s,o),this.contentAttr=function dk(n){return"_ngcontent-%COMP%".replace(dg,n)}(o),this.hostAttr=function hk(n){return"_nghost-%COMP%".replace(dg,n)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let mk=(()=>{class n extends bS{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Pe(ri))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const PS=["alt","control","meta","shift"],gk={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yk={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let vk=(()=>{class n extends bS{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Hs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),PS.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=gk[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),PS.forEach(o=>{o!==r&&(0,yk[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(Pe(ri))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const bk=IM(Z3,"browser",[{provide:_M,useValue:"browser"},{provide:vM,useValue:function _k(){cg.makeCurrent()},multi:!0},{provide:ri,useFactory:function wk(){return function XI(n){pp=n}(document),document},deps:[]}]),FS=new Ue(""),OS=[{provide:sd,useClass:class ok{addToWindow(e){Pt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Pt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Pt.getAllAngularRootElements=()=>e.getAllRootElements(),Pt.frameworkStabilizers||(Pt.frameworkStabilizers=[]),Pt.frameworkStabilizers.push(i=>{const r=Pt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Hs().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:DM,useClass:Pm,deps:[$t,Lm,sd]},{provide:Pm,useClass:Pm,deps:[$t,Lm,sd]}],kS=[{provide:Mp,useValue:"root"},{provide:Wo,useFactory:function xk(){return new Wo},deps:[]},{provide:Md,useClass:mk,multi:!0,deps:[ri,$t,_M]},{provide:Md,useClass:vk,multi:!0,deps:[ri]},{provide:hg,useClass:hg,deps:[Sd,Ql,ql,ES]},{provide:lx,useExisting:hg},{provide:MS,useExisting:Ql},{provide:Ql,useClass:Ql,deps:[ri]},{provide:Sd,useClass:Sd,deps:[Md,$t]},{provide:class TO{},useClass:ak,deps:[]},[]];let Mk=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:ql,useValue:t.appId},{provide:wS,useExisting:ql},sk]}}}return n.\u0275fac=function(t){return new(t||n)(Pe(FS,12))},n.\u0275mod=As({type:n}),n.\u0275inj=Kr({providers:[...kS,...OS],imports:[wO,J3]}),n})(),BS=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(Pe(ri))},n.\u0275prov=Ge({token:n,factory:function(t){let i=null;return i=t?new t:function Dk(){return new BS(Pe(ri))}(),i},providedIn:"root"}),n})();function Ne(...n){return an(n,al(n))}typeof window<"u"&&window;class Ji extends Mr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const Dd=rl(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:Rk}=Array,{getPrototypeOf:Pk,prototype:Lk,keys:Nk}=Object;const{isArray:kk}=Array;function VS(...n){const e=al(n),t=function CT(n){return At(df(n))?n.pop():void 0}(n),{args:i,keys:r}=function Fk(n){if(1===n.length){const e=n[0];if(Rk(e))return{args:e,keys:null};if(function Ok(n){return n&&"object"==typeof n&&Pk(n)===Lk}(e)){const t=Nk(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return an([],e);const s=new on(function Vk(n,e,t=Cs){return i=>{HS(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)HS(e,()=>{const c=an(n[l],e);let u=!1;c.subscribe(pn(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function zk(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):Cs));return t?s.pipe(function Uk(n){return ot(e=>function Bk(n,e){return kk(e)?n(...e):n(e)}(n,e))}(t)):s}function HS(n,e,t){n?Sr(t,n,e):e()}function yg(...n){return function Hk(){return Mo(1)}()(an(n,al(n)))}function GS(n){return new on(e=>{Bi(n()).subscribe(e)})}function ec(n,e){const t=At(n)?n:()=>n,i=r=>r.error(t());return new on(e?r=>e.schedule(i,0,r):i)}function vg(){return fn((n,e)=>{let t=null;n._refCount++;const i=pn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class WS extends on{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Bv(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Di;const t=this.getSubject();e.add(this.source.subscribe(pn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Di.EMPTY)}return e}refCount(){return vg()(this)}}function fr(n,e){return fn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(pn(i,l=>{r?.unsubscribe();let c=0;const u=s++;Bi(n(l,u)).subscribe(r=pn(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function tc(n){return n<=0?()=>nr:fn((e,t)=>{let i=0;e.subscribe(pn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function os(n,e){return fn((t,i)=>{let r=0;t.subscribe(pn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Ed(n){return fn((e,t)=>{let i=!1;e.subscribe(pn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function $S(n=Wk){return fn((e,t)=>{let i=!1;e.subscribe(pn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Wk(){return new Dd}function as(n,e){const t=arguments.length>=2;return i=>i.pipe(n?os((r,s)=>n(r,s,i)):Cs,tc(1),t?Ed(e):$S(()=>new Dd))}function Ws(n,e){return At(e)?_n(n,e,1):_n(n,1)}function Rn(n,e,t){const i=At(n)||e||t?{next:n,error:e,complete:t}:n;return i?fn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(pn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Cs}function ls(n){return fn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(pn(t,void 0,void 0,o=>{s=Bi(n(o,ls(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function jS(n,e){return fn(function $k(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(pn(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}function _g(n){return n<=0?()=>nr:fn((e,t)=>{let i=[];e.subscribe(pn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function qS(n,e){const t=arguments.length>=2;return i=>i.pipe(n?os((r,s)=>n(r,s,i)):Cs,_g(1),t?Ed(e):$S(()=>new Dd))}function xg(n){return fn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Xe="primary",nc=Symbol("RouteTitle");class Xk{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ca(n){return new Xk(n)}function Yk(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function pr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!XS(n[r],e[r]))return!1;return!0}function XS(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function YS(n){return Array.prototype.concat.apply([],n)}function ZS(n){return n.length>0?n[n.length-1]:null}function Mn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function cs(n){return ow(n)?n:ju(n)?an(Promise.resolve(n)):Ne(n)}const Cd=!1,Jk={exact:function QS(n,e,t){if(!$s(n.segments,e.segments)||!Td(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!QS(n.children[i],e.children[i],t))return!1;return!0},subset:eD},JS={exact:function Kk(n,e){return pr(n,e)},subset:function Qk(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>XS(n[t],e[t]))},ignored:()=>!0};function KS(n,e,t){return Jk[t.paths](n.root,e.root,t.matrixParams)&&JS[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function eD(n,e,t){return tD(n,e,e.segments,t)}function tD(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!$s(r,t)||e.hasChildren()||!Td(r,t,i))}if(n.segments.length===t.length){if(!$s(n.segments,t)||!Td(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!eD(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!($s(n.segments,r)&&Td(n.segments,r,i)&&n.children[Xe])&&tD(n.children[Xe],e,s,i)}}function Td(n,e,t){return e.every((i,r)=>JS[t](n[r].parameters,i.parameters))}class us{constructor(e=new tt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ca(this.queryParams)),this._queryParamMap}toString(){return nB.serialize(this)}}class tt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Mn(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ad(this)}}class ic{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ca(this.parameters)),this._parameterMap}toString(){return rD(this)}}function $s(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let rc=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return new wg},providedIn:"root"}),n})();class wg{parse(e){const t=new dB(e);return new us(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${sc(e.root,!0)}`,i=function sB(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Id(t)}=${Id(r)}`).join("&"):`${Id(t)}=${Id(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function iB(n){return encodeURI(n)}(e.fragment)}`:""}`}}const nB=new wg;function Ad(n){return n.segments.map(e=>rD(e)).join("/")}function sc(n,e){if(!n.hasChildren())return Ad(n);if(e){const t=n.children[Xe]?sc(n.children[Xe],!1):"",i=[];return Mn(n.children,(r,s)=>{s!==Xe&&i.push(`${s}:${sc(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function tB(n,e){let t=[];return Mn(n.children,(i,r)=>{r===Xe&&(t=t.concat(e(i,r)))}),Mn(n.children,(i,r)=>{r!==Xe&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Xe?[sc(n.children[Xe],!1)]:[`${r}:${sc(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Xe]?`${Ad(n)}/${t[0]}`:`${Ad(n)}/(${t.join("//")})`}}function nD(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Id(n){return nD(n).replace(/%3B/gi,";")}function bg(n){return nD(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rd(n){return decodeURIComponent(n)}function iD(n){return Rd(n.replace(/\+/g,"%20"))}function rD(n){return`${bg(n.path)}${function rB(n){return Object.keys(n).map(e=>`;${bg(e)}=${bg(n[e])}`).join("")}(n.parameters)}`}const oB=/^[^\/()?;=#]+/;function Pd(n){const e=n.match(oB);return e?e[0]:""}const aB=/^[^=?&#]+/,cB=/^[^&#]+/;class dB{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tt([],{}):new tt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Xe]=new tt(e,t)),i}parseSegment(){const e=Pd(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ce(4009,Cd);return this.capture(e),new ic(Rd(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Pd(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Pd(this.remaining);r&&(i=r,this.capture(i))}e[Rd(t)]=Rd(i)}parseQueryParam(e){const t=function lB(n){const e=n.match(aB);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function uB(n){const e=n.match(cB);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=iD(t),s=iD(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Pd(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ce(4010,Cd);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Xe);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Xe]:new tt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ce(4011,Cd)}}function Mg(n){return n.segments.length>0?new tt([],{[Xe]:n}):n}function Ld(n){const e={};for(const i of Object.keys(n.children)){const s=Ld(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function hB(n){if(1===n.numberOfChildren&&n.children[Xe]){const e=n.children[Xe];return new tt(n.segments.concat(e.segments),e.children)}return n}(new tt(n.segments,e))}function js(n){return n instanceof us}const Sg=!1;function fB(n,e,t,i,r){if(0===t.length)return ua(e.root,e.root,e.root,i,r);const s=function cD(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new lD(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Mn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new lD(t,e,i)}(t);return s.toRoot()?ua(e.root,e.root,new tt([],{}),i,r):function o(l){const c=function mB(n,e,t,i){if(n.isAbsolute)return new da(e.root,!0,0);if(-1===i)return new da(t,t===e.root,0);return function uD(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new ce(4005,Sg&&"Invalid number of '../'");r=i.segments.length}return new da(i,!1,r-s)}(t,i+(oc(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,l),u=c.processChildren?ha(c.segmentGroup,c.index,s.commands):Dg(c.segmentGroup,c.index,s.commands);return ua(e.root,c.segmentGroup,u,i,r)}(n.snapshot?._lastPathIndex)}function oc(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function ac(n){return"object"==typeof n&&null!=n&&n.outlets}function ua(n,e,t,i,r){let o,s={};i&&Mn(i,(l,c)=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:aD(n,e,t);const a=Mg(Ld(o));return new us(a,s,r)}function aD(n,e,t){const i={};return Mn(n.children,(r,s)=>{i[s]=r===e?t:aD(r,e,t)}),new tt(n.segments,i)}class lD{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&oc(i[0]))throw new ce(4003,Sg&&"Root segment cannot have matrix parameters");const r=i.find(ac);if(r&&r!==ZS(i))throw new ce(4004,Sg&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class da{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function Dg(n,e,t){if(n||(n=new tt([],{})),0===n.segments.length&&n.hasChildren())return ha(n,e,t);const i=function yB(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(ac(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!hD(l,c,o))return s;i+=2}else{if(!hD(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new tt(n.segments.slice(0,i.pathIndex),{});return s.children[Xe]=new tt(n.segments.slice(i.pathIndex),n.children),ha(s,0,r)}return i.match&&0===r.length?new tt(n.segments,{}):i.match&&!n.hasChildren()?Eg(n,e,t):i.match?ha(n,0,r):Eg(n,e,t)}function ha(n,e,t){if(0===t.length)return new tt(n.segments,{});{const i=function gB(n){return ac(n[0])?n[0].outlets:{[Xe]:n}}(t),r={};return!i[Xe]&&n.children[Xe]&&1===n.numberOfChildren&&0===n.children[Xe].segments.length?ha(n.children[Xe],e,t):(Mn(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=Dg(n.children[o],e,s))}),Mn(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new tt(n.segments,r))}}function Eg(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(ac(s)){const l=vB(s.outlets);return new tt(i,l)}if(0===r&&oc(t[0])){i.push(new ic(n.segments[e].path,dD(t[0]))),r++;continue}const o=ac(s)?s.outlets[Xe]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&oc(a)?(i.push(new ic(o,dD(a))),r+=2):(i.push(new ic(o,{})),r++)}return new tt(i,{})}function vB(n){const e={};return Mn(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Eg(new tt([],{}),0,t))}),e}function dD(n){const e={};return Mn(n,(t,i)=>e[i]=`${t}`),e}function hD(n,e,t){return n==t.path&&pr(e,t.parameters)}const lc="imperative";class mr{constructor(e,t){this.id=e,this.url=t}}class Cg extends mr{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class qs extends mr{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Nd extends mr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Fd extends mr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class Tg extends mr{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class _B extends mr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xB extends mr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wB extends mr{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class bB extends mr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class MB extends mr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SB{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class DB{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class EB{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CB{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TB{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class AB{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class fD{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let PB=(()=>{class n{createUrlTree(t,i,r,s,o,a){return fB(t||i.root,r,s,o,a)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),NB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(e){return PB.\u0275fac(e)},providedIn:"root"}),n})();class pD{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Ag(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Ag(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Ig(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Ig(e,this._root).map(t=>t.value)}}function Ag(n,e){if(n===e.value)return e;for(const t of e.children){const i=Ag(n,t);if(i)return i}return null}function Ig(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Ig(n,t);if(i.length)return i.unshift(e),i}return[]}class Ur{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function fa(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class mD extends pD{constructor(e,t){super(e),this.snapshot=t,Rg(this,e)}toString(){return this.snapshot.toString()}}function gD(n,e){const t=function FB(n,e){const o=new Od([],{},{},"",{},Xe,e,null,n.root,-1,{});return new vD("",new Ur(o,[]))}(n,e),i=new Ji([new ic("",{})]),r=new Ji({}),s=new Ji({}),o=new Ji({}),a=new Ji(""),l=new pa(i,r,o,a,s,Xe,e,t.root);return l.snapshot=t.root,new mD(new Ur(l,[]),t)}class pa{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(ot(c=>c[nc]))??Ne(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ot(e=>ca(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ot(e=>ca(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function yD(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function OB(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Od{get title(){return this.data?.[nc]}constructor(e,t,i,r,s,o,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ca(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ca(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class vD extends pD{constructor(e,t){super(t),this.url=e,Rg(this,t)}toString(){return _D(this._root)}}function Rg(n,e){e.value._routerState=n,e.children.forEach(t=>Rg(n,t))}function _D(n){const e=n.children.length>0?` { ${n.children.map(_D).join(", ")} } `:"";return`${n.value}${e}`}function Pg(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,pr(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),pr(e.params,t.params)||n.params.next(t.params),function Zk(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!pr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),pr(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Lg(n,e){const t=pr(n.params,e.params)&&function eB(n,e){return $s(n,e)&&n.every((t,i)=>pr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Lg(n.parent,e.parent))}function cc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function BB(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return cc(n,i,r);return cc(n,i)})}(n,e,t);return new Ur(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>cc(n,a)),o}}const i=function UB(n){return new pa(new Ji(n.url),new Ji(n.params),new Ji(n.queryParams),new Ji(n.fragment),new Ji(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>cc(n,s));return new Ur(i,r)}}const Ng="ngNavigationCancelingError";function xD(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=js(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=wD(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function wD(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[Ng]=!0,i.cancellationCode=e,t&&(i.url=t),i}function bD(n){return MD(n)&&js(n.url)}function MD(n){return n&&n[Ng]}class zB{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new uc,this.attachRef=null}}let uc=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new zB,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kd=!1;let SD=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Xe,this.activateEvents=new Gn,this.deactivateEvents=new Gn,this.attachEvents=new Gn,this.detachEvents=new Gn,this.parentContexts=lt(uc),this.location=lt(qi),this.changeDetector=lt(km),this.environmentInjector=lt(Rr)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ce(4012,kd);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ce(4012,kd);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ce(4012,kd);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ce(4013,kd);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new VB(t,a,r.injector);if(i&&function HB(n){return!!n.resolveComponentFactory}(i)){const c=i.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Fn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ps]}),n})();class VB{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===pa?this.route:e===uc?this.childContexts:this.parent.get(e,t)}}let Fg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=hl({type:n,selectors:[["ng-component"]],standalone:!0,features:[Rb],decls:1,vars:0,template:function(t,i){1&t&&In(0,"router-outlet")},dependencies:[SD],encapsulation:2}),n})();function DD(n,e){return n.providers&&!n._injector&&(n._injector=Qu(n.providers,e,`Route: ${n.path}`)),n._injector??e}function kg(n){const e=n.children&&n.children.map(kg),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Xe&&(t.component=Fg),t}function Li(n){return n.outlet||Xe}function ED(n,e){const t=n.filter(i=>Li(i)===e);return t.push(...n.filter(i=>Li(i)!==e)),t}function dc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class qB{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Pg(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=fa(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Mn(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=fa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=fa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=fa(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new AB(s.value.snapshot))}),e.children.length&&this.forwardEvent(new CB(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(Pg(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Pg(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=dc(r.snapshot),l=a?.get(Ll)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class CD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Bd{constructor(e,t){this.component=e,this.route=t}}function XB(n,e,t){const i=n._root;return hc(i,e?e._root:null,t,[i.value])}function ma(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function GT(n){return null!==tu(n)}(n)?e.get(n):n:i}function hc(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=fa(e);return n.children.forEach(o=>{(function ZB(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function JB(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!$s(n.url,e.url);case"pathParamsOrQueryParamsChange":return!$s(n.url,e.url)||!pr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Lg(n,e)||!pr(n.queryParams,e.queryParams);default:return!Lg(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new CD(i)):(s.data=o.data,s._resolvedData=o._resolvedData),hc(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Bd(a.outlet.component,o))}else o&&fc(e,a,r),r.canActivateChecks.push(new CD(i)),hc(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Mn(s,(o,a)=>fc(o,t.getContext(a),r)),r}function fc(n,e,t){const i=fa(n),r=n.value;Mn(i,(s,o)=>{fc(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Bd(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function pc(n){return"function"==typeof n}function Bg(n){return n instanceof Dd||"EmptyError"===n?.name}const Ud=Symbol("INITIAL_VALUE");function ga(){return fr(n=>VS(n.map(e=>e.pipe(tc(1),function Gk(...n){const e=al(n);return fn((t,i)=>{(e?yg(n,t,e):yg(n,t)).subscribe(i)})}(Ud)))).pipe(ot(e=>{for(const t of e)if(!0!==t){if(t===Ud)return Ud;if(!1===t||t instanceof us)return t}return!0}),os(e=>e!==Ud),tc(1)))}function TD(n){return function aT(...n){return Fv(n)}(Rn(e=>{if(js(e))throw xD(0,e)}),ot(e=>!0===e))}const Ug={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function AD(n,e,t,i,r){const s=zg(n,e,t);return s.matched?function pU(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Ne(r.map(o=>{const a=ma(o,n);return cs(function iU(n){return n&&pc(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(ga(),TD()):Ne(!0)}(i=DD(e,i),e,t).pipe(ot(o=>!0===o?s:{...Ug})):Ne(s)}function zg(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Ug}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Yk)(t,n,e);if(!r)return{...Ug};const s={};Mn(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function zd(n,e,t,i){if(t.length>0&&function yU(n,e,t){return t.some(i=>Vd(n,e,i)&&Li(i)!==Xe)}(n,t,i)){const s=new tt(e,function gU(n,e,t,i){const r={};r[Xe]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Li(s)!==Xe){const o=new tt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[Li(s)]=o}return r}(n,e,i,new tt(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function vU(n,e,t){return t.some(i=>Vd(n,e,i))}(n,t,i)){const s=new tt(n.segments,function mU(n,e,t,i,r){const s={};for(const o of i)if(Vd(n,t,o)&&!r[Li(o)]){const a=new tt([],{});a._sourceSegment=n,a._segmentIndexShift=e.length,s[Li(o)]=a}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new tt(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function Vd(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function ID(n,e,t,i){return!!(Li(n)===i||i!==Xe&&Vd(e,t,n))&&("**"===n.path||zg(e,n,t).matched)}function RD(n,e,t){return 0===e.length&&!n.children[t]}const Hd=!1;class Gd{constructor(e){this.segmentGroup=e||null}}class PD{constructor(e){this.urlTree=e}}function mc(n){return ec(new Gd(n))}function LD(n){return ec(new PD(n))}class bU{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=zd(this.urlTree.root,[],[],this.config).segmentGroup,t=new tt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Xe).pipe(ot(s=>this.createUrlTree(Ld(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ls(s=>{if(s instanceof PD)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Gd?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Xe).pipe(ot(r=>this.createUrlTree(Ld(r),e.queryParams,e.fragment))).pipe(ls(r=>{throw r instanceof Gd?this.noMatchError(r):r}))}noMatchError(e){return new ce(4002,Hd)}createUrlTree(e,t,i){const r=Mg(e);return new us(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(ot(s=>new tt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return an(r).pipe(Ws(s=>{const o=i.children[s],a=ED(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(ot(l=>({segment:l,outlet:s})))}),jS((s,o)=>(s[o.outlet]=o.segment,s),{}),qS())}expandSegment(e,t,i,r,s,o){return an(i).pipe(Ws(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(ls(c=>{if(c instanceof Gd)return Ne(null);throw c}))),as(a=>!!a),ls((a,l)=>{if(Bg(a))return RD(t,r,s)?Ne(new tt([],{})):mc(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return ID(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):mc(t):mc(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?LD(s):this.lineralizeSegments(i,s).pipe(_n(o=>{const a=new tt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=zg(t,r,s);if(!a)return mc(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?LD(d):this.lineralizeSegments(r,d).pipe(_n(h=>this.expandSegment(e,t,i,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=DD(i,e),i.loadChildren?(i._loadedRoutes?Ne({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(ot(a=>(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,new tt(r,{})))):Ne(new tt(r,{}))):AD(t,i,r,e).pipe(fr(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=i._injector??e,i,r).pipe(_n(u=>{const d=u.injector??e,h=u.routes,{segmentGroup:f,slicedSegments:m}=zd(t,a,l,h),p=new tt(f.segments,f.children);if(0===m.length&&p.hasChildren())return this.expandChildren(d,h,p).pipe(ot(y=>new tt(a,y)));if(0===h.length&&0===m.length)return Ne(new tt(a,{}));const g=Li(i)===s;return this.expandSegment(d,p,h,m,g?Xe:s,!0).pipe(ot(_=>new tt(a.concat(_.segments),_.children)))})):mc(t)))}getChildConfig(e,t,i){return t.children?Ne({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Ne({routes:t._loadedRoutes,injector:t._loadedInjector}):function fU(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Ne(!0):Ne(r.map(o=>{const a=ma(o,n);return cs(function QB(n){return n&&pc(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(ga(),TD())}(e,t,i).pipe(_n(r=>r?this.configLoader.loadChildren(e,t).pipe(Rn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function xU(n){return ec(wD(Hd,3))}())):Ne({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ne(i);if(r.numberOfChildren>1||!r.children[Xe])return e.redirectTo,ec(new ce(4e3,Hd));r=r.children[Xe]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new us(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Mn(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Mn(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new tt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ce(4001,Hd);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class SU{}class CU{constructor(e,t,i,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=zd(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Xe).pipe(ot(t=>{if(null===t)return null;const i=new Od([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Xe,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Ur(i,t),s=new vD(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=yD(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return an(Object.keys(i.children)).pipe(Ws(r=>{const s=i.children[r],o=ED(t,r);return this.processSegmentGroup(e,o,s,r)}),jS((r,s)=>r&&s?(r.push(...s),r):null),function jk(n,e=!1){return fn((t,i)=>{let r=0;t.subscribe(pn(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(r=>null!==r),Ed(null),qS(),ot(r=>{if(null===r)return null;const s=FD(r);return function TU(n){n.sort((e,t)=>e.value.outlet===Xe?-1:t.value.outlet===Xe?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return an(t).pipe(Ws(o=>this.processSegmentAgainstRoute(o._injector??e,o,i,r,s)),as(o=>!!o),ls(o=>{if(Bg(o))return RD(i,r,s)?Ne([]):Ne(null);throw o}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!ID(t,i,r,s))return Ne(null);let o;if("**"===t.path){const a=r.length>0?ZS(r).parameters:{},l=kD(i)+r.length;o=Ne({snapshot:new Od(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,BD(t),Li(t),t.component??t._loadedComponent??null,t,OD(i),l,UD(t)),consumedSegments:[],remainingSegments:[]})}else o=AD(i,t,r,e).pipe(ot(({matched:a,consumedSegments:l,remainingSegments:c,parameters:u})=>{if(!a)return null;const d=kD(i)+l.length;return{snapshot:new Od(l,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,BD(t),Li(t),t.component??t._loadedComponent??null,t,OD(i),d,UD(t)),consumedSegments:l,remainingSegments:c}}));return o.pipe(fr(a=>{if(null===a)return Ne(null);const{snapshot:l,consumedSegments:c,remainingSegments:u}=a;e=t._injector??e;const d=t._loadedInjector??e,h=function AU(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:m}=zd(i,c,u,h.filter(g=>void 0===g.redirectTo));if(0===m.length&&f.hasChildren())return this.processChildren(d,h,f).pipe(ot(g=>null===g?null:[new Ur(l,g)]));if(0===h.length&&0===m.length)return Ne([new Ur(l,[])]);const p=Li(t)===s;return this.processSegment(d,h,f,m,p?Xe:s).pipe(ot(g=>null===g?null:[new Ur(l,g)]))}))}}function IU(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function FD(n){const e=[],t=new Set;for(const i of n){if(!IU(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=FD(i.children);e.push(new Ur(i.value,r))}return e.filter(i=>!t.has(i))}function OD(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function kD(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function BD(n){return n.data||{}}function UD(n){return n.resolve||{}}function zD(n){return"string"==typeof n.title||null===n.title}function Vg(n){return fr(e=>{const t=n(e);return t?an(t).pipe(ot(()=>e)):Ne(e)})}const ya=new Ue("ROUTES");let Hg=(()=>{class n{constructor(t,i){this.injector=t,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ne(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=cs(t.loadComponent()).pipe(ot(HD),Rn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),xg(()=>{this.componentLoaders.delete(t)})),r=new WS(i,()=>new Mr).pipe(vg());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ne({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(ot(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=YS(l.get(ya,[],ke.Self|ke.Optional)));return{routes:c.map(kg),injector:l}}),xg(()=>{this.childrenLoaders.delete(i)})),o=new WS(s,()=>new Mr).pipe(vg());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return cs(t()).pipe(ot(HD),_n(r=>r instanceof Ab||Array.isArray(r)?Ne(r):an(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(Pe(lr),Pe(xM))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function HD(n){return function UU(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let $d=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Mr,this.configLoader=lt(Hg),this.environmentInjector=lt(Rr),this.urlSerializer=lt(rc),this.rootContexts=lt(uc),this.navigationId=0,this.afterPreactivation=()=>Ne(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new DB(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new SB(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new Ji({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:lc,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(os(i=>0!==i.id),ot(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),fr(i=>{let r=!1,s=!1;return Ne(i).pipe(Rn(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),fr(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const u="";return this.events.next(new Fd(o.id,t.serializeUrl(i.rawUrl),u,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),nr}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return GD(o.source)&&(t.browserUrlTree=o.extractedUrl),Ne(o).pipe(fr(u=>{const d=this.transitions?.getValue();return this.events.next(new Cg(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),d!==this.transitions?.getValue()?nr:Promise.resolve(u)}),function MU(n,e,t,i){return fr(r=>function wU(n,e,t,i,r){return new bU(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(ot(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),Rn(u=>{this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},i.urlAfterRedirects=u.urlAfterRedirects}),function PU(n,e,t,i,r){return _n(s=>function EU(n,e,t,i,r,s,o="emptyOnly"){return new CU(n,e,t,i,r,o,s).recognize().pipe(fr(a=>null===a?function DU(n){return new on(e=>e.error(n))}(new SU):Ne(a)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe(ot(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Rn(u=>{if(i.targetSnapshot=u.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);t.setBrowserUrl(h,u)}t.browserUrlTree=u.urlAfterRedirects}const d=new _B(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:u,extractedUrl:d,source:h,restoredState:f,extras:m}=o,p=new Cg(u,this.urlSerializer.serialize(d),h,f);this.events.next(p);const g=gD(d,this.rootComponentType).snapshot;return Ne(i={...o,targetSnapshot:g,urlAfterRedirects:d,extras:{...m,skipLocationChange:!1,replaceUrl:!1}})}{const u="";return this.events.next(new Fd(o.id,t.serializeUrl(i.extractedUrl),u,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),nr}}),Rn(o=>{const a=new xB(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),ot(o=>i={...o,guards:XB(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function sU(n,e){return _n(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ne({...t,guardsResult:!0}):function oU(n,e,t,i){return an(n).pipe(_n(r=>function hU(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ne(s.map(a=>{const l=dc(e)??r,c=ma(a,l);return cs(function nU(n){return n&&pc(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(as())})).pipe(ga()):Ne(!0)}(r.component,r.route,t,e,i)),as(r=>!0!==r,!0))}(o,i,r,n).pipe(_n(a=>a&&function KB(n){return"boolean"==typeof n}(a)?function aU(n,e,t,i){return an(e).pipe(Ws(r=>yg(function cU(n,e){return null!==n&&e&&e(new EB(n)),Ne(!0)}(r.route.parent,i),function lU(n,e){return null!==n&&e&&e(new TB(n)),Ne(!0)}(r.route,i),function dU(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function YB(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>GS(()=>Ne(o.guards.map(l=>{const c=dc(o.node)??t,u=ma(l,c);return cs(function tU(n){return n&&pc(n.canActivateChild)}(u)?u.canActivateChild(i,n):c.runInContext(()=>u(i,n))).pipe(as())})).pipe(ga())));return Ne(s).pipe(ga())}(n,r.path,t),function uU(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ne(!0);const r=i.map(s=>GS(()=>{const o=dc(e)??t,a=ma(s,o);return cs(function eU(n){return n&&pc(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(as())}));return Ne(r).pipe(ga())}(n,r.route,t))),as(r=>!0!==r,!0))}(i,s,n,e):Ne(a)),ot(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),Rn(o=>{if(i.guardsResult=o.guardsResult,js(o.guardsResult))throw xD(0,o.guardsResult);const a=new wB(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),os(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),Vg(o=>{if(o.guards.canActivateChecks.length)return Ne(o).pipe(Rn(a=>{const l=new bB(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),fr(a=>{let l=!1;return Ne(a).pipe(function LU(n,e){return _n(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Ne(t);let s=0;return an(r).pipe(Ws(o=>function NU(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!zD(r)&&(s[nc]=r.title),function FU(n,e,t,i){const r=function OU(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Ne({});const s={};return an(r).pipe(_n(o=>function kU(n,e,t,i){const r=dc(e)??i,s=ma(n,r);return cs(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(as(),Rn(a=>{s[o]=a}))),_g(1),function qk(n){return ot(()=>n)}(s),ls(o=>Bg(o)?nr:ec(o)))}(s,n,e,i).pipe(ot(o=>(n._resolvedData=o,n.data=yD(n,t).resolve,r&&zD(r)&&(n.data[nc]=r.title),null)))}(o.route,i,n,e)),Rn(()=>s++),_g(1),_n(o=>s===r.length?Ne(t):nr))})}(t.paramsInheritanceStrategy,this.environmentInjector),Rn({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),Rn(a=>{const l=new MB(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),Vg(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(Rn(u=>{l.component=u}),ot(()=>{})));for(const u of l.children)c.push(...a(u));return c};return VS(a(o.targetSnapshot.root)).pipe(Ed(),tc(1))}),Vg(()=>this.afterPreactivation()),ot(o=>{const a=function kB(n,e,t){const i=cc(n,e._root,t?t._root:void 0);return new mD(i,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:a}}),Rn(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((n,e,t)=>ot(i=>(new qB(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),Rn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new qs(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),xg(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),ls(o=>{if(s=!0,MD(o)){bD(o)||(t.navigated=!0,t.restoreHistory(i,!0));const a=new Nd(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),bD(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||GD(i.source)};t.scheduleNavigation(l,lc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const a=new Tg(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(a);try{i.resolve(t.errorHandler(o))}catch(l){i.reject(l)}}return nr}))}))}cancelNavigationTransition(t,i,r){const s=new Nd(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function GD(n){return n!==lc}let WD=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Xe);return i}getResolvedTitleForRoute(t){return t.data[nc]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return lt(zU)},providedIn:"root"}),n})(),zU=(()=>{class n extends WD{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(Pe(BS))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),VU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return lt(GU)},providedIn:"root"}),n})();class HU{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let GU=(()=>{class n extends HU{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=function J0(n){return Qr(()=>{const e=n.prototype.constructor,t=e[Er]||Gf(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Er]||Gf(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}(n)))(i||n)}}(),n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jd=new Ue("",{providedIn:"root",factory:()=>({})});let $U=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return lt(jU)},providedIn:"root"}),n})(),jU=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function qU(n){throw n}function XU(n,e,t){return e.parse("/")}const YU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ZU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let mi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=lt(y3),this.isNgZoneEnabled=!1,this.options=lt(jd,{optional:!0})||{},this.errorHandler=this.options.errorHandler||qU,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||XU,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=lt($U),this.routeReuseStrategy=lt(VU),this.urlCreationStrategy=lt(NB),this.titleStrategy=lt(WD),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=YS(lt(ya,{optional:!0})??[]),this.navigationTransitions=lt($d),this.urlSerializer=lt(rc),this.location=lt(jm),this.isNgZoneEnabled=lt($t)instanceof $t&&$t.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new us,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=gD(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),lc,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(kg),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}return null!==u&&(u=this.removeEmptyProps(u)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,u,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=js(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,lc,null,i)}navigate(t,i={skipLocationChange:!1}){return function JU(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new ce(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...YU}:!1===i?{...ZU}:i,js(t))return KS(this.currentUrlTree,t,r);const s=this.parseUrl(t);return KS(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,u;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h}),u="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:u,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class $D{}let ez=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(os(t=>t instanceof qs),Ws(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=Qu(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return an(r).pipe(Mo())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Ne(null);const s=r.pipe(_n(o=>null===o?Ne(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?an([s,this.loader.loadComponent(i)]).pipe(Mo()):s})}}return n.\u0275fac=function(t){return new(t||n)(Pe(mi),Pe(xM),Pe(Rr),Pe($D),Pe(Hg))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $g=new Ue("");let jD=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Cg?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof qs&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof fD&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new fD(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){!function Cx(){throw new Error("invalid")}()},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();var gi=(()=>((gi=gi||{})[gi.COMPLETE=0]="COMPLETE",gi[gi.FAILED=1]="FAILED",gi[gi.REDIRECTING=2]="REDIRECTING",gi))();const va=!1;function ds(n,e){return{\u0275kind:n,\u0275providers:e}}const jg=new Ue("",{providedIn:"root",factory:()=>!1});function XD(){const n=lt(lr);return e=>{const t=n.get(od);if(e!==t.components[0])return;const i=n.get(mi),r=n.get(YD);1===n.get(qg)&&i.initialNavigation(),n.get(ZD,null,ke.Optional)?.setUpPreloading(),n.get($g,null,ke.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const YD=new Ue(va?"bootstrap done indicator":"",{factory:()=>new Mr}),qg=new Ue(va?"initial navigation":"",{providedIn:"root",factory:()=>1});function sz(){let n=[];return n=va?[{provide:Pu,multi:!0,useFactory:()=>{const e=lt(mi);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function IB(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],ds(1,n)}const ZD=new Ue(va?"router preloader":"");function oz(n){return ds(0,[{provide:ZD,useExisting:ez},{provide:$D,useExisting:n}])}const gc=!1,JD=new Ue(gc?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),az=[jm,{provide:rc,useClass:wg},mi,uc,{provide:pa,useFactory:function qD(n){return n.routerState.root},deps:[mi]},Hg,gc?{provide:jg,useValue:!0}:[]];function lz(){return new TM("Router",mi)}let KD=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[az,gc&&i?.enableTracing?sz().\u0275providers:[],{provide:ya,multi:!0,useValue:t},{provide:JD,useFactory:hz,deps:[[mi,new Ml,new Sl]]},{provide:jd,useValue:i||{}},i?.useHash?{provide:Gs,useClass:rF}:{provide:Gs,useClass:JM},{provide:$g,useFactory:()=>{const n=lt(DO),e=lt($t),t=lt(jd),i=lt($d),r=lt(rc);return t.scrollOffset&&n.setOffset(t.scrollOffset),new jD(r,i,n,e,t)}},i?.preloadingStrategy?oz(i.preloadingStrategy).\u0275providers:[],{provide:TM,multi:!0,useFactory:lz},i?.initialNavigation?fz(i):[],[{provide:QD,useFactory:XD},{provide:CM,multi:!0,useExisting:QD}]]}}static forChild(t){return{ngModule:n,providers:[{provide:ya,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(Pe(JD,8))},n.\u0275mod=As({type:n}),n.\u0275inj=Kr({imports:[Fg]}),n})();function hz(n){if(gc&&n)throw new ce(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function fz(n){return["disabled"===n.initialNavigation?ds(3,[{provide:id,multi:!0,useFactory:()=>{const e=lt(mi);return()=>{e.setUpLocationChangeListener()}}},{provide:qg,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?ds(2,[{provide:qg,useValue:0},{provide:id,multi:!0,deps:[lr],useFactory:e=>{const t=e.get(nF,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(mi),s=e.get(YD);(function tz(n,e){n.events.pipe(os(t=>t instanceof qs||t instanceof Nd||t instanceof Tg||t instanceof Fd),ot(t=>t instanceof qs||t instanceof Fd?gi.COMPLETE:t instanceof Nd&&(0===t.code||1===t.code)?gi.REDIRECTING:gi.FAILED),os(t=>t!==gi.REDIRECTING),tc(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get($d).afterPreactivation=()=>(i(!0),s.closed?Ne(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const QD=new Ue(gc?"Router Initializer":""),mz=[];let gz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=As({type:n}),n.\u0275inj=Kr({imports:[KD.forRoot(mz),KD]}),n})();function eE(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}const Xg="150",_a={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},xa={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},vz=0,tE=1,_z=2,nE=1,xz=2,yc=3,hs=0,yi=1,fs=2,ps=0,wa=1,iE=2,rE=3,sE=4,wz=5,ba=100,bz=101,Mz=102,oE=103,aE=104,Sz=200,Dz=201,Ez=202,Cz=203,lE=204,cE=205,Tz=206,Az=207,Iz=208,Rz=209,Pz=210,Lz=0,Nz=1,Fz=2,Yg=3,Oz=4,kz=5,Bz=6,Uz=7,qd=0,zz=1,Vz=2,zr=0,Hz=1,Gz=2,Wz=3,$z=4,jz=5,Xs=301,Ys=302,Xd=303,Yd=304,vc=306,Zd=1e3,$n=1001,Jd=1002,en=1003,Jg=1004,Kd=1005,tn=1006,uE=1007,Zs=1008,Js=1009,qz=1010,Xz=1011,dE=1012,Yz=1013,Ks=1014,ms=1015,_c=1016,Zz=1017,Jz=1018,Ma=1020,Kz=1021,Ni=1023,Qz=1024,eV=1025,Qs=1026,Sa=1027,tV=1028,nV=1029,iV=1030,rV=1031,sV=1033,Kg=33776,Qg=33777,ey=33778,ty=33779,hE=35840,fE=35841,pE=35842,mE=35843,oV=36196,gE=37492,yE=37496,vE=37808,_E=37809,xE=37810,wE=37811,bE=37812,ME=37813,SE=37814,DE=37815,EE=37816,CE=37817,TE=37818,AE=37819,IE=37820,RE=37821,ny=36492,aV=36283,PE=36284,LE=36285,NE=36286,eo=3e3,Nt=3001,hV=3201,to=0,fV=1,gr="srgb",xc="srgb-linear",OE="display-p3",kE="300 es",oy=1035;class no{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Pn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],io=Math.PI/180,wc=180/Math.PI;function vi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Pn[255&n]+Pn[n>>8&255]+Pn[n>>16&255]+Pn[n>>24&255]+"-"+Pn[255&e]+Pn[e>>8&255]+"-"+Pn[e>>16&15|64]+Pn[e>>24&255]+"-"+Pn[63&t|128]+Pn[t>>8&255]+"-"+Pn[t>>16&255]+Pn[t>>24&255]+Pn[255&i]+Pn[i>>8&255]+Pn[i>>16&255]+Pn[i>>24&255]).toLowerCase()}function Xt(n,e,t){return Math.max(e,Math.min(t,n))}function bc(n,e,t){return(1-t)*n+t*e}function ly(n){return 0==(n&n-1)&&0!==n}function zE(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Vr(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ct(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}class q{constructor(e=0,t=0){q.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ln{constructor(){Ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],m=i[8],p=r[0],g=r[3],v=r[6],_=r[1],y=r[4],x=r[7],b=r[2],S=r[5],I=r[8];return s[0]=o*p+a*_+l*b,s[3]=o*g+a*y+l*S,s[6]=o*v+a*x+l*I,s[1]=c*p+u*_+d*b,s[4]=c*g+u*y+d*S,s[7]=c*v+u*x+d*I,s[2]=h*p+f*_+m*b,s[5]=h*g+f*y+m*S,s[8]=h*v+f*x+m*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,m=t*d+i*h+r*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return e[0]=d*p,e[1]=(r*c-u*i)*p,e[2]=(a*i-r*o)*p,e[3]=h*p,e[4]=(u*t-r*l)*p,e[5]=(r*s-a*t)*p,e[6]=f*p,e[7]=(i*l-c*t)*p,e[8]=(o*t-i*s)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(cy.makeScale(e,t)),this}rotate(e){return this.premultiply(cy.makeRotation(-e)),this}translate(e,t){return this.premultiply(cy.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const cy=new Ln;function VE(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Mc(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;class jn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],m=s[o+2],p=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=m,void(e[t+3]=p);if(d!==p||l!==h||c!==f||u!==m){let g=1-a;const v=l*h+c*f+u*m+d*p,_=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){const b=Math.sqrt(y),S=Math.atan2(b,v*_);g=Math.sin(g*S)/b,a=Math.sin(a*S)/b}const x=a*_;if(l=l*g+h*x,c=c*g+f*x,u=u*g+m*x,d=d*g+p*x,g===1-a){const b=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=b,c*=b,u*=b,d*=b}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],m=s[o+3];return e[t]=a*m+u*d+l*f-c*h,e[t+1]=l*m+u*h+c*d-a*f,e[t+2]=c*m+u*f+a*h-l*d,e[t+3]=u*m-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d-h*f*m;break;case"YXZ":this._x=h*u*d+c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d+h*f*m;break;case"ZXY":this._x=h*u*d-c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d-h*f*m;break;case"ZYX":this._x=h*u*d-c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d+h*f*m;break;case"YZX":this._x=h*u*d+c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d-h*f*m;break;case"XZY":this._x=h*u*d-c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d+h*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class E{constructor(e=0,t=0,i=0){E.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HE.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HE.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return uy.copy(this).projectOnVector(e),this.sub(uy)}reflect(e){return this.sub(uy.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Xt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const uy=new E,HE=new jn;function Ta(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function dy(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const AV=(new Ln).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),IV=(new Ln).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),gs=new E,LV={[xc]:n=>n,[gr]:n=>n.convertSRGBToLinear(),[OE]:function RV(n){return n.convertSRGBToLinear(),gs.set(n.r,n.g,n.b).applyMatrix3(IV),n.setRGB(gs.x,gs.y,gs.z)}},NV={[xc]:n=>n,[gr]:n=>n.convertLinearToSRGB(),[OE]:function PV(n){return gs.set(n.r,n.g,n.b).applyMatrix3(AV),n.setRGB(gs.x,gs.y,gs.z).convertLinearToSRGB()}},qn={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return xc},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(!1===this.enabled||e===t||!e||!t)return n;const i=LV[e],r=NV[t];if(void 0===i||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let Aa;class GE{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Aa&&(Aa=Mc("canvas")),Aa.width=e.width,Aa.height=e.height;const i=Aa.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Aa}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Mc("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Ta(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Ta(t[i]/255)):Ta(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Ia{constructor(e=null){this.isSource=!0,this.uuid=vi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(hy(r[o].isDataTexture?r[o].image:r[o]))}else s=hy(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function hy(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?GE.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let FV=0,ys=(()=>{class n extends no{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=$n,s=$n,o=tn,a=Zs,l=Ni,c=Js,u=n.DEFAULT_ANISOTROPY,d=eo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:FV++}),this.uuid=vi(),this.name="",this.source=new Ia(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new q(0,0),this.repeat=new q(1,1),this.center=new q(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Zd:t.x=t.x-Math.floor(t.x);break;case $n:t.x=t.x<0?0:1;break;case Jd:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Zd:t.y=t.y-Math.floor(t.y);break;case $n:t.y=t.y<0?0:1;break;case Jd:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class St{constructor(e=0,t=0,i=0,r=1){St.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],m=l[9],p=l[2],g=l[6],v=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-p)<.01&&Math.abs(m-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+p)<.1&&Math.abs(m+g)<.1&&Math.abs(c+f+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,x=(f+1)/2,b=(v+1)/2,S=(u+h)/4,I=(d+p)/4,w=(m+g)/4;return y>x&&y>b?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=S/i,s=I/i):x>b?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=S/r,s=w/r):b<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),i=I/s,r=w/s),this.set(i,r,s,t),this}let _=Math.sqrt((g-m)*(g-m)+(d-p)*(d-p)+(h-u)*(h-u));return Math.abs(_)<.001&&(_=1),this.x=(g-m)/_,this.y=(d-p)/_,this.z=(h-u)/_,this.w=Math.acos((c+f+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ro extends no{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new St(0,0,e,t),this.scissorTest=!1,this.viewport=new St(0,0,e,t),this.texture=new ys({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:tn,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Ia(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class fy extends ys{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=en,this.minFilter=en,this.wrapR=$n,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WE extends ys{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=en,this.minFilter=en,this.wrapR=$n,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ra{constructor(e=new E(1/0,1/0,1/0),t=new E(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=so.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)so.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(so)}else null===i.boundingBox&&i.computeBoundingBox(),py.copy(i.boundingBox),py.applyMatrix4(e.matrixWorld),this.union(py);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,so),so.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Sc),ih.subVectors(this.max,Sc),Pa.subVectors(e.a,Sc),La.subVectors(e.b,Sc),Na.subVectors(e.c,Sc),vs.subVectors(La,Pa),_s.subVectors(Na,La),oo.subVectors(Pa,Na);let t=[0,-vs.z,vs.y,0,-_s.z,_s.y,0,-oo.z,oo.y,vs.z,0,-vs.x,_s.z,0,-_s.x,oo.z,0,-oo.x,-vs.y,vs.x,0,-_s.y,_s.x,0,-oo.y,oo.x,0];return!(!my(t,Pa,La,Na,ih)||(t=[1,0,0,0,1,0,0,0,1],!my(t,Pa,La,Na,ih)))&&(rh.crossVectors(vs,_s),t=[rh.x,rh.y,rh.z],my(t,Pa,La,Na,ih))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,so).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(so).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Hr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Hr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Hr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Hr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Hr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Hr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Hr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Hr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Hr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Hr=[new E,new E,new E,new E,new E,new E,new E,new E],so=new E,py=new Ra,Pa=new E,La=new E,Na=new E,vs=new E,_s=new E,oo=new E,Sc=new E,ih=new E,rh=new E,ao=new E;function my(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){ao.fromArray(n,s);const a=r.x*Math.abs(ao.x)+r.y*Math.abs(ao.y)+r.z*Math.abs(ao.z),l=e.dot(ao),c=t.dot(ao),u=i.dot(ao);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const OV=new Ra,Dc=new E,gy=new E;class Fa{constructor(e=new E,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):OV.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Dc.subVectors(e,this.center);const t=Dc.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Dc,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(gy.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Dc.copy(e.center).add(gy)),this.expandByPoint(Dc.copy(e.center).sub(gy))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Gr=new E,yy=new E,sh=new E,xs=new E,vy=new E,oh=new E,_y=new E;class ah{constructor(e=new E,t=new E(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Gr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Gr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Gr.copy(this.origin).addScaledVector(this.direction,t),Gr.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){yy.copy(e).add(t).multiplyScalar(.5),sh.copy(t).sub(e).normalize(),xs.copy(this.origin).sub(yy);const s=.5*e.distanceTo(t),o=-this.direction.dot(sh),a=xs.dot(this.direction),l=-xs.dot(sh),c=xs.lengthSq(),u=Math.abs(1-o*o);let d,h,f,m;if(u>0)if(d=o*l-a,h=o*a-l,m=s*u,d>=0)if(h>=-m)if(h<=m){const p=1/u;d*=p,h*=p,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-m?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=m?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(yy).addScaledVector(sh,h),f}intersectSphere(e,t){Gr.subVectors(e.center,this.origin);const i=Gr.dot(this.direction),r=Gr.dot(Gr)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Gr)}intersectTriangle(e,t,i,r,s){vy.subVectors(t,e),oh.subVectors(i,e),_y.crossVectors(vy,oh);let a,o=this.direction.dot(_y);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}xs.subVectors(this.origin,e);const l=a*this.direction.dot(oh.crossVectors(xs,oh));if(l<0)return null;const c=a*this.direction.dot(vy.cross(xs));if(c<0||l+c>o)return null;const u=-a*xs.dot(_y);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ke{constructor(){Ke.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,s,o,a,l,c,u,d,h,f,m,p,g){const v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=u,v[10]=d,v[14]=h,v[3]=f,v[7]=m,v[11]=p,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ke).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Oa.setFromMatrixColumn(e,0).length(),s=1/Oa.setFromMatrixColumn(e,1).length(),o=1/Oa.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,m=a*u,p=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+m*c,t[5]=h-p*c,t[9]=-a*l,t[2]=p-h*c,t[6]=m+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,m=c*u,p=c*d;t[0]=h+p*a,t[4]=m*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-m,t[6]=p+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,m=c*u,p=c*d;t[0]=h-p*a,t[4]=-o*d,t[8]=m+f*a,t[1]=f+m*a,t[5]=o*u,t[9]=p-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,m=a*u,p=a*d;t[0]=l*u,t[4]=m*c-f,t[8]=h*c+p,t[1]=l*d,t[5]=p*c+h,t[9]=f*c-m,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*u,t[4]=p-h*d,t[8]=m*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+m,t[10]=h-p*d}else if("XZY"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+p,t[5]=o*u,t[9]=f*d-m,t[2]=m*d-f,t[6]=a*u,t[10]=p*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kV,e,BV)}lookAt(e,t,i){const r=this.elements;return _i.subVectors(e,t),0===_i.lengthSq()&&(_i.z=1),_i.normalize(),ws.crossVectors(i,_i),0===ws.lengthSq()&&(1===Math.abs(i.z)?_i.x+=1e-4:_i.z+=1e-4,_i.normalize(),ws.crossVectors(i,_i)),ws.normalize(),lh.crossVectors(_i,ws),r[0]=ws.x,r[4]=lh.x,r[8]=_i.x,r[1]=ws.y,r[5]=lh.y,r[9]=_i.y,r[2]=ws.z,r[6]=lh.z,r[10]=_i.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],m=i[2],p=i[6],g=i[10],v=i[14],_=i[3],y=i[7],x=i[11],b=i[15],S=r[0],I=r[4],w=r[8],D=r[12],R=r[1],U=r[5],X=r[9],O=r[13],L=r[2],V=r[6],J=r[10],ie=r[14],j=r[3],K=r[7],te=r[11],ye=r[15];return s[0]=o*S+a*R+l*L+c*j,s[4]=o*I+a*U+l*V+c*K,s[8]=o*w+a*X+l*J+c*te,s[12]=o*D+a*O+l*ie+c*ye,s[1]=u*S+d*R+h*L+f*j,s[5]=u*I+d*U+h*V+f*K,s[9]=u*w+d*X+h*J+f*te,s[13]=u*D+d*O+h*ie+f*ye,s[2]=m*S+p*R+g*L+v*j,s[6]=m*I+p*U+g*V+v*K,s[10]=m*w+p*X+g*J+v*te,s[14]=m*D+p*O+g*ie+v*ye,s[3]=_*S+y*R+x*L+b*j,s[7]=_*I+y*U+x*V+b*K,s[11]=_*w+y*X+x*J+b*te,s[15]=_*D+y*O+x*ie+b*ye,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],m=e[12],p=e[13],g=e[14],v=e[15],_=d*g*c-p*h*c+p*l*f-a*g*f-d*l*v+a*h*v,y=m*h*c-u*g*c-m*l*f+o*g*f+u*l*v-o*h*v,x=u*p*c-m*d*c+m*a*f-o*p*f-u*a*v+o*d*v,b=m*d*l-u*p*l-m*a*h+o*p*h+u*a*g-o*d*g,S=t*_+i*y+r*x+s*b;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/S;return e[0]=_*I,e[1]=(p*h*s-d*g*s-p*r*f+i*g*f+d*r*v-i*h*v)*I,e[2]=(a*g*s-p*l*s+p*r*c-i*g*c-a*r*v+i*l*v)*I,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*I,e[4]=y*I,e[5]=(u*g*s-m*h*s+m*r*f-t*g*f-u*r*v+t*h*v)*I,e[6]=(m*l*s-o*g*s-m*r*c+t*g*c+o*r*v-t*l*v)*I,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*I,e[8]=x*I,e[9]=(m*d*s-u*p*s-m*i*f+t*p*f+u*i*v-t*d*v)*I,e[10]=(o*p*s-m*a*s+m*i*c-t*p*c-o*i*v+t*a*v)*I,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*I,e[12]=b*I,e[13]=(u*p*r-m*d*r+m*i*h-t*p*h-u*i*g+t*d*g)*I,e[14]=(m*a*r-o*p*r-m*i*l+t*p*l+o*i*g-t*a*g)*I,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*I,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,m=s*d,p=o*u,g=o*d,v=a*d,_=l*c,y=l*u,x=l*d,b=i.x,S=i.y,I=i.z;return r[0]=(1-(p+v))*b,r[1]=(f+x)*b,r[2]=(m-y)*b,r[3]=0,r[4]=(f-x)*S,r[5]=(1-(h+v))*S,r[6]=(g+_)*S,r[7]=0,r[8]=(m+y)*I,r[9]=(g-_)*I,r[10]=(1-(h+p))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Oa.set(r[0],r[1],r[2]).length();const o=Oa.set(r[4],r[5],r[6]).length(),a=Oa.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ki.copy(this);const c=1/s,u=1/o,d=1/a;return Ki.elements[0]*=c,Ki.elements[1]*=c,Ki.elements[2]*=c,Ki.elements[4]*=u,Ki.elements[5]*=u,Ki.elements[6]*=u,Ki.elements[8]*=d,Ki.elements[9]*=d,Ki.elements[10]*=d,t.setFromRotationMatrix(Ki),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,h=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Oa=new E,Ki=new Ke,kV=new E(0,0,0),BV=new E(1,1,1),ws=new E,lh=new E,_i=new E,$E=new Ke,jE=new jn;let UV=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],m=s[10];switch(i){case"XYZ":this._y=Math.asin(Xt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Xt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Xt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Xt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Xt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Xt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return $E.makeRotationFromQuaternion(t),this.setFromRotationMatrix($E,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return jE.setFromEuler(this),this.setFromQuaternion(jE,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class xy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let zV=0;const qE=new E,ka=new jn,Wr=new Ke,ch=new E,Ec=new E,VV=new E,HV=new jn,XE=new E(1,0,0),YE=new E(0,1,0),ZE=new E(0,0,1),GV={type:"added"},JE={type:"removed"};let xi=(()=>{class n extends no{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:zV++}),this.uuid=vi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new E,i=new UV,r=new jn,s=new E(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ke},normalMatrix:{value:new Ln}}),this.matrix=new Ke,this.matrixWorld=new Ke,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new xy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return ka.setFromAxisAngle(t,i),this.quaternion.multiply(ka),this}rotateOnWorldAxis(t,i){return ka.setFromAxisAngle(t,i),this.quaternion.premultiply(ka),this}rotateX(t){return this.rotateOnAxis(XE,t)}rotateY(t){return this.rotateOnAxis(YE,t)}rotateZ(t){return this.rotateOnAxis(ZE,t)}translateOnAxis(t,i){return qE.copy(t).applyQuaternion(this.quaternion),this.position.add(qE.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(XE,t)}translateY(t){return this.translateOnAxis(YE,t)}translateZ(t){return this.translateOnAxis(ZE,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Wr.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?ch.copy(t):ch.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Ec.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Wr.lookAt(Ec,ch,this.up):Wr.lookAt(ch,Ec,this.up),this.quaternion.setFromRotationMatrix(Wr),s&&(Wr.extractRotation(s.matrixWorld),ka.setFromRotationMatrix(Wr),this.quaternion.premultiply(ka.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(GV)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(JE)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(JE)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Wr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Wr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Wr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ec,t,VV),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ec,HV,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),m=a(t.animations),p=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),m.length>0&&(r.animations=m),p.length>0&&(r.nodes=p)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new E(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Qi=new E,$r=new E,wy=new E,jr=new E,Ba=new E,Ua=new E,KE=new E,by=new E,My=new E,Sy=new E;class er{constructor(e=new E,t=new E,i=new E){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Qi.subVectors(e,t),r.cross(Qi);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Qi.subVectors(r,t),$r.subVectors(i,t),wy.subVectors(e,t);const o=Qi.dot(Qi),a=Qi.dot($r),l=Qi.dot(wy),c=$r.dot($r),u=$r.dot(wy),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,m=(o*u-a*l)*h;return s.set(1-f-m,m,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,jr),jr.x>=0&&jr.y>=0&&jr.x+jr.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,jr),l.set(0,0),l.addScaledVector(s,jr.x),l.addScaledVector(o,jr.y),l.addScaledVector(a,jr.z),l}static isFrontFacing(e,t,i,r){return Qi.subVectors(i,t),$r.subVectors(e,t),Qi.cross($r).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Qi.subVectors(this.c,this.b),$r.subVectors(this.a,this.b),.5*Qi.cross($r).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return er.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return er.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return er.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return er.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return er.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ba.subVectors(r,i),Ua.subVectors(s,i),by.subVectors(e,i);const l=Ba.dot(by),c=Ua.dot(by);if(l<=0&&c<=0)return t.copy(i);My.subVectors(e,r);const u=Ba.dot(My),d=Ua.dot(My);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(Ba,o);Sy.subVectors(e,s);const f=Ba.dot(Sy),m=Ua.dot(Sy);if(m>=0&&f<=m)return t.copy(s);const p=f*c-l*m;if(p<=0&&c>=0&&m<=0)return a=c/(c-m),t.copy(i).addScaledVector(Ua,a);const g=u*m-f*d;if(g<=0&&d-u>=0&&f-m>=0)return KE.subVectors(s,r),a=(d-u)/(d-u+(f-m)),t.copy(r).addScaledVector(KE,a);const v=1/(g+p+h);return o=p*v,a=h*v,t.copy(i).addScaledVector(Ba,o).addScaledVector(Ua,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let WV=0;class Cc extends no{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:WV++}),this.uuid=vi(),this.name="",this.type="Material",this.blending=wa,this.side=hs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=lE,this.blendDst=cE,this.blendEquation=ba,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Yg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==wa&&(i.blending=this.blending),this.side!==hs&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const QE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},tr={h:0,s:0,l:0},uh={h:0,s:0,l:0};function Dy(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class _e{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=gr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,qn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=qn.workingColorSpace){return this.r=e,this.g=t,this.b=i,qn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=qn.workingColorSpace){if(e=function ay(n,e){return(n%e+e)%e}(e,1),t=Xt(t,0,1),i=Xt(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Dy(o,s,e+1/3),this.g=Dy(o,s,e),this.b=Dy(o,s,e-1/3)}return qn.toWorkingColorSpace(this,r),this}setStyle(e,t=gr){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,qn.toWorkingColorSpace(this,t),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,qn.toWorkingColorSpace(this,t),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,u=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,u,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,qn.toWorkingColorSpace(this,t),this;if(6===o)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,qn.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=gr){const i=QE[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ta(e.r),this.g=Ta(e.g),this.b=Ta(e.b),this}copyLinearToSRGB(e){return this.r=dy(e.r),this.g=dy(e.g),this.b=dy(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=gr){return qn.fromWorkingColorSpace(Nn.copy(this),e),Xt(255*Nn.r,0,255)<<16^Xt(255*Nn.g,0,255)<<8^Xt(255*Nn.b,0,255)<<0}getHexString(e=gr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=qn.workingColorSpace){qn.fromWorkingColorSpace(Nn.copy(this),t);const i=Nn.r,r=Nn.g,s=Nn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=qn.workingColorSpace){return qn.fromWorkingColorSpace(Nn.copy(this),t),e.r=Nn.r,e.g=Nn.g,e.b=Nn.b,e}getStyle(e=gr){qn.fromWorkingColorSpace(Nn.copy(this),e);const t=Nn.r,i=Nn.g,r=Nn.b;return e!==gr?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*t|0},${255*i|0},${255*r|0})`}offsetHSL(e,t,i){return this.getHSL(tr),tr.h+=e,tr.s+=t,tr.l+=i,this.setHSL(tr.h,tr.s,tr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(tr),e.getHSL(uh);const i=bc(tr.h,uh.h,t),r=bc(tr.s,uh.s,t),s=bc(tr.l,uh.l,t);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Nn=new _e;_e.NAMES=QE;class Tt extends Cc{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const nn=new E,dh=new q;class mn{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)dh.fromBufferAttribute(this,t),dh.applyMatrix3(e),this.setXY(t,dh.x,dh.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)nn.fromBufferAttribute(this,t),nn.applyMatrix3(e),this.setXYZ(t,nn.x,nn.y,nn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)nn.fromBufferAttribute(this,t),nn.applyMatrix4(e),this.setXYZ(t,nn.x,nn.y,nn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)nn.fromBufferAttribute(this,t),nn.applyNormalMatrix(e),this.setXYZ(t,nn.x,nn.y,nn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)nn.fromBufferAttribute(this,t),nn.transformDirection(e),this.setXYZ(t,nn.x,nn.y,nn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Vr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ct(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Vr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ct(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Vr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ct(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Vr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ct(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ct(t,this.array),i=Ct(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Ct(t,this.array),i=Ct(i,this.array),r=Ct(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Ct(t,this.array),i=Ct(i,this.array),r=Ct(r,this.array),s=Ct(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class eC extends mn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class tC extends mn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Me extends mn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let $V=0;const Fi=new Ke,Ey=new xi,za=new E,wi=new Ra,Tc=new Ra,gn=new E;class rt extends no{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:$V++}),this.uuid=vi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(VE(e)?tC:eC)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Ln).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fi.makeRotationFromQuaternion(e),this.applyMatrix4(Fi),this}rotateX(e){return Fi.makeRotationX(e),this.applyMatrix4(Fi),this}rotateY(e){return Fi.makeRotationY(e),this.applyMatrix4(Fi),this}rotateZ(e){return Fi.makeRotationZ(e),this.applyMatrix4(Fi),this}translate(e,t,i){return Fi.makeTranslation(e,t,i),this.applyMatrix4(Fi),this}scale(e,t,i){return Fi.makeScale(e,t,i),this.applyMatrix4(Fi),this}lookAt(e){return Ey.lookAt(e),Ey.updateMatrix(),this.applyMatrix4(Ey.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(za).negate(),this.translate(za.x,za.y,za.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Me(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ra);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)wi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(gn.addVectors(this.boundingBox.min,wi.min),this.boundingBox.expandByPoint(gn),gn.addVectors(this.boundingBox.max,wi.max),this.boundingBox.expandByPoint(gn)):(this.boundingBox.expandByPoint(wi.min),this.boundingBox.expandByPoint(wi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Fa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new E,1/0);if(e){const i=this.boundingSphere.center;if(wi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Tc.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(gn.addVectors(wi.min,Tc.min),wi.expandByPoint(gn),gn.addVectors(wi.max,Tc.max),wi.expandByPoint(gn)):(wi.expandByPoint(Tc.min),wi.expandByPoint(Tc.max));wi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)gn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(gn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)gn.fromBufferAttribute(a,c),l&&(za.fromBufferAttribute(e,c),gn.add(za)),r=Math.max(r,i.distanceToSquared(gn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new mn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let R=0;R<a;R++)c[R]=new E,u[R]=new E;const d=new E,h=new E,f=new E,m=new q,p=new q,g=new q,v=new E,_=new E;function y(R,U,X){d.fromArray(r,3*R),h.fromArray(r,3*U),f.fromArray(r,3*X),m.fromArray(o,2*R),p.fromArray(o,2*U),g.fromArray(o,2*X),h.sub(d),f.sub(d),p.sub(m),g.sub(m);const O=1/(p.x*g.y-g.x*p.y);isFinite(O)&&(v.copy(h).multiplyScalar(g.y).addScaledVector(f,-p.y).multiplyScalar(O),_.copy(f).multiplyScalar(p.x).addScaledVector(h,-g.x).multiplyScalar(O),c[R].add(v),c[U].add(v),c[X].add(v),u[R].add(_),u[U].add(_),u[X].add(_))}let x=this.groups;0===x.length&&(x=[{start:0,count:i.length}]);for(let R=0,U=x.length;R<U;++R){const X=x[R],O=X.start;for(let V=O,J=O+X.count;V<J;V+=3)y(i[V+0],i[V+1],i[V+2])}const b=new E,S=new E,I=new E,w=new E;function D(R){I.fromArray(s,3*R),w.copy(I);const U=c[R];b.copy(U),b.sub(I.multiplyScalar(I.dot(U))).normalize(),S.crossVectors(w,U);const O=S.dot(u[R])<0?-1:1;l[4*R]=b.x,l[4*R+1]=b.y,l[4*R+2]=b.z,l[4*R+3]=O}for(let R=0,U=x.length;R<U;++R){const X=x[R],O=X.start;for(let V=O,J=O+X.count;V<J;V+=3)D(i[V+0]),D(i[V+1]),D(i[V+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new mn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new E,s=new E,o=new E,a=new E,l=new E,c=new E,u=new E,d=new E;if(e)for(let h=0,f=e.count;h<f;h+=3){const m=e.getX(h+0),p=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,m),s.fromBufferAttribute(t,p),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,m),l.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(m,a.x,a.y,a.z),i.setXYZ(p,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)gn.fromBufferAttribute(e,t),gn.normalize(),e.setXYZ(t,gn.x,gn.y,gn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,m=0;for(let p=0,g=l.length;p<g;p++){f=a.isInterleavedBufferAttribute?l[p]*a.data.stride+a.offset:l[p]*u;for(let v=0;v<u;v++)h[m++]=c[f++]}return new mn(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new rt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const nC=new Ke,yr=new ah,hh=new Fa,iC=new E,Ac=new E,Ic=new E,Rc=new E,Cy=new E,fh=new E,ph=new q,mh=new q,gh=new q,Ty=new E,yh=new E;class ft extends xi{constructor(e=new rt,t=new Tt){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){fh.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&(Cy.fromBufferAttribute(s[l],e),fh.addScaledVector(o?Cy:Cy.sub(t),u))}t.add(fh)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),hh.copy(i.boundingSphere),hh.applyMatrix4(s),yr.copy(e.ray).recast(e.near),!1===hh.containsPoint(yr.origin)&&(null===yr.intersectSphere(hh,iC)||yr.origin.distanceToSquared(iC)>(e.far-e.near)**2))||(nC.copy(s).invert(),yr.copy(e.ray).applyMatrix4(nC),null!==i.boundingBox&&!1===yr.intersectsBox(i.boundingBox)))return;let o;const a=i.index,l=i.attributes.position,c=i.attributes.uv,u=i.attributes.uv2,d=i.groups,h=i.drawRange;if(null!==a)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const p=d[f],g=r[p.materialIndex];for(let y=Math.max(p.start,h.start),x=Math.min(a.count,Math.min(p.start+p.count,h.start+h.count));y<x;y+=3){const b=a.getX(y),S=a.getX(y+1),I=a.getX(y+2);o=vh(this,g,e,yr,c,u,b,S,I),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else for(let p=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);p<g;p+=3){const v=a.getX(p),_=a.getX(p+1),y=a.getX(p+2);o=vh(this,r,e,yr,c,u,v,_,y),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const p=d[f],g=r[p.materialIndex];for(let y=Math.max(p.start,h.start),x=Math.min(l.count,Math.min(p.start+p.count,h.start+h.count));y<x;y+=3)o=vh(this,g,e,yr,c,u,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=p.materialIndex,t.push(o))}else for(let p=Math.max(0,h.start),g=Math.min(l.count,h.start+h.count);p<g;p+=3)o=vh(this,r,e,yr,c,u,p,p+1,p+2),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}}function vh(n,e,t,i,r,s,o,a,l){n.getVertexPosition(o,Ac),n.getVertexPosition(a,Ic),n.getVertexPosition(l,Rc);const c=function jV(n,e,t,i,r,s,o,a){let l;if(l=e.side===yi?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side===hs,a),null===l)return null;yh.copy(a),yh.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(yh);return c<t.near||c>t.far?null:{distance:c,point:yh.clone(),object:n}}(n,e,t,i,Ac,Ic,Rc,Ty);if(c){r&&(ph.fromBufferAttribute(r,o),mh.fromBufferAttribute(r,a),gh.fromBufferAttribute(r,l),c.uv=er.getUV(Ty,Ac,Ic,Rc,ph,mh,gh,new q)),s&&(ph.fromBufferAttribute(s,o),mh.fromBufferAttribute(s,a),gh.fromBufferAttribute(s,l),c.uv2=er.getUV(Ty,Ac,Ic,Rc,ph,mh,gh,new q));const u={a:o,b:a,c:l,normal:new E,materialIndex:0};er.getNormal(Ac,Ic,Rc,u.normal),c.face=u}return c}class Xn extends rt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function m(p,g,v,_,y,x,b,S,I,w,D){const R=x/I,U=b/w,X=x/2,O=b/2,L=S/2,V=I+1,J=w+1;let ie=0,j=0;const K=new E;for(let te=0;te<J;te++){const ye=te*U-O;for(let z=0;z<V;z++)K[p]=(z*R-X)*_,K[g]=ye*y,K[v]=L,c.push(K.x,K.y,K.z),K[p]=0,K[g]=0,K[v]=S>0?1:-1,u.push(K.x,K.y,K.z),d.push(z/I),d.push(1-te/w),ie+=1}for(let te=0;te<w;te++)for(let ye=0;ye<I;ye++){const ee=h+ye+V*(te+1),ae=h+(ye+1)+V*(te+1),k=h+(ye+1)+V*te;l.push(h+ye+V*te,ee,k),l.push(ee,ae,k),j+=6}a.addGroup(f,j,D),f+=j,h+=ie}m("z","y","x",-1,-1,i,t,e,o,s,0),m("z","y","x",1,-1,i,t,-e,o,s,1),m("x","z","y",1,1,e,i,t,r,o,2),m("x","z","y",1,-1,e,i,-t,r,o,3),m("x","y","z",1,-1,e,t,i,r,s,4),m("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Me(c,3)),this.setAttribute("normal",new Me(u,3)),this.setAttribute("uv",new Me(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Va(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Yn(n){const e={};for(let t=0;t<n.length;t++){const i=Va(n[t]);for(const r in i)e[r]=i[r]}return e}function rC(n){return null===n.getRenderTarget()&&n.outputEncoding===Nt?gr:xc}const XV={clone:Va,merge:Yn};class bs extends Cc{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Va(e.uniforms),this.uniformsGroups=function qV(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Ay extends xi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ke,this.projectionMatrix=new Ke,this.projectionMatrixInverse=new Ke}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Sn extends Ay{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*wc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*io*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*wc*Math.atan(Math.tan(.5*io*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*io*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class JV extends xi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new Sn(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new Sn(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new Sn(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Sn(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new Sn(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new Sn(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),d=e.toneMapping,h=e.xr.enabled;e.toneMapping=zr,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=d,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class _h extends ys{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:Xs,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class KV extends ro{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new _h([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:tn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Xn(5,5,5),s=new bs({name:"CubemapFromEquirect",uniforms:Va(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:yi,blending:ps});s.uniforms.tEquirect.value=t;const o=new ft(r,s),a=t.minFilter;return t.minFilter===Zs&&(t.minFilter=tn),new JV(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Iy=new E,QV=new E,e4=new Ln;class lo{constructor(e=new E(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Iy.subVectors(i,t).cross(QV.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Iy),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||e4.getNormalMatrix(e),r=this.coplanarPoint(Iy).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Wa=new Fa,xh=new E;class Ry{constructor(e=new lo,t=new lo,i=new lo,r=new lo,s=new lo,o=new lo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],m=i[10],p=i[11],g=i[12],v=i[13],_=i[14],y=i[15];return t[0].setComponents(a-r,d-l,p-h,y-g).normalize(),t[1].setComponents(a+r,d+l,p+h,y+g).normalize(),t[2].setComponents(a+s,d+c,p+f,y+v).normalize(),t[3].setComponents(a-s,d-c,p-f,y-v).normalize(),t[4].setComponents(a-o,d-u,p-m,y-_).normalize(),t[5].setComponents(a+o,d+u,p+m,y+_).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Wa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Wa)}intersectsSprite(e){return Wa.center.set(0,0,0),Wa.radius=.7071067811865476,Wa.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wa)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(xh.x=r.normal.x>0?e.max.x:e.min.x,xh.y=r.normal.y>0?e.max.y:e.min.y,xh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(xh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function sC(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function t4(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let m;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)m=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=5131}else m=5123;else if(d instanceof Int16Array)m=5122;else if(d instanceof Uint32Array)m=5125;else if(d instanceof Int32Array)m=5124;else if(d instanceof Int8Array)m=5120;else if(d instanceof Uint8Array)m=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);m=5121}return{buffer:f,type:m,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,c,u),d.version=c.version)}}}class wh extends rt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],m=[],p=[],g=[];for(let v=0;v<u;v++){const _=v*h-o;for(let y=0;y<c;y++)m.push(y*d-s,-_,0),p.push(0,0,1),g.push(y/a),g.push(1-v/l)}for(let v=0;v<l;v++)for(let _=0;_<a;_++){const x=_+c*(v+1),b=_+1+c*(v+1),S=_+1+c*v;f.push(_+c*v,x,S),f.push(x,b,S)}this.setIndex(f),this.setAttribute("position",new Me(m,3)),this.setAttribute("normal",new Me(p,3)),this.setAttribute("uv",new Me(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wh(e.width,e.height,e.widthSegments,e.heightSegments)}}const et={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},le={common:{diffuse:{value:new _e(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ln},uv2Transform:{value:new Ln},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new q(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _e(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _e(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ln}},sprite:{diffuse:{value:new _e(16777215)},opacity:{value:1},center:{value:new q(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ln}}},vr={basic:{uniforms:Yn([le.common,le.specularmap,le.envmap,le.aomap,le.lightmap,le.fog]),vertexShader:et.meshbasic_vert,fragmentShader:et.meshbasic_frag},lambert:{uniforms:Yn([le.common,le.specularmap,le.envmap,le.aomap,le.lightmap,le.emissivemap,le.bumpmap,le.normalmap,le.displacementmap,le.fog,le.lights,{emissive:{value:new _e(0)}}]),vertexShader:et.meshlambert_vert,fragmentShader:et.meshlambert_frag},phong:{uniforms:Yn([le.common,le.specularmap,le.envmap,le.aomap,le.lightmap,le.emissivemap,le.bumpmap,le.normalmap,le.displacementmap,le.fog,le.lights,{emissive:{value:new _e(0)},specular:{value:new _e(1118481)},shininess:{value:30}}]),vertexShader:et.meshphong_vert,fragmentShader:et.meshphong_frag},standard:{uniforms:Yn([le.common,le.envmap,le.aomap,le.lightmap,le.emissivemap,le.bumpmap,le.normalmap,le.displacementmap,le.roughnessmap,le.metalnessmap,le.fog,le.lights,{emissive:{value:new _e(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:et.meshphysical_vert,fragmentShader:et.meshphysical_frag},toon:{uniforms:Yn([le.common,le.aomap,le.lightmap,le.emissivemap,le.bumpmap,le.normalmap,le.displacementmap,le.gradientmap,le.fog,le.lights,{emissive:{value:new _e(0)}}]),vertexShader:et.meshtoon_vert,fragmentShader:et.meshtoon_frag},matcap:{uniforms:Yn([le.common,le.bumpmap,le.normalmap,le.displacementmap,le.fog,{matcap:{value:null}}]),vertexShader:et.meshmatcap_vert,fragmentShader:et.meshmatcap_frag},points:{uniforms:Yn([le.points,le.fog]),vertexShader:et.points_vert,fragmentShader:et.points_frag},dashed:{uniforms:Yn([le.common,le.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:et.linedashed_vert,fragmentShader:et.linedashed_frag},depth:{uniforms:Yn([le.common,le.displacementmap]),vertexShader:et.depth_vert,fragmentShader:et.depth_frag},normal:{uniforms:Yn([le.common,le.bumpmap,le.normalmap,le.displacementmap,{opacity:{value:1}}]),vertexShader:et.meshnormal_vert,fragmentShader:et.meshnormal_frag},sprite:{uniforms:Yn([le.sprite,le.fog]),vertexShader:et.sprite_vert,fragmentShader:et.sprite_frag},background:{uniforms:{uvTransform:{value:new Ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:et.background_vert,fragmentShader:et.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:et.backgroundCube_vert,fragmentShader:et.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:et.cube_vert,fragmentShader:et.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:et.equirect_vert,fragmentShader:et.equirect_frag},distanceRGBA:{uniforms:Yn([le.common,le.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:et.distanceRGBA_vert,fragmentShader:et.distanceRGBA_frag},shadow:{uniforms:Yn([le.lights,le.fog,{color:{value:new _e(0)},opacity:{value:1}}]),vertexShader:et.shadow_vert,fragmentShader:et.shadow_frag}};vr.physical={uniforms:Yn([vr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new q(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new _e(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new q},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new _e(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new _e(1,1,1)},specularColorMap:{value:null}}]),vertexShader:et.meshphysical_vert,fragmentShader:et.meshphysical_frag};const bh={r:0,b:0,g:0};function e5(n,e,t,i,r,s,o){const a=new _e(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function p(g,v){g.getRGB(bh,rC(n)),i.buffers.color.setClear(bh.r,bh.g,bh.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(g,v=1){a.set(g),l=v,p(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,p(a,l)},render:function m(g,v){let _=!1,y=!0===v.isScene?v.background:null;y&&y.isTexture&&(y=(v.backgroundBlurriness>0?t:e).get(y));const x=n.xr,b=x.getSession&&x.getSession();b&&"additive"===b.environmentBlendMode&&(y=null),null===y?p(a,l):y&&y.isColor&&(p(y,1),_=!0),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===vc)?(void 0===u&&(u=new ft(new Xn(1,1,1),new bs({name:"BackgroundCubeMaterial",uniforms:Va(vr.backgroundCube.uniforms),vertexShader:vr.backgroundCube.vertexShader,fragmentShader:vr.backgroundCube.fragmentShader,side:yi,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(S,I,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=y.encoding!==Nt,(d!==y||h!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===c&&(c=new ft(new wh(2,2),new bs({name:"BackgroundMaterial",uniforms:Va(vr.background.uniforms),vertexShader:vr.background.vertexShader,fragmentShader:vr.background.fragmentShader,side:hs,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=y.encoding!==Nt,!0===y.matrixAutoUpdate&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||h!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function t5(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(L){return i.isWebGL2?n.bindVertexArray(L):s.bindVertexArrayOES(L)}function m(L){return i.isWebGL2?n.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function g(L){const V=[],J=[],ie=[];for(let j=0;j<r;j++)V[j]=0,J[j]=0,ie[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:J,attributeDivisors:ie,object:L,attributes:{},index:null}}function y(){const L=c.newAttributes;for(let V=0,J=L.length;V<J;V++)L[V]=0}function x(L){b(L,0)}function b(L,V){const ie=c.enabledAttributes,j=c.attributeDivisors;c.newAttributes[L]=1,0===ie[L]&&(n.enableVertexAttribArray(L),ie[L]=1),j[L]!==V&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,V),j[L]=V)}function S(){const L=c.newAttributes,V=c.enabledAttributes;for(let J=0,ie=V.length;J<ie;J++)V[J]!==L[J]&&(n.disableVertexAttribArray(J),V[J]=0)}function I(L,V,J,ie,j,K){!0!==i.isWebGL2||5124!==J&&5125!==J?n.vertexAttribPointer(L,V,J,ie,j,K):n.vertexAttribIPointer(L,V,J,j,K)}function X(){O(),u=!0,c!==l&&(c=l,f(c.object))}function O(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(L,V,J,ie,j){let K=!1;if(o){const te=function p(L,V,J){const ie=!0===J.wireframe;let j=a[L.id];void 0===j&&(j={},a[L.id]=j);let K=j[V.id];void 0===K&&(K={},j[V.id]=K);let te=K[ie];return void 0===te&&(te=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),K[ie]=te),te}(ie,J,V);c!==te&&(c=te,f(c.object)),K=function v(L,V,J,ie){const j=c.attributes,K=V.attributes;let te=0;const ye=J.getAttributes();for(const z in ye)if(ye[z].location>=0){const ae=j[z];let k=K[z];if(void 0===k&&("instanceMatrix"===z&&L.instanceMatrix&&(k=L.instanceMatrix),"instanceColor"===z&&L.instanceColor&&(k=L.instanceColor)),void 0===ae||ae.attribute!==k||k&&ae.data!==k.data)return!0;te++}return c.attributesNum!==te||c.index!==ie}(L,ie,J,j),K&&function _(L,V,J,ie){const j={},K=V.attributes;let te=0;const ye=J.getAttributes();for(const z in ye)if(ye[z].location>=0){let ae=K[z];void 0===ae&&("instanceMatrix"===z&&L.instanceMatrix&&(ae=L.instanceMatrix),"instanceColor"===z&&L.instanceColor&&(ae=L.instanceColor));const k={};k.attribute=ae,ae&&ae.data&&(k.data=ae.data),j[z]=k,te++}c.attributes=j,c.attributesNum=te,c.index=ie}(L,ie,J,j)}else{const te=!0===V.wireframe;(c.geometry!==ie.id||c.program!==J.id||c.wireframe!==te)&&(c.geometry=ie.id,c.program=J.id,c.wireframe=te,K=!0)}null!==j&&t.update(j,34963),(K||u)&&(u=!1,function w(L,V,J,ie){if(!1===i.isWebGL2&&(L.isInstancedMesh||ie.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const j=ie.attributes,K=J.getAttributes(),te=V.defaultAttributeValues;for(const ye in K){const z=K[ye];if(z.location>=0){let ee=j[ye];if(void 0===ee&&("instanceMatrix"===ye&&L.instanceMatrix&&(ee=L.instanceMatrix),"instanceColor"===ye&&L.instanceColor&&(ee=L.instanceColor)),void 0!==ee){const ae=ee.normalized,k=ee.itemSize,xe=t.get(ee);if(void 0===xe)continue;const pe=xe.buffer,ve=xe.type,be=xe.bytesPerElement;if(ee.isInterleavedBufferAttribute){const Se=ee.data,Be=Se.stride,Y=ee.offset;if(Se.isInstancedInterleavedBuffer){for(let Q=0;Q<z.locationSize;Q++)b(z.location+Q,Se.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===ie._maxInstanceCount&&(ie._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let Q=0;Q<z.locationSize;Q++)x(z.location+Q);n.bindBuffer(34962,pe);for(let Q=0;Q<z.locationSize;Q++)I(z.location+Q,k/z.locationSize,ve,ae,Be*be,(Y+k/z.locationSize*Q)*be)}else{if(ee.isInstancedBufferAttribute){for(let Se=0;Se<z.locationSize;Se++)b(z.location+Se,ee.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===ie._maxInstanceCount&&(ie._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Se=0;Se<z.locationSize;Se++)x(z.location+Se);n.bindBuffer(34962,pe);for(let Se=0;Se<z.locationSize;Se++)I(z.location+Se,k/z.locationSize,ve,ae,k*be,k/z.locationSize*Se*be)}}else if(void 0!==te){const ae=te[ye];if(void 0!==ae)switch(ae.length){case 2:n.vertexAttrib2fv(z.location,ae);break;case 3:n.vertexAttrib3fv(z.location,ae);break;case 4:n.vertexAttrib4fv(z.location,ae);break;default:n.vertexAttrib1fv(z.location,ae)}}}}S()}(L,V,J,ie),null!==j&&n.bindBuffer(34963,t.get(j).buffer))},reset:X,resetDefaultState:O,dispose:function D(){X();for(const L in a){const V=a[L];for(const J in V){const ie=V[J];for(const j in ie)m(ie[j].object),delete ie[j];delete V[J]}delete a[L]}},releaseStatesOfGeometry:function R(L){if(void 0===a[L.id])return;const V=a[L.id];for(const J in V){const ie=V[J];for(const j in ie)m(ie[j].object),delete ie[j];delete V[J]}delete a[L.id]},releaseStatesOfProgram:function U(L){for(const V in a){const J=a[V];if(void 0===J[L.id])continue;const ie=J[L.id];for(const j in ie)m(ie[j].object),delete ie[j];delete J[L.id]}},initAttributes:y,enableAttribute:x,disableUnusedAttributes:S}}function n5(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function i5(n,e,t){let i;function s(I){if("highp"===I){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";I="mediump"}return"mediump"===I&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),m=n.getParameter(34076),p=n.getParameter(34921),g=n.getParameter(36347),v=n.getParameter(36348),_=n.getParameter(36349),y=h>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:m,maxAttributes:p,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:_,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:y&&x,maxSamples:o?n.getParameter(36183):0}}function r5(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new lo,a=new Ln,l={value:null,needsUpdate:!1};function u(d,h,f,m){const p=null!==d?d.length:0;let g=null;if(0!==p){if(g=l.value,!0!==m||null===g){const v=f+4*p,_=h.matrixWorldInverse;a.getNormalMatrix(_),(null===g||g.length<v)&&(g=new Float32Array(v));for(let y=0,x=f;y!==p;++y,x+=4)o.copy(d[y]).applyMatrix4(_,a),o.normal.toArray(g,x),g[x+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const m=d.clippingPlanes,p=d.clipIntersection,g=d.clipShadows,v=n.get(d);if(!r||null===m||0===m.length||s&&!g)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const _=s?0:i,y=4*_;let x=v.clippingState||null;l.value=x,x=u(m,h,y,f);for(let b=0;b!==y;++b)x[b]=t[b];v.clippingState=x,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=_}}}function s5(n){let e=new WeakMap;function t(o,a){return a===Xd?o.mapping=Xs:a===Yd&&(o.mapping=Ys),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===Xd||a===Yd){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new KV(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Py extends Ay{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const oC=[.125,.215,.35,.446,.526,.582],Ly=new Py,aC=new _e;let Ny=null;const uo=(1+Math.sqrt(5))/2,ja=1/uo,lC=[new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,uo,ja),new E(0,uo,-ja),new E(ja,0,uo),new E(-ja,0,uo),new E(uo,ja,0),new E(-uo,ja,0)];class cC{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Ny=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=hC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=dC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Ny),e.scissorTest=!1,Mh(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Xs||e.mapping===Ys?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Ny=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:tn,minFilter:tn,generateMipmaps:!1,type:_c,format:Ni,encoding:eo,depthBuffer:!1},r=uC(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=uC(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function o5(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+oC.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=oC[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,m=6,p=3,g=2,v=1,_=new Float32Array(p*m*f),y=new Float32Array(g*m*f),x=new Float32Array(v*m*f);for(let S=0;S<f;S++){const I=S%3*2/3-1,w=S>2?0:-1;_.set([I,w,0,I+2/3,w,0,I+2/3,w+1,0,I,w,0,I+2/3,w+1,0,I,w+1,0],p*m*S),y.set(h,g*m*S),x.set([S,S,S,S,S,S],v*m*S)}const b=new rt;b.setAttribute("position",new mn(_,p)),b.setAttribute("uv",new mn(y,g)),b.setAttribute("faceIndex",new mn(x,v)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function a5(n,e,t){const i=new Float32Array(20),r=new E(0,1,0);return new bs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ps,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new ft(this._lodPlanes[0],e);this._renderer.compile(t,Ly)}_sceneToCubeUV(e,t,i,r){const a=new Sn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(aC),u.toneMapping=zr,u.autoClear=!1;const f=new Tt({name:"PMREM.Background",side:yi,depthWrite:!1,depthTest:!1}),m=new ft(new Xn,f);let p=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,p=!0):(f.color.copy(aC),p=!0);for(let v=0;v<6;v++){const _=v%3;0===_?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):1===_?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const y=this._cubeSize;Mh(r,_*y,v>2?y:0,y,y),u.setRenderTarget(r),p&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Xs||e.mapping===Ys;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=hC()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=dC());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new ft(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Mh(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Ly)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,lC[(r-1)%lC.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new ft(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,p=s/m,g=isFinite(s)?1+Math.floor(3*p):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const v=[];let _=0;for(let I=0;I<20;++I){const w=I/p,D=Math.exp(-w*w/2);v.push(D),0===I?_+=D:I<g&&(_+=2*D)}for(let I=0;I<v.length;I++)v[I]=v[I]/_;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=v,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:y}=this;h.dTheta.value=m,h.mipInt.value=y-i;const x=this._sizeLods[r];Mh(t,3*x*(r>y-4?r-y+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(d,Ly)}}function uC(n,e,t){const i=new ro(n,e,t);return i.texture.mapping=vc,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Mh(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function dC(){return new bs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:ps,depthTest:!1,depthWrite:!1})}function hC(){return new bs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ps,depthTest:!1,depthWrite:!1})}function l5(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===Xd||l===Yd,u=l===Xs||l===Ys;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new cC(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new cC(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function c5(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function u5(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,m=d.attributes.position;let p=0;if(null!==f){const _=f.array;p=f.version;for(let y=0,x=_.length;y<x;y+=3){const b=_[y+0],S=_[y+1],I=_[y+2];h.push(b,S,S,I,I,b)}}else{p=m.version;for(let y=0,x=m.array.length/3-1;y<x;y+=3){const b=y+0,S=y+1,I=y+2;h.push(b,S,S,I,I,b)}}const g=new(VE(h)?tC:eC)(h,1);g.version=p;const v=s.get(d);v&&e.remove(v),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const m in h)e.update(h[m],34962);const f=d.morphAttributes;for(const m in f){const p=f[m];for(let g=0,v=p.length;g<v;g++)e.update(p[g],34962)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function d5(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,m){if(0===m)return;let p,g;if(r)p=n,g="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[g](s,f,a,h*l,m),t.update(f,s,m)}}function h5(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function f5(n,e){return n[0]-e[0]}function p5(n,e){return Math.abs(e[1])-Math.abs(n[1])}function m5(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new St,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==f?f.length:0;let p=s.get(u);if(void 0===p||p.count!==m){let L=function(){X.dispose(),s.delete(u),u.removeEventListener("dispose",L)};void 0!==p&&p.texture.dispose();const _=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,x=void 0!==u.morphAttributes.color,b=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],I=u.morphAttributes.color||[];let w=0;!0===_&&(w=1),!0===y&&(w=2),!0===x&&(w=3);let D=u.attributes.position.count*w,R=1;D>e.maxTextureSize&&(R=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);const U=new Float32Array(D*R*4*m),X=new fy(U,D,R,m);X.type=ms,X.needsUpdate=!0;const O=4*w;for(let V=0;V<m;V++){const J=b[V],ie=S[V],j=I[V],K=D*R*4*V;for(let te=0;te<J.count;te++){const ye=te*O;!0===_&&(o.fromBufferAttribute(J,te),U[K+ye+0]=o.x,U[K+ye+1]=o.y,U[K+ye+2]=o.z,U[K+ye+3]=0),!0===y&&(o.fromBufferAttribute(ie,te),U[K+ye+4]=o.x,U[K+ye+5]=o.y,U[K+ye+6]=o.z,U[K+ye+7]=0),!0===x&&(o.fromBufferAttribute(j,te),U[K+ye+8]=o.x,U[K+ye+9]=o.y,U[K+ye+10]=o.z,U[K+ye+11]=4===j.itemSize?o.w:1)}}p={count:m,texture:X,size:new q(D,R)},s.set(u,p),u.addEventListener("dispose",L)}let g=0;for(let _=0;_<h.length;_++)g+=h[_];const v=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",v),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",p.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",p.size)}else{const f=void 0===h?0:h.length;let m=i[u.id];if(void 0===m||m.length!==f){m=[];for(let y=0;y<f;y++)m[y]=[y,0];i[u.id]=m}for(let y=0;y<f;y++){const x=m[y];x[0]=y,x[1]=h[y]}m.sort(p5);for(let y=0;y<8;y++)y<f&&m[y][1]?(a[y][0]=m[y][0],a[y][1]=m[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(f5);const p=u.morphAttributes.position,g=u.morphAttributes.normal;let v=0;for(let y=0;y<8;y++){const x=a[y],b=x[0],S=x[1];b!==Number.MAX_SAFE_INTEGER&&S?(p&&u.getAttribute("morphTarget"+y)!==p[b]&&u.setAttribute("morphTarget"+y,p[b]),g&&u.getAttribute("morphNormal"+y)!==g[b]&&u.setAttribute("morphNormal"+y,g[b]),r[y]=S,v+=S):(p&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),g&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const _=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(n,"morphTargetBaseInfluence",_),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function g5(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const fC=new ys,pC=new fy,mC=new WE,gC=new _h,yC=[],vC=[],_C=new Float32Array(16),xC=new Float32Array(9),wC=new Float32Array(4);function qa(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=yC[r];if(void 0===s&&(s=new Float32Array(r),yC[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function dn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function hn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Sh(n,e){let t=vC[e];void 0===t&&(t=new Int32Array(e),vC[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function y5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function v5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(dn(t,e))return;n.uniform2fv(this.addr,e),hn(t,e)}}function _5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(dn(t,e))return;n.uniform3fv(this.addr,e),hn(t,e)}}function x5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(dn(t,e))return;n.uniform4fv(this.addr,e),hn(t,e)}}function w5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(dn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),hn(t,e)}else{if(dn(t,i))return;wC.set(i),n.uniformMatrix2fv(this.addr,!1,wC),hn(t,i)}}function b5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(dn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),hn(t,e)}else{if(dn(t,i))return;xC.set(i),n.uniformMatrix3fv(this.addr,!1,xC),hn(t,i)}}function M5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(dn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),hn(t,e)}else{if(dn(t,i))return;_C.set(i),n.uniformMatrix4fv(this.addr,!1,_C),hn(t,i)}}function S5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function D5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(dn(t,e))return;n.uniform2iv(this.addr,e),hn(t,e)}}function E5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(dn(t,e))return;n.uniform3iv(this.addr,e),hn(t,e)}}function C5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(dn(t,e))return;n.uniform4iv(this.addr,e),hn(t,e)}}function T5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function A5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(dn(t,e))return;n.uniform2uiv(this.addr,e),hn(t,e)}}function I5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(dn(t,e))return;n.uniform3uiv(this.addr,e),hn(t,e)}}function R5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(dn(t,e))return;n.uniform4uiv(this.addr,e),hn(t,e)}}function P5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||fC,r)}function L5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||mC,r)}function N5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||gC,r)}function F5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||pC,r)}function k5(n,e){n.uniform1fv(this.addr,e)}function B5(n,e){const t=qa(e,this.size,2);n.uniform2fv(this.addr,t)}function U5(n,e){const t=qa(e,this.size,3);n.uniform3fv(this.addr,t)}function z5(n,e){const t=qa(e,this.size,4);n.uniform4fv(this.addr,t)}function V5(n,e){const t=qa(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function H5(n,e){const t=qa(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function G5(n,e){const t=qa(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function W5(n,e){n.uniform1iv(this.addr,e)}function $5(n,e){n.uniform2iv(this.addr,e)}function j5(n,e){n.uniform3iv(this.addr,e)}function q5(n,e){n.uniform4iv(this.addr,e)}function X5(n,e){n.uniform1uiv(this.addr,e)}function Y5(n,e){n.uniform2uiv(this.addr,e)}function Z5(n,e){n.uniform3uiv(this.addr,e)}function J5(n,e){n.uniform4uiv(this.addr,e)}function K5(n,e,t){const i=this.cache,r=e.length,s=Sh(t,r);dn(i,s)||(n.uniform1iv(this.addr,s),hn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||fC,s[o])}function Q5(n,e,t){const i=this.cache,r=e.length,s=Sh(t,r);dn(i,s)||(n.uniform1iv(this.addr,s),hn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||mC,s[o])}function eG(n,e,t){const i=this.cache,r=e.length,s=Sh(t,r);dn(i,s)||(n.uniform1iv(this.addr,s),hn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||gC,s[o])}function tG(n,e,t){const i=this.cache,r=e.length,s=Sh(t,r);dn(i,s)||(n.uniform1iv(this.addr,s),hn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||pC,s[o])}class iG{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function O5(n){switch(n){case 5126:return y5;case 35664:return v5;case 35665:return _5;case 35666:return x5;case 35674:return w5;case 35675:return b5;case 35676:return M5;case 5124:case 35670:return S5;case 35667:case 35671:return D5;case 35668:case 35672:return E5;case 35669:case 35673:return C5;case 5125:return T5;case 36294:return A5;case 36295:return I5;case 36296:return R5;case 35678:case 36198:case 36298:case 36306:case 35682:return P5;case 35679:case 36299:case 36307:return L5;case 35680:case 36300:case 36308:case 36293:return N5;case 36289:case 36303:case 36311:case 36292:return F5}}(t.type)}}class rG{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function nG(n){switch(n){case 5126:return k5;case 35664:return B5;case 35665:return U5;case 35666:return z5;case 35674:return V5;case 35675:return H5;case 35676:return G5;case 5124:case 35670:return W5;case 35667:case 35671:return $5;case 35668:case 35672:return j5;case 35669:case 35673:return q5;case 5125:return X5;case 36294:return Y5;case 36295:return Z5;case 36296:return J5;case 35678:case 36198:case 36298:case 36306:case 35682:return K5;case 35679:case 36299:case 36307:return Q5;case 35680:case 36300:case 36308:case 36293:return eG;case 36289:case 36303:case 36311:case 36292:return tG}}(t.type)}}class sG{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const Oy=/(\w+)(\])?(\[|\.)?/g;function bC(n,e){n.seq.push(e),n.map[e.id]=e}function oG(n,e,t){const i=n.name,r=i.length;for(Oy.lastIndex=0;;){const s=Oy.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&Oy.lastIndex+2===r){bC(t,void 0===c?new iG(a,n,e):new rG(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new sG(a),bC(t,d)),t=d}}}class Dh{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);oG(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function MC(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let aG=0;function SC(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function lG(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function uG(n,e){const t=function cG(n){switch(n){case eo:return["Linear","( value )"];case Nt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function dG(n,e){let t;switch(e){case Hz:t="Linear";break;case Gz:t="Reinhard";break;case Wz:t="OptimizedCineon";break;case $z:t="ACESFilmic";break;case jz:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Pc(n){return""!==n}function DC(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function EC(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const mG=/^[ \t]*#include +<([\w\d./]+)>/gm;function ky(n){return n.replace(mG,gG)}function gG(n,e){const t=et[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return ky(t)}const yG=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function CC(n){return n.replace(yG,vG)}function vG(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function TC(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function SG(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function _G(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===nE?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===xz?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===yc&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function xG(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Xs:case Ys:e="ENVMAP_TYPE_CUBE";break;case vc:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function wG(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Ys&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function bG(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case qd:e="ENVMAP_BLENDING_MULTIPLY";break;case zz:e="ENVMAP_BLENDING_MIX";break;case Vz:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function MG(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function hG(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Pc).join("\n")}(t),m=function fG(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),p=r.createProgram();let g,v,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[m].filter(Pc).join("\n"),g.length>0&&(g+="\n"),v=[f,m].filter(Pc).join("\n"),v.length>0&&(v+="\n")):(g=[TC(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Pc).join("\n"),v=[f,TC(t),"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==zr?"#define TONE_MAPPING":"",t.toneMapping!==zr?et.tonemapping_pars_fragment:"",t.toneMapping!==zr?dG("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",et.encodings_pars_fragment,uG("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Pc).join("\n")),o=ky(o),o=DC(o,t),o=EC(o,t),a=ky(a),a=DC(a,t),a=EC(a,t),o=CC(o),a=CC(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",t.glslVersion===kE?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===kE?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const x=_+v+a,b=MC(r,35633,_+g+o),S=MC(r,35632,x);if(r.attachShader(p,b),r.attachShader(p,S),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),n.debug.checkShaderErrors){const D=r.getProgramInfoLog(p).trim(),R=r.getShaderInfoLog(b).trim(),U=r.getShaderInfoLog(S).trim();let X=!0,O=!0;if(!1===r.getProgramParameter(p,35714)){X=!1;const L=SC(r,b,"vertex"),V=SC(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+D+"\n"+L+"\n"+V)}else""!==D?console.warn("THREE.WebGLProgram: Program Info Log:",D):(""===R||""===U)&&(O=!1);O&&(this.diagnostics={runnable:X,programLog:D,vertexShader:{log:R,prefix:g},fragmentShader:{log:U,prefix:v}})}let I,w;return r.deleteShader(b),r.deleteShader(S),this.getUniforms=function(){return void 0===I&&(I=new Dh(r,p)),I},this.getAttributes=function(){return void 0===w&&(w=function pG(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,p)),w},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=aG++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=b,this.fragmentShader=S,this}let DG=0;class EG{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new CG(e),t.set(e,i)),i}}class CG{constructor(e){this.id=DG++,this.code=e,this.usedTimes=0}}function TG(n,e,t,i,r,s,o){const a=new xy,l=new EG,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function p(w,D,R,U,X){const O=U.fog,L=X.geometry,J=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?U.environment:null)),ie=J&&J.mapping===vc?J.image.height:null,j=m[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const K=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,te=void 0!==K?K.length:0;let z,ee,ae,k,ye=0;if(void 0!==L.morphAttributes.position&&(ye=1),void 0!==L.morphAttributes.normal&&(ye=2),void 0!==L.morphAttributes.color&&(ye=3),j){const Be=vr[j];z=Be.vertexShader,ee=Be.fragmentShader}else z=w.vertexShader,ee=w.fragmentShader,l.update(w),ae=l.getVertexShaderID(w),k=l.getFragmentShaderID(w);const xe=n.getRenderTarget(),ve=w.clearcoat>0,be=w.iridescence>0;return{isWebGL2:u,shaderID:j,shaderName:w.type,vertexShader:z,fragmentShader:ee,defines:w.defines,customVertexShaderID:ae,customFragmentShaderID:k,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:!0===X.isInstancedMesh,instancingColor:!0===X.isInstancedMesh&&null!==X.instanceColor,supportsVertexTextures:h,outputEncoding:null===xe?n.outputEncoding:!0===xe.isXRRenderTarget?xe.texture.encoding:eo,map:!!w.map,matcap:!!w.matcap,envMap:!!J,envMapMode:J&&J.mapping,envMapCubeUVHeight:ie,lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:w.normalMapType===fV,tangentSpaceNormalMap:w.normalMapType===to,decodeVideoTexture:!!w.map&&!0===w.map.isVideoTexture&&w.map.encoding===Nt,clearcoat:ve,clearcoatMap:ve&&!!w.clearcoatMap,clearcoatRoughnessMap:ve&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:ve&&!!w.clearcoatNormalMap,iridescence:be,iridescenceMap:be&&!!w.iridescenceMap,iridescenceThicknessMap:be&&!!w.iridescenceThicknessMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,opaque:!1===w.transparent&&w.blending===wa,alphaMap:!!w.alphaMap,alphaTest:w.alphaTest>0,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!L.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!L.attributes.color&&4===L.attributes.color.itemSize,vertexUvs:!!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatMap||w.clearcoatRoughnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.displacementMap||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheenColorMap||w.sheenRoughnessMap),uvsVertexOnly:!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.transmission>0||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheen>0||w.sheenColorMap||w.sheenRoughnessMap||!w.displacementMap),fog:!!O,useFog:!0===w.fog,fogExp2:O&&O.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===X.isSkinnedMesh,morphTargets:void 0!==L.morphAttributes.position,morphNormals:void 0!==L.morphAttributes.normal,morphColors:void 0!==L.morphAttributes.color,morphTargetsCount:te,morphTextureStride:ye,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numSpotLightMaps:D.spotLightMap.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numSpotLightShadowsWithMaps:D.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:w.toneMapped?n.toneMapping:zr,useLegacyLights:n.useLegacyLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===fs,flipSided:w.side===yi,useDepthPacking:!!w.depthPacking,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function g(w){const D=[];if(w.shaderID?D.push(w.shaderID):(D.push(w.customVertexShaderID),D.push(w.customFragmentShaderID)),void 0!==w.defines)for(const R in w.defines)D.push(R),D.push(w.defines[R]);return!1===w.isRawShaderMaterial&&(function v(w,D){w.push(D.precision),w.push(D.outputEncoding),w.push(D.envMapMode),w.push(D.envMapCubeUVHeight),w.push(D.combine),w.push(D.vertexUvs),w.push(D.fogExp2),w.push(D.sizeAttenuation),w.push(D.morphTargetsCount),w.push(D.morphAttributeCount),w.push(D.numDirLights),w.push(D.numPointLights),w.push(D.numSpotLights),w.push(D.numSpotLightMaps),w.push(D.numHemiLights),w.push(D.numRectAreaLights),w.push(D.numDirLightShadows),w.push(D.numPointLightShadows),w.push(D.numSpotLightShadows),w.push(D.numSpotLightShadowsWithMaps),w.push(D.shadowMapType),w.push(D.toneMapping),w.push(D.numClippingPlanes),w.push(D.numClipIntersection),w.push(D.depthPacking)}(D,w),function _(w,D){a.disableAll(),D.isWebGL2&&a.enable(0),D.supportsVertexTextures&&a.enable(1),D.instancing&&a.enable(2),D.instancingColor&&a.enable(3),D.map&&a.enable(4),D.matcap&&a.enable(5),D.envMap&&a.enable(6),D.lightMap&&a.enable(7),D.aoMap&&a.enable(8),D.emissiveMap&&a.enable(9),D.bumpMap&&a.enable(10),D.normalMap&&a.enable(11),D.objectSpaceNormalMap&&a.enable(12),D.tangentSpaceNormalMap&&a.enable(13),D.clearcoat&&a.enable(14),D.clearcoatMap&&a.enable(15),D.clearcoatRoughnessMap&&a.enable(16),D.clearcoatNormalMap&&a.enable(17),D.iridescence&&a.enable(18),D.iridescenceMap&&a.enable(19),D.iridescenceThicknessMap&&a.enable(20),D.displacementMap&&a.enable(21),D.specularMap&&a.enable(22),D.roughnessMap&&a.enable(23),D.metalnessMap&&a.enable(24),D.gradientMap&&a.enable(25),D.alphaMap&&a.enable(26),D.alphaTest&&a.enable(27),D.vertexColors&&a.enable(28),D.vertexAlphas&&a.enable(29),D.vertexUvs&&a.enable(30),D.vertexTangents&&a.enable(31),D.uvsVertexOnly&&a.enable(32),w.push(a.mask),a.disableAll(),D.fog&&a.enable(0),D.useFog&&a.enable(1),D.flatShading&&a.enable(2),D.logarithmicDepthBuffer&&a.enable(3),D.skinning&&a.enable(4),D.morphTargets&&a.enable(5),D.morphNormals&&a.enable(6),D.morphColors&&a.enable(7),D.premultipliedAlpha&&a.enable(8),D.shadowMapEnabled&&a.enable(9),D.useLegacyLights&&a.enable(10),D.doubleSided&&a.enable(11),D.flipSided&&a.enable(12),D.useDepthPacking&&a.enable(13),D.dithering&&a.enable(14),D.specularIntensityMap&&a.enable(15),D.specularColorMap&&a.enable(16),D.transmission&&a.enable(17),D.transmissionMap&&a.enable(18),D.thicknessMap&&a.enable(19),D.sheen&&a.enable(20),D.sheenColorMap&&a.enable(21),D.sheenRoughnessMap&&a.enable(22),D.decodeVideoTexture&&a.enable(23),D.opaque&&a.enable(24),w.push(a.mask)}(D,w),D.push(n.outputEncoding)),D.push(w.customProgramCacheKey),D.join()},getUniforms:function y(w){const D=m[w.type];let R;return R=D?XV.clone(vr[D].uniforms):w.uniforms,R},acquireProgram:function x(w,D){let R;for(let U=0,X=c.length;U<X;U++){const O=c[U];if(O.cacheKey===D){R=O,++R.usedTimes;break}}return void 0===R&&(R=new SG(n,D,w,s),c.push(R)),R},releaseProgram:function b(w){if(0==--w.usedTimes){const D=c.indexOf(w);c[D]=c[c.length-1],c.pop(),w.destroy()}},releaseShaderCache:function S(w){l.remove(w)},programs:c,dispose:function I(){l.dispose()}}}function AG(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function IG(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function AC(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function IC(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,m,p,g){let v=n[e];return void 0===v?(v={id:d.id,object:d,geometry:h,material:f,groupOrder:m,renderOrder:d.renderOrder,z:p,group:g},n[e]=v):(v.id=d.id,v.object=d,v.geometry=h,v.material=f,v.groupOrder=m,v.renderOrder=d.renderOrder,v.z=p,v.group=g),e++,v}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,m,p,g){const v=o(d,h,f,m,p,g);f.transmission>0?i.push(v):!0===f.transparent?r.push(v):t.push(v)},unshift:function l(d,h,f,m,p,g){const v=o(d,h,f,m,p,g);f.transmission>0?i.unshift(v):!0===f.transparent?r.unshift(v):t.unshift(v)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||IG),i.length>1&&i.sort(h||AC),r.length>1&&r.sort(h||AC)}}}function RG(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new IC,n.set(i,[o])):r>=s.length?(o=new IC,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function PG(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new E,color:new _e};break;case"SpotLight":t={position:new E,direction:new E,color:new _e,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new E,color:new _e,distance:0,decay:0};break;case"HemisphereLight":t={direction:new E,skyColor:new _e,groundColor:new _e};break;case"RectAreaLight":t={color:new _e,position:new E,halfWidth:new E,halfHeight:new E}}return n[e.id]=t,t}}}let NG=0;function FG(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function OG(n,e){const t=new PG,i=function LG(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new q};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new q,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new E);const s=new E,o=new Ke,a=new Ke;return{setup:function l(u,d){let h=0,f=0,m=0;for(let U=0;U<9;U++)r.probe[U].set(0,0,0);let p=0,g=0,v=0,_=0,y=0,x=0,b=0,S=0,I=0,w=0;u.sort(FG);const D=!0===d?Math.PI:1;for(let U=0,X=u.length;U<X;U++){const O=u[U],L=O.color,V=O.intensity,J=O.distance,ie=O.shadow&&O.shadow.map?O.shadow.map.texture:null;if(O.isAmbientLight)h+=L.r*V*D,f+=L.g*V*D,m+=L.b*V*D;else if(O.isLightProbe)for(let j=0;j<9;j++)r.probe[j].addScaledVector(O.sh.coefficients[j],V);else if(O.isDirectionalLight){const j=t.get(O);if(j.color.copy(O.color).multiplyScalar(O.intensity*D),O.castShadow){const K=O.shadow,te=i.get(O);te.shadowBias=K.bias,te.shadowNormalBias=K.normalBias,te.shadowRadius=K.radius,te.shadowMapSize=K.mapSize,r.directionalShadow[p]=te,r.directionalShadowMap[p]=ie,r.directionalShadowMatrix[p]=O.shadow.matrix,x++}r.directional[p]=j,p++}else if(O.isSpotLight){const j=t.get(O);j.position.setFromMatrixPosition(O.matrixWorld),j.color.copy(L).multiplyScalar(V*D),j.distance=J,j.coneCos=Math.cos(O.angle),j.penumbraCos=Math.cos(O.angle*(1-O.penumbra)),j.decay=O.decay,r.spot[v]=j;const K=O.shadow;if(O.map&&(r.spotLightMap[I]=O.map,I++,K.updateMatrices(O),O.castShadow&&w++),r.spotLightMatrix[v]=K.matrix,O.castShadow){const te=i.get(O);te.shadowBias=K.bias,te.shadowNormalBias=K.normalBias,te.shadowRadius=K.radius,te.shadowMapSize=K.mapSize,r.spotShadow[v]=te,r.spotShadowMap[v]=ie,S++}v++}else if(O.isRectAreaLight){const j=t.get(O);j.color.copy(L).multiplyScalar(V),j.halfWidth.set(.5*O.width,0,0),j.halfHeight.set(0,.5*O.height,0),r.rectArea[_]=j,_++}else if(O.isPointLight){const j=t.get(O);if(j.color.copy(O.color).multiplyScalar(O.intensity*D),j.distance=O.distance,j.decay=O.decay,O.castShadow){const K=O.shadow,te=i.get(O);te.shadowBias=K.bias,te.shadowNormalBias=K.normalBias,te.shadowRadius=K.radius,te.shadowMapSize=K.mapSize,te.shadowCameraNear=K.camera.near,te.shadowCameraFar=K.camera.far,r.pointShadow[g]=te,r.pointShadowMap[g]=ie,r.pointShadowMatrix[g]=O.shadow.matrix,b++}r.point[g]=j,g++}else if(O.isHemisphereLight){const j=t.get(O);j.skyColor.copy(O.color).multiplyScalar(V*D),j.groundColor.copy(O.groundColor).multiplyScalar(V*D),r.hemi[y]=j,y++}}_>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=le.LTC_FLOAT_1,r.rectAreaLTC2=le.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=le.LTC_HALF_1,r.rectAreaLTC2=le.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=m;const R=r.hash;(R.directionalLength!==p||R.pointLength!==g||R.spotLength!==v||R.rectAreaLength!==_||R.hemiLength!==y||R.numDirectionalShadows!==x||R.numPointShadows!==b||R.numSpotShadows!==S||R.numSpotMaps!==I)&&(r.directional.length=p,r.spot.length=v,r.rectArea.length=_,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=S+I-w,r.spotLightMap.length=I,r.numSpotLightShadowsWithMaps=w,R.directionalLength=p,R.pointLength=g,R.spotLength=v,R.rectAreaLength=_,R.hemiLength=y,R.numDirectionalShadows=x,R.numPointShadows=b,R.numSpotShadows=S,R.numSpotMaps=I,r.version=NG++)},setupView:function c(u,d){let h=0,f=0,m=0,p=0,g=0;const v=d.matrixWorldInverse;for(let _=0,y=u.length;_<y;_++){const x=u[_];if(x.isDirectionalLight){const b=r.directional[h];b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),h++}else if(x.isSpotLight){const b=r.spot[m];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),m++}else if(x.isRectAreaLight){const b=r.rectArea[p];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),a.identity(),o.copy(x.matrixWorld),o.premultiply(v),a.extractRotation(o),b.halfWidth.set(.5*x.width,0,0),b.halfHeight.set(0,.5*x.height,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),p++}else if(x.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),f++}else if(x.isHemisphereLight){const b=r.hemi[g];b.direction.setFromMatrixPosition(x.matrixWorld),b.direction.transformDirection(v),g++}}},state:r}}function RC(n,e){const t=new OG(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function kG(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new RC(n,e),t.set(s,[l])):o>=a.length?(l=new RC(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class PC extends Cc{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class LC extends Cc{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const BG="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",UG="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function zG(n,e,t){let i=new Ry;const r=new q,s=new q,o=new St,a=new PC({depthPacking:hV}),l=new LC,c={},u=t.maxTextureSize,d={[hs]:yi,[yi]:hs,[fs]:fs},h=new bs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new q},radius:{value:4}},vertexShader:BG,fragmentShader:UG}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const m=new rt;m.setAttribute("position",new mn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new ft(m,h),g=this;function v(x,b){const S=e.update(p);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new ro(r.x,r.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(b,null,S,h,p,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(b,null,S,f,p,null)}function _(x,b,S,I,w,D){let R=null;const U=!0===S.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==U)R=U;else if(R=!0===S.isPointLight?l:a,n.localClippingEnabled&&!0===b.clipShadows&&Array.isArray(b.clippingPlanes)&&0!==b.clippingPlanes.length||b.displacementMap&&0!==b.displacementScale||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){const X=R.uuid,O=b.uuid;let L=c[X];void 0===L&&(L={},c[X]=L);let V=L[O];void 0===V&&(V=R.clone(),L[O]=V),R=V}return R.visible=b.visible,R.wireframe=b.wireframe,R.side=D===yc?null!==b.shadowSide?b.shadowSide:b.side:null!==b.shadowSide?b.shadowSide:d[b.side],R.alphaMap=b.alphaMap,R.alphaTest=b.alphaTest,R.map=b.map,R.clipShadows=b.clipShadows,R.clippingPlanes=b.clippingPlanes,R.clipIntersection=b.clipIntersection,R.displacementMap=b.displacementMap,R.displacementScale=b.displacementScale,R.displacementBias=b.displacementBias,R.wireframeLinewidth=b.wireframeLinewidth,R.linewidth=b.linewidth,!0===S.isPointLight&&!0===R.isMeshDistanceMaterial&&(R.referencePosition.setFromMatrixPosition(S.matrixWorld),R.nearDistance=I,R.farDistance=w),R}function y(x,b,S,I,w){if(!1===x.visible)return;if(x.layers.test(b.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&w===yc)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,x.matrixWorld);const U=e.update(x),X=x.material;if(Array.isArray(X)){const O=U.groups;for(let L=0,V=O.length;L<V;L++){const J=O[L],ie=X[J.materialIndex];if(ie&&ie.visible){const j=_(x,ie,I,S.near,S.far,w);n.renderBufferDirect(S,null,U,j,x,J)}}}else if(X.visible){const O=_(x,X,I,S.near,S.far,w);n.renderBufferDirect(S,null,U,O,x,null)}}const R=x.children;for(let U=0,X=R.length;U<X;U++)y(R[U],b,S,I,w)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=nE,this.render=function(x,b,S){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===x.length)return;const I=n.getRenderTarget(),w=n.getActiveCubeFace(),D=n.getActiveMipmapLevel(),R=n.state;R.setBlending(ps),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let U=0,X=x.length;U<X;U++){const O=x[U],L=O.shadow;if(void 0===L){console.warn("THREE.WebGLShadowMap:",O,"has no shadow.");continue}if(!1===L.autoUpdate&&!1===L.needsUpdate)continue;r.copy(L.mapSize);const V=L.getFrameExtents();r.multiply(V),s.copy(L.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/V.x),r.x=s.x*V.x,L.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/V.y),r.y=s.y*V.y,L.mapSize.y=s.y)),null===L.map&&(L.map=new ro(r.x,r.y,this.type!==yc?{minFilter:en,magFilter:en}:{}),L.map.texture.name=O.name+".shadowMap",L.camera.updateProjectionMatrix()),n.setRenderTarget(L.map),n.clear();const J=L.getViewportCount();for(let ie=0;ie<J;ie++){const j=L.getViewport(ie);o.set(s.x*j.x,s.y*j.y,s.x*j.z,s.y*j.w),R.viewport(o),L.updateMatrices(O,ie),i=L.getFrustum(),y(b,S,L.camera,O,this.type)}!0!==L.isPointLightShadow&&this.type===yc&&v(L,S),L.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(I,w,D)}}function VG(n,e,t){const i=t.isWebGL2,a=new function r(){let P=!1;const W=new St;let ne=null;const we=new St(0,0,0,0);return{setMask:function(Ee){ne!==Ee&&!P&&(n.colorMask(Ee,Ee,Ee,Ee),ne=Ee)},setLocked:function(Ee){P=Ee},setClear:function(Ee,Ot,yn,Kn,wr){!0===wr&&(Ee*=Kn,Ot*=Kn,yn*=Kn),W.set(Ee,Ot,yn,Kn),!1===we.equals(W)&&(n.clearColor(Ee,Ot,yn,Kn),we.copy(W))},reset:function(){P=!1,ne=null,we.set(-1,0,0,0)}}},l=new function s(){let P=!1,W=null,ne=null,we=null;return{setTest:function(Ee){Ee?pe(2929):ve(2929)},setMask:function(Ee){W!==Ee&&!P&&(n.depthMask(Ee),W=Ee)},setFunc:function(Ee){if(ne!==Ee){switch(Ee){case Lz:n.depthFunc(512);break;case Nz:n.depthFunc(519);break;case Fz:n.depthFunc(513);break;case Yg:n.depthFunc(515);break;case Oz:n.depthFunc(514);break;case kz:n.depthFunc(518);break;case Bz:n.depthFunc(516);break;case Uz:n.depthFunc(517);break;default:n.depthFunc(515)}ne=Ee}},setLocked:function(Ee){P=Ee},setClear:function(Ee){we!==Ee&&(n.clearDepth(Ee),we=Ee)},reset:function(){P=!1,W=null,ne=null,we=null}}},c=new function o(){let P=!1,W=null,ne=null,we=null,Ee=null,Ot=null,yn=null,Kn=null,wr=null;return{setTest:function(Zt){P||(Zt?pe(2960):ve(2960))},setMask:function(Zt){W!==Zt&&!P&&(n.stencilMask(Zt),W=Zt)},setFunc:function(Zt,ki,br){(ne!==Zt||we!==ki||Ee!==br)&&(n.stencilFunc(Zt,ki,br),ne=Zt,we=ki,Ee=br)},setOp:function(Zt,ki,br){(Ot!==Zt||yn!==ki||Kn!==br)&&(n.stencilOp(Zt,ki,br),Ot=Zt,yn=ki,Kn=br)},setLocked:function(Zt){P=Zt},setClear:function(Zt){wr!==Zt&&(n.clearStencil(Zt),wr=Zt)},reset:function(){P=!1,W=null,ne=null,we=null,Ee=null,Ot=null,yn=null,Kn=null,wr=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},m=new WeakMap,p=[],g=null,v=!1,_=null,y=null,x=null,b=null,S=null,I=null,w=null,D=!1,R=null,U=null,X=null,O=null,L=null;const V=n.getParameter(35661);let J=!1,ie=0;const j=n.getParameter(7938);-1!==j.indexOf("WebGL")?(ie=parseFloat(/^WebGL (\d)/.exec(j)[1]),J=ie>=1):-1!==j.indexOf("OpenGL ES")&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),J=ie>=2);let K=null,te={};const ye=n.getParameter(3088),z=n.getParameter(2978),ee=(new St).fromArray(ye),ae=(new St).fromArray(z);function k(P,W,ne){const we=new Uint8Array(4),Ee=n.createTexture();n.bindTexture(P,Ee),n.texParameteri(P,10241,9728),n.texParameteri(P,10240,9728);for(let Ot=0;Ot<ne;Ot++)n.texImage2D(W+Ot,0,6408,1,1,0,6408,5121,we);return Ee}const xe={};function pe(P){!0!==h[P]&&(n.enable(P),h[P]=!0)}function ve(P){!1!==h[P]&&(n.disable(P),h[P]=!1)}xe[3553]=k(3553,3553,1),xe[34067]=k(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),pe(2929),l.setFunc(Yg),ue(!1),He(tE),pe(2884),oe(ps);const Y={[ba]:32774,[bz]:32778,[Mz]:32779};if(i)Y[oE]=32775,Y[aE]=32776;else{const P=e.get("EXT_blend_minmax");null!==P&&(Y[oE]=P.MIN_EXT,Y[aE]=P.MAX_EXT)}const Q={[Sz]:0,[Dz]:1,[Ez]:768,[lE]:770,[Pz]:776,[Iz]:774,[Tz]:772,[Cz]:769,[cE]:771,[Rz]:775,[Az]:773};function oe(P,W,ne,we,Ee,Ot,yn,Kn){if(P!==ps){if(!1===v&&(pe(3042),v=!0),P===wz)Ee=Ee||W,Ot=Ot||ne,yn=yn||we,(W!==y||Ee!==S)&&(n.blendEquationSeparate(Y[W],Y[Ee]),y=W,S=Ee),(ne!==x||we!==b||Ot!==I||yn!==w)&&(n.blendFuncSeparate(Q[ne],Q[we],Q[Ot],Q[yn]),x=ne,b=we,I=Ot,w=yn),_=P,D=!1;else if(P!==_||Kn!==D){if((y!==ba||S!==ba)&&(n.blendEquation(32774),y=ba,S=ba),Kn)switch(P){case wa:n.blendFuncSeparate(1,771,1,771);break;case iE:n.blendFunc(1,1);break;case rE:n.blendFuncSeparate(0,769,0,1);break;case sE:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",P)}else switch(P){case wa:n.blendFuncSeparate(770,771,1,771);break;case iE:n.blendFunc(770,1);break;case rE:n.blendFuncSeparate(0,769,0,1);break;case sE:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",P)}x=null,b=null,I=null,w=null,_=P,D=Kn}}else!0===v&&(ve(3042),v=!1)}function ue(P){R!==P&&(n.frontFace(P?2304:2305),R=P)}function He(P){P!==vz?(pe(2884),P!==U&&n.cullFace(P===tE?1029:P===_z?1028:1032)):ve(2884),U=P}function We(P,W,ne){P?(pe(32823),(O!==W||L!==ne)&&(n.polygonOffset(W,ne),O=W,L=ne)):ve(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:pe,disable:ve,bindFramebuffer:function be(P,W){return f[P]!==W&&(n.bindFramebuffer(P,W),f[P]=W,i&&(36009===P&&(f[36160]=W),36160===P&&(f[36009]=W)),!0)},drawBuffers:function Se(P,W){let ne=p,we=!1;if(P)if(ne=m.get(W),void 0===ne&&(ne=[],m.set(W,ne)),P.isWebGLMultipleRenderTargets){const Ee=P.texture;if(ne.length!==Ee.length||36064!==ne[0]){for(let Ot=0,yn=Ee.length;Ot<yn;Ot++)ne[Ot]=36064+Ot;ne.length=Ee.length,we=!0}}else 36064!==ne[0]&&(ne[0]=36064,we=!0);else 1029!==ne[0]&&(ne[0]=1029,we=!0);we&&(t.isWebGL2?n.drawBuffers(ne):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ne))},useProgram:function Be(P){return g!==P&&(n.useProgram(P),g=P,!0)},setBlending:oe,setMaterial:function De(P,W){P.side===fs?ve(2884):pe(2884);let ne=P.side===yi;W&&(ne=!ne),ue(ne),P.blending===wa&&!1===P.transparent?oe(ps):oe(P.blending,P.blendEquation,P.blendSrc,P.blendDst,P.blendEquationAlpha,P.blendSrcAlpha,P.blendDstAlpha,P.premultipliedAlpha),l.setFunc(P.depthFunc),l.setTest(P.depthTest),l.setMask(P.depthWrite),a.setMask(P.colorWrite);const we=P.stencilWrite;c.setTest(we),we&&(c.setMask(P.stencilWriteMask),c.setFunc(P.stencilFunc,P.stencilRef,P.stencilFuncMask),c.setOp(P.stencilFail,P.stencilZFail,P.stencilZPass)),We(P.polygonOffset,P.polygonOffsetFactor,P.polygonOffsetUnits),!0===P.alphaToCoverage?pe(32926):ve(32926)},setFlipSided:ue,setCullFace:He,setLineWidth:function Re(P){P!==X&&(J&&n.lineWidth(P),X=P)},setPolygonOffset:We,setScissorTest:function Mt(P){P?pe(3089):ve(3089)},activeTexture:function pt(P){void 0===P&&(P=33984+V-1),K!==P&&(n.activeTexture(P),K=P)},bindTexture:function T(P,W,ne){void 0===ne&&(ne=null===K?33984+V-1:K);let we=te[ne];void 0===we&&(we={type:void 0,texture:void 0},te[ne]=we),(we.type!==P||we.texture!==W)&&(K!==ne&&(n.activeTexture(ne),K=ne),n.bindTexture(P,W||xe[P]),we.type=P,we.texture=W)},unbindTexture:function M(){const P=te[K];void 0!==P&&void 0!==P.type&&(n.bindTexture(P.type,null),P.type=void 0,P.texture=void 0)},compressedTexImage2D:function H(){try{n.compressedTexImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexImage3D:function re(){try{n.compressedTexImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texImage2D:function de(){try{n.texImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texImage3D:function Ce(){try{n.texImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},updateUBOMapping:function at(P,W){let ne=d.get(W);void 0===ne&&(ne=new WeakMap,d.set(W,ne));let we=ne.get(P);void 0===we&&(we=n.getUniformBlockIndex(W,P.name),ne.set(P,we))},uniformBlockBinding:function mt(P,W){const we=d.get(W).get(P);u.get(W)!==we&&(n.uniformBlockBinding(W,we,P.__bindingPointIndex),u.set(W,we))},texStorage2D:function N(){try{n.texStorage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texStorage3D:function me(){try{n.texStorage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texSubImage2D:function se(){try{n.texSubImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texSubImage3D:function he(){try{n.texSubImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexSubImage2D:function Te(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexSubImage3D:function A(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},scissor:function Ie(P){!1===ee.equals(P)&&(n.scissor(P.x,P.y,P.z,P.w),ee.copy(P))},viewport:function Ae(P){!1===ae.equals(P)&&(n.viewport(P.x,P.y,P.z,P.w),ae.copy(P))},reset:function Dt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},K=null,te={},f={},m=new WeakMap,p=[],g=null,v=!1,_=null,y=null,x=null,b=null,S=null,I=null,w=null,D=!1,R=null,U=null,X=null,O=null,L=null,ee.set(0,0,n.canvas.width,n.canvas.height),ae.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function HG(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let p;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(T,M){return v?new OffscreenCanvas(T,M):Mc("canvas")}function y(T,M,H,re){let se=1;if((T.width>re||T.height>re)&&(se=re/Math.max(T.width,T.height)),se<1||!0===M){if(typeof HTMLImageElement<"u"&&T instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&T instanceof ImageBitmap){const he=M?zE:Math.floor,Te=he(se*T.width),A=he(se*T.height);void 0===p&&(p=_(Te,A));const N=H?_(Te,A):p;return N.width=Te,N.height=A,N.getContext("2d").drawImage(T,0,0,Te,A),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+T.width+"x"+T.height+") to ("+Te+"x"+A+")."),N}return"data"in T&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+T.width+"x"+T.height+")."),T}return T}function x(T){return ly(T.width)&&ly(T.height)}function S(T,M){return T.generateMipmaps&&M&&T.minFilter!==en&&T.minFilter!==tn}function I(T){n.generateMipmap(T)}function w(T,M,H,re,se=!1){if(!1===a)return M;if(null!==T){if(void 0!==n[T])return n[T];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+T+"'")}let he=M;return 6403===M&&(5126===H&&(he=33326),5131===H&&(he=33325),5121===H&&(he=33321)),33319===M&&(5126===H&&(he=33328),5131===H&&(he=33327),5121===H&&(he=33323)),6408===M&&(5126===H&&(he=34836),5131===H&&(he=34842),5121===H&&(he=re===Nt&&!1===se?35907:32856),32819===H&&(he=32854),32820===H&&(he=32855)),(33325===he||33326===he||33327===he||33328===he||34842===he||34836===he)&&e.get("EXT_color_buffer_float"),he}function D(T,M,H){return!0===S(T,H)||T.isFramebufferTexture&&T.minFilter!==en&&T.minFilter!==tn?Math.log2(Math.max(M.width,M.height))+1:void 0!==T.mipmaps&&T.mipmaps.length>0?T.mipmaps.length:T.isCompressedTexture&&Array.isArray(T.image)?M.mipmaps.length:1}function R(T){return T===en||T===Jg||T===Kd?9728:9729}function U(T){const M=T.target;M.removeEventListener("dispose",U),function O(T){const M=i.get(T);if(void 0===M.__webglInit)return;const H=T.source,re=g.get(H);if(re){const se=re[M.__cacheKey];se.usedTimes--,0===se.usedTimes&&L(T),0===Object.keys(re).length&&g.delete(H)}i.remove(T)}(M),M.isVideoTexture&&m.delete(M)}function X(T){const M=T.target;M.removeEventListener("dispose",X),function V(T){const M=T.texture,H=i.get(T),re=i.get(M);if(void 0!==re.__webglTexture&&(n.deleteTexture(re.__webglTexture),o.memory.textures--),T.depthTexture&&T.depthTexture.dispose(),T.isWebGLCubeRenderTarget)for(let se=0;se<6;se++)n.deleteFramebuffer(H.__webglFramebuffer[se]),H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer[se]);else{if(n.deleteFramebuffer(H.__webglFramebuffer),H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&n.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let se=0;se<H.__webglColorRenderbuffer.length;se++)H.__webglColorRenderbuffer[se]&&n.deleteRenderbuffer(H.__webglColorRenderbuffer[se]);H.__webglDepthRenderbuffer&&n.deleteRenderbuffer(H.__webglDepthRenderbuffer)}if(T.isWebGLMultipleRenderTargets)for(let se=0,he=M.length;se<he;se++){const Te=i.get(M[se]);Te.__webglTexture&&(n.deleteTexture(Te.__webglTexture),o.memory.textures--),i.remove(M[se])}i.remove(M),i.remove(T)}(M)}function L(T){const M=i.get(T);n.deleteTexture(M.__webglTexture),delete g.get(T.source)[M.__cacheKey],o.memory.textures--}let J=0;function te(T,M){const H=i.get(T);if(T.isVideoTexture&&function Mt(T){const M=o.render.frame;m.get(T)!==M&&(m.set(T,M),T.update())}(T),!1===T.isRenderTargetTexture&&T.version>0&&H.__version!==T.version){const re=T.image;if(null===re)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==re.complete)return void ve(H,T,M);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,H.__webglTexture,33984+M)}const ae={[Zd]:10497,[$n]:33071,[Jd]:33648},k={[en]:9728,[Jg]:9984,[Kd]:9986,[tn]:9729,[uE]:9985,[Zs]:9987};function xe(T,M,H){if(H?(n.texParameteri(T,10242,ae[M.wrapS]),n.texParameteri(T,10243,ae[M.wrapT]),(32879===T||35866===T)&&n.texParameteri(T,32882,ae[M.wrapR]),n.texParameteri(T,10240,k[M.magFilter]),n.texParameteri(T,10241,k[M.minFilter])):(n.texParameteri(T,10242,33071),n.texParameteri(T,10243,33071),(32879===T||35866===T)&&n.texParameteri(T,32882,33071),(M.wrapS!==$n||M.wrapT!==$n)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(T,10240,R(M.magFilter)),n.texParameteri(T,10241,R(M.minFilter)),M.minFilter!==en&&M.minFilter!==tn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const re=e.get("EXT_texture_filter_anisotropic");if(M.magFilter===en||M.minFilter!==Kd&&M.minFilter!==Zs||M.type===ms&&!1===e.has("OES_texture_float_linear")||!1===a&&M.type===_c&&!1===e.has("OES_texture_half_float_linear"))return;(M.anisotropy>1||i.get(M).__currentAnisotropy)&&(n.texParameterf(T,re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(M.anisotropy,r.getMaxAnisotropy())),i.get(M).__currentAnisotropy=M.anisotropy)}}function pe(T,M){let H=!1;void 0===T.__webglInit&&(T.__webglInit=!0,M.addEventListener("dispose",U));const re=M.source;let se=g.get(re);void 0===se&&(se={},g.set(re,se));const he=function K(T){const M=[];return M.push(T.wrapS),M.push(T.wrapT),M.push(T.wrapR||0),M.push(T.magFilter),M.push(T.minFilter),M.push(T.anisotropy),M.push(T.internalFormat),M.push(T.format),M.push(T.type),M.push(T.generateMipmaps),M.push(T.premultiplyAlpha),M.push(T.flipY),M.push(T.unpackAlignment),M.push(T.encoding),M.join()}(M);if(he!==T.__cacheKey){void 0===se[he]&&(se[he]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,H=!0),se[he].usedTimes++;const Te=se[T.__cacheKey];void 0!==Te&&(se[T.__cacheKey].usedTimes--,0===Te.usedTimes&&L(M)),T.__cacheKey=he,T.__webglTexture=se[he].texture}return H}function ve(T,M,H){let re=3553;(M.isDataArrayTexture||M.isCompressedArrayTexture)&&(re=35866),M.isData3DTexture&&(re=32879);const se=pe(T,M),he=M.source;t.bindTexture(re,T.__webglTexture,33984+H);const Te=i.get(he);if(he.version!==Te.__version||!0===se){t.activeTexture(33984+H),n.pixelStorei(37440,M.flipY),n.pixelStorei(37441,M.premultiplyAlpha),n.pixelStorei(3317,M.unpackAlignment),n.pixelStorei(37443,0);const A=function b(T){return!a&&(T.wrapS!==$n||T.wrapT!==$n||T.minFilter!==en&&T.minFilter!==tn)}(M)&&!1===x(M.image);let N=y(M.image,A,!1,u);N=pt(M,N);const me=x(N)||a,de=s.convert(M.format,M.encoding);let Ae,Ce=s.convert(M.type),Ie=w(M.internalFormat,de,Ce,M.encoding,M.isVideoTexture);xe(re,M,me);const at=M.mipmaps,mt=a&&!0!==M.isVideoTexture,Dt=void 0===Te.__version||!0===se,P=D(M,N,me);if(M.isDepthTexture)Ie=6402,a?Ie=M.type===ms?36012:M.type===Ks?33190:M.type===Ma?35056:33189:M.type===ms&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),M.format===Qs&&6402===Ie&&M.type!==dE&&M.type!==Ks&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),M.type=Ks,Ce=s.convert(M.type)),M.format===Sa&&6402===Ie&&(Ie=34041,M.type!==Ma&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),M.type=Ma,Ce=s.convert(M.type))),Dt&&(mt?t.texStorage2D(3553,1,Ie,N.width,N.height):t.texImage2D(3553,0,Ie,N.width,N.height,0,de,Ce,null));else if(M.isDataTexture)if(at.length>0&&me){mt&&Dt&&t.texStorage2D(3553,P,Ie,at[0].width,at[0].height);for(let W=0,ne=at.length;W<ne;W++)Ae=at[W],mt?t.texSubImage2D(3553,W,0,0,Ae.width,Ae.height,de,Ce,Ae.data):t.texImage2D(3553,W,Ie,Ae.width,Ae.height,0,de,Ce,Ae.data);M.generateMipmaps=!1}else mt?(Dt&&t.texStorage2D(3553,P,Ie,N.width,N.height),t.texSubImage2D(3553,0,0,0,N.width,N.height,de,Ce,N.data)):t.texImage2D(3553,0,Ie,N.width,N.height,0,de,Ce,N.data);else if(M.isCompressedTexture)if(M.isCompressedArrayTexture){mt&&Dt&&t.texStorage3D(35866,P,Ie,at[0].width,at[0].height,N.depth);for(let W=0,ne=at.length;W<ne;W++)Ae=at[W],M.format!==Ni?null!==de?mt?t.compressedTexSubImage3D(35866,W,0,0,0,Ae.width,Ae.height,N.depth,de,Ae.data,0,0):t.compressedTexImage3D(35866,W,Ie,Ae.width,Ae.height,N.depth,0,Ae.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):mt?t.texSubImage3D(35866,W,0,0,0,Ae.width,Ae.height,N.depth,de,Ce,Ae.data):t.texImage3D(35866,W,Ie,Ae.width,Ae.height,N.depth,0,de,Ce,Ae.data)}else{mt&&Dt&&t.texStorage2D(3553,P,Ie,at[0].width,at[0].height);for(let W=0,ne=at.length;W<ne;W++)Ae=at[W],M.format!==Ni?null!==de?mt?t.compressedTexSubImage2D(3553,W,0,0,Ae.width,Ae.height,de,Ae.data):t.compressedTexImage2D(3553,W,Ie,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):mt?t.texSubImage2D(3553,W,0,0,Ae.width,Ae.height,de,Ce,Ae.data):t.texImage2D(3553,W,Ie,Ae.width,Ae.height,0,de,Ce,Ae.data)}else if(M.isDataArrayTexture)mt?(Dt&&t.texStorage3D(35866,P,Ie,N.width,N.height,N.depth),t.texSubImage3D(35866,0,0,0,0,N.width,N.height,N.depth,de,Ce,N.data)):t.texImage3D(35866,0,Ie,N.width,N.height,N.depth,0,de,Ce,N.data);else if(M.isData3DTexture)mt?(Dt&&t.texStorage3D(32879,P,Ie,N.width,N.height,N.depth),t.texSubImage3D(32879,0,0,0,0,N.width,N.height,N.depth,de,Ce,N.data)):t.texImage3D(32879,0,Ie,N.width,N.height,N.depth,0,de,Ce,N.data);else if(M.isFramebufferTexture){if(Dt)if(mt)t.texStorage2D(3553,P,Ie,N.width,N.height);else{let W=N.width,ne=N.height;for(let we=0;we<P;we++)t.texImage2D(3553,we,Ie,W,ne,0,de,Ce,null),W>>=1,ne>>=1}}else if(at.length>0&&me){mt&&Dt&&t.texStorage2D(3553,P,Ie,at[0].width,at[0].height);for(let W=0,ne=at.length;W<ne;W++)Ae=at[W],mt?t.texSubImage2D(3553,W,0,0,de,Ce,Ae):t.texImage2D(3553,W,Ie,de,Ce,Ae);M.generateMipmaps=!1}else mt?(Dt&&t.texStorage2D(3553,P,Ie,N.width,N.height),t.texSubImage2D(3553,0,0,0,de,Ce,N)):t.texImage2D(3553,0,Ie,de,Ce,N);S(M,me)&&I(re),Te.__version=he.version,M.onUpdate&&M.onUpdate(M)}T.__version=M.version}function Se(T,M,H,re,se){const he=s.convert(H.format,H.encoding),Te=s.convert(H.type),A=w(H.internalFormat,he,Te,H.encoding);i.get(M).__hasExternalTextures||(32879===se||35866===se?t.texImage3D(se,0,A,M.width,M.height,M.depth,0,he,Te,null):t.texImage2D(se,0,A,M.width,M.height,0,he,Te,null)),t.bindFramebuffer(36160,T),We(M)?h.framebufferTexture2DMultisampleEXT(36160,re,se,i.get(H).__webglTexture,0,Re(M)):(3553===se||se>=34069&&se<=34074)&&n.framebufferTexture2D(36160,re,se,i.get(H).__webglTexture,0),t.bindFramebuffer(36160,null)}function Be(T,M,H){if(n.bindRenderbuffer(36161,T),M.depthBuffer&&!M.stencilBuffer){let re=33189;if(H||We(M)){const se=M.depthTexture;se&&se.isDepthTexture&&(se.type===ms?re=36012:se.type===Ks&&(re=33190));const he=Re(M);We(M)?h.renderbufferStorageMultisampleEXT(36161,he,re,M.width,M.height):n.renderbufferStorageMultisample(36161,he,re,M.width,M.height)}else n.renderbufferStorage(36161,re,M.width,M.height);n.framebufferRenderbuffer(36160,36096,36161,T)}else if(M.depthBuffer&&M.stencilBuffer){const re=Re(M);H&&!1===We(M)?n.renderbufferStorageMultisample(36161,re,35056,M.width,M.height):We(M)?h.renderbufferStorageMultisampleEXT(36161,re,35056,M.width,M.height):n.renderbufferStorage(36161,34041,M.width,M.height),n.framebufferRenderbuffer(36160,33306,36161,T)}else{const re=!0===M.isWebGLMultipleRenderTargets?M.texture:[M.texture];for(let se=0;se<re.length;se++){const he=re[se],Te=s.convert(he.format,he.encoding),A=s.convert(he.type),N=w(he.internalFormat,Te,A,he.encoding),me=Re(M);H&&!1===We(M)?n.renderbufferStorageMultisample(36161,me,N,M.width,M.height):We(M)?h.renderbufferStorageMultisampleEXT(36161,me,N,M.width,M.height):n.renderbufferStorage(36161,N,M.width,M.height)}}n.bindRenderbuffer(36161,null)}function Q(T){const M=i.get(T),H=!0===T.isWebGLCubeRenderTarget;if(T.depthTexture&&!M.__autoAllocateDepthBuffer){if(H)throw new Error("target.depthTexture not supported in Cube render targets");!function Y(T,M){if(M&&M.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,T),!M.depthTexture||!M.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(M.depthTexture).__webglTexture||M.depthTexture.image.width!==M.width||M.depthTexture.image.height!==M.height)&&(M.depthTexture.image.width=M.width,M.depthTexture.image.height=M.height,M.depthTexture.needsUpdate=!0),te(M.depthTexture,0);const re=i.get(M.depthTexture).__webglTexture,se=Re(M);if(M.depthTexture.format===Qs)We(M)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,re,0,se):n.framebufferTexture2D(36160,36096,3553,re,0);else{if(M.depthTexture.format!==Sa)throw new Error("Unknown depthTexture format");We(M)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,re,0,se):n.framebufferTexture2D(36160,33306,3553,re,0)}}(M.__webglFramebuffer,T)}else if(H){M.__webglDepthbuffer=[];for(let re=0;re<6;re++)t.bindFramebuffer(36160,M.__webglFramebuffer[re]),M.__webglDepthbuffer[re]=n.createRenderbuffer(),Be(M.__webglDepthbuffer[re],T,!1)}else t.bindFramebuffer(36160,M.__webglFramebuffer),M.__webglDepthbuffer=n.createRenderbuffer(),Be(M.__webglDepthbuffer,T,!1);t.bindFramebuffer(36160,null)}function Re(T){return Math.min(d,T.samples)}function We(T){const M=i.get(T);return a&&T.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==M.__useRenderToTexture}function pt(T,M){const H=T.encoding,re=T.format,se=T.type;return!0===T.isCompressedTexture||!0===T.isVideoTexture||T.format===oy||H!==eo&&(H===Nt?!1===a?!0===e.has("EXT_sRGB")&&re===Ni?(T.format=oy,T.minFilter=tn,T.generateMipmaps=!1):M=GE.sRGBToLinear(M):(re!==Ni||se!==Js)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",H)),M}this.allocateTextureUnit=function j(){const T=J;return T>=l&&console.warn("THREE.WebGLTextures: Trying to use "+T+" texture units while this GPU supports only "+l),J+=1,T},this.resetTextureUnits=function ie(){J=0},this.setTexture2D=te,this.setTexture2DArray=function ye(T,M){const H=i.get(T);T.version>0&&H.__version!==T.version?ve(H,T,M):t.bindTexture(35866,H.__webglTexture,33984+M)},this.setTexture3D=function z(T,M){const H=i.get(T);T.version>0&&H.__version!==T.version?ve(H,T,M):t.bindTexture(32879,H.__webglTexture,33984+M)},this.setTextureCube=function ee(T,M){const H=i.get(T);T.version>0&&H.__version!==T.version?function be(T,M,H){if(6!==M.image.length)return;const re=pe(T,M),se=M.source;t.bindTexture(34067,T.__webglTexture,33984+H);const he=i.get(se);if(se.version!==he.__version||!0===re){t.activeTexture(33984+H),n.pixelStorei(37440,M.flipY),n.pixelStorei(37441,M.premultiplyAlpha),n.pixelStorei(3317,M.unpackAlignment),n.pixelStorei(37443,0);const Te=M.isCompressedTexture||M.image[0].isCompressedTexture,A=M.image[0]&&M.image[0].isDataTexture,N=[];for(let W=0;W<6;W++)N[W]=Te||A?A?M.image[W].image:M.image[W]:y(M.image[W],!1,!0,c),N[W]=pt(M,N[W]);const me=N[0],de=x(me)||a,Ce=s.convert(M.format,M.encoding),Ie=s.convert(M.type),Ae=w(M.internalFormat,Ce,Ie,M.encoding),at=a&&!0!==M.isVideoTexture,mt=void 0===he.__version||!0===re;let P,Dt=D(M,me,de);if(xe(34067,M,de),Te){at&&mt&&t.texStorage2D(34067,Dt,Ae,me.width,me.height);for(let W=0;W<6;W++){P=N[W].mipmaps;for(let ne=0;ne<P.length;ne++){const we=P[ne];M.format!==Ni?null!==Ce?at?t.compressedTexSubImage2D(34069+W,ne,0,0,we.width,we.height,Ce,we.data):t.compressedTexImage2D(34069+W,ne,Ae,we.width,we.height,0,we.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):at?t.texSubImage2D(34069+W,ne,0,0,we.width,we.height,Ce,Ie,we.data):t.texImage2D(34069+W,ne,Ae,we.width,we.height,0,Ce,Ie,we.data)}}}else{P=M.mipmaps,at&&mt&&(P.length>0&&Dt++,t.texStorage2D(34067,Dt,Ae,N[0].width,N[0].height));for(let W=0;W<6;W++)if(A){at?t.texSubImage2D(34069+W,0,0,0,N[W].width,N[W].height,Ce,Ie,N[W].data):t.texImage2D(34069+W,0,Ae,N[W].width,N[W].height,0,Ce,Ie,N[W].data);for(let ne=0;ne<P.length;ne++){const Ee=P[ne].image[W].image;at?t.texSubImage2D(34069+W,ne+1,0,0,Ee.width,Ee.height,Ce,Ie,Ee.data):t.texImage2D(34069+W,ne+1,Ae,Ee.width,Ee.height,0,Ce,Ie,Ee.data)}}else{at?t.texSubImage2D(34069+W,0,0,0,Ce,Ie,N[W]):t.texImage2D(34069+W,0,Ae,Ce,Ie,N[W]);for(let ne=0;ne<P.length;ne++){const we=P[ne];at?t.texSubImage2D(34069+W,ne+1,0,0,Ce,Ie,we.image[W]):t.texImage2D(34069+W,ne+1,Ae,Ce,Ie,we.image[W])}}}S(M,de)&&I(34067),he.__version=se.version,M.onUpdate&&M.onUpdate(M)}T.__version=M.version}(H,T,M):t.bindTexture(34067,H.__webglTexture,33984+M)},this.rebindTextures=function oe(T,M,H){const re=i.get(T);void 0!==M&&Se(re.__webglFramebuffer,T,T.texture,36064,3553),void 0!==H&&Q(T)},this.setupRenderTarget=function De(T){const M=T.texture,H=i.get(T),re=i.get(M);T.addEventListener("dispose",X),!0!==T.isWebGLMultipleRenderTargets&&(void 0===re.__webglTexture&&(re.__webglTexture=n.createTexture()),re.__version=M.version,o.memory.textures++);const se=!0===T.isWebGLCubeRenderTarget,he=!0===T.isWebGLMultipleRenderTargets,Te=x(T)||a;if(se){H.__webglFramebuffer=[];for(let A=0;A<6;A++)H.__webglFramebuffer[A]=n.createFramebuffer()}else{if(H.__webglFramebuffer=n.createFramebuffer(),he)if(r.drawBuffers){const A=T.texture;for(let N=0,me=A.length;N<me;N++){const de=i.get(A[N]);void 0===de.__webglTexture&&(de.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&T.samples>0&&!1===We(T)){const A=he?M:[M];H.__webglMultisampledFramebuffer=n.createFramebuffer(),H.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,H.__webglMultisampledFramebuffer);for(let N=0;N<A.length;N++){const me=A[N];H.__webglColorRenderbuffer[N]=n.createRenderbuffer(),n.bindRenderbuffer(36161,H.__webglColorRenderbuffer[N]);const de=s.convert(me.format,me.encoding),Ce=s.convert(me.type),Ie=w(me.internalFormat,de,Ce,me.encoding,!0===T.isXRRenderTarget),Ae=Re(T);n.renderbufferStorageMultisample(36161,Ae,Ie,T.width,T.height),n.framebufferRenderbuffer(36160,36064+N,36161,H.__webglColorRenderbuffer[N])}n.bindRenderbuffer(36161,null),T.depthBuffer&&(H.__webglDepthRenderbuffer=n.createRenderbuffer(),Be(H.__webglDepthRenderbuffer,T,!0)),t.bindFramebuffer(36160,null)}}if(se){t.bindTexture(34067,re.__webglTexture),xe(34067,M,Te);for(let A=0;A<6;A++)Se(H.__webglFramebuffer[A],T,M,36064,34069+A);S(M,Te)&&I(34067),t.unbindTexture()}else if(he){const A=T.texture;for(let N=0,me=A.length;N<me;N++){const de=A[N],Ce=i.get(de);t.bindTexture(3553,Ce.__webglTexture),xe(3553,de,Te),Se(H.__webglFramebuffer,T,de,36064+N,3553),S(de,Te)&&I(3553)}t.unbindTexture()}else{let A=3553;(T.isWebGL3DRenderTarget||T.isWebGLArrayRenderTarget)&&(a?A=T.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(A,re.__webglTexture),xe(A,M,Te),Se(H.__webglFramebuffer,T,M,36064,A),S(M,Te)&&I(A),t.unbindTexture()}T.depthBuffer&&Q(T)},this.updateRenderTargetMipmap=function ue(T){const M=x(T)||a,H=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let re=0,se=H.length;re<se;re++){const he=H[re];if(S(he,M)){const Te=T.isWebGLCubeRenderTarget?34067:3553,A=i.get(he).__webglTexture;t.bindTexture(Te,A),I(Te),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function He(T){if(a&&T.samples>0&&!1===We(T)){const M=T.isWebGLMultipleRenderTargets?T.texture:[T.texture],H=T.width,re=T.height;let se=16384;const he=[],Te=T.stencilBuffer?33306:36096,A=i.get(T),N=!0===T.isWebGLMultipleRenderTargets;if(N)for(let me=0;me<M.length;me++)t.bindFramebuffer(36160,A.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+me,36161,null),t.bindFramebuffer(36160,A.__webglFramebuffer),n.framebufferTexture2D(36009,36064+me,3553,null,0);t.bindFramebuffer(36008,A.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,A.__webglFramebuffer);for(let me=0;me<M.length;me++){he.push(36064+me),T.depthBuffer&&he.push(Te);const de=void 0!==A.__ignoreDepthValues&&A.__ignoreDepthValues;if(!1===de&&(T.depthBuffer&&(se|=256),T.stencilBuffer&&(se|=1024)),N&&n.framebufferRenderbuffer(36008,36064,36161,A.__webglColorRenderbuffer[me]),!0===de&&(n.invalidateFramebuffer(36008,[Te]),n.invalidateFramebuffer(36009,[Te])),N){const Ce=i.get(M[me]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ce,0)}n.blitFramebuffer(0,0,H,re,0,0,H,re,se,9728),f&&n.invalidateFramebuffer(36008,he)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),N)for(let me=0;me<M.length;me++){t.bindFramebuffer(36160,A.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+me,36161,A.__webglColorRenderbuffer[me]);const de=i.get(M[me]).__webglTexture;t.bindFramebuffer(36160,A.__webglFramebuffer),n.framebufferTexture2D(36009,36064+me,3553,de,0)}t.bindFramebuffer(36009,A.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Q,this.setupFrameBufferTexture=Se,this.useMultisampledRTT=We}function GG(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Js)return 5121;if(s===Zz)return 32819;if(s===Jz)return 32820;if(s===qz)return 5120;if(s===Xz)return 5122;if(s===dE)return 5123;if(s===Yz)return 5124;if(s===Ks)return 5125;if(s===ms)return 5126;if(s===_c)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===Kz)return 6406;if(s===Ni)return 6408;if(s===Qz)return 6409;if(s===eV)return 6410;if(s===Qs)return 6402;if(s===Sa)return 34041;if(s===oy)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===tV)return 6403;if(s===nV)return 36244;if(s===iV)return 33319;if(s===rV)return 33320;if(s===sV)return 36249;if(s===Kg||s===Qg||s===ey||s===ty)if(o===Nt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===Kg)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Qg)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===ey)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===ty)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===Kg)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Qg)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===ey)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===ty)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===hE||s===fE||s===pE||s===mE){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===hE)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===fE)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===pE)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===mE)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===oV)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===gE||s===yE){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===gE)return o===Nt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===yE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===vE||s===_E||s===xE||s===wE||s===bE||s===ME||s===SE||s===DE||s===EE||s===CE||s===TE||s===AE||s===IE||s===RE){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===vE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===_E)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===xE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===wE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===bE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===ME)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===SE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===DE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===EE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===CE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===TE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===AE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===IE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===RE)return o===Nt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===ny){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===ny)return o===Nt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(s===aV||s===PE||s===LE||s===NE){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(s===ny)return a.COMPRESSED_RED_RGTC1_EXT;if(s===PE)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===LE)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===NE)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Ma?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class WG extends Sn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Lc extends xi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const $G={type:"move"};class By{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Lc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Lc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Lc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const p of e.hand.values()){const g=t.getJointPose(p,i),v=this._getHandJoint(c,p);null!==g&&(v.matrix.fromArray(g.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=g.radius),v.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,m=.005;c.inputState.pinching&&h>f+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent($G)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Lc;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class jG extends ys{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:Qs)!==Qs&&u!==Sa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Qs&&(i=Ks),void 0===i&&u===Sa&&(i=Ma),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:en,this.minFilter=void 0!==l?l:en,this.flipY=!1,this.generateMipmaps=!1}}class qG extends no{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,m=null;const p=t.getContextAttributes();let g=null,v=null;const _=[],y=[],x=new Set,b=new Map,S=new Sn;S.layers.enable(1),S.viewport=new St;const I=new Sn;I.layers.enable(2),I.viewport=new St;const w=[S,I],D=new WG;D.layers.enable(1),D.layers.enable(2);let R=null,U=null;function X(z){const ee=y.indexOf(z.inputSource);if(-1===ee)return;const ae=_[ee];void 0!==ae&&ae.dispatchEvent({type:z.type,data:z.inputSource})}function O(){r.removeEventListener("select",X),r.removeEventListener("selectstart",X),r.removeEventListener("selectend",X),r.removeEventListener("squeeze",X),r.removeEventListener("squeezestart",X),r.removeEventListener("squeezeend",X),r.removeEventListener("end",O),r.removeEventListener("inputsourceschange",L);for(let z=0;z<_.length;z++){const ee=y[z];null!==ee&&(y[z]=null,_[z].disconnect(ee))}R=null,U=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,v=null,ye.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function L(z){for(let ee=0;ee<z.removed.length;ee++){const ae=z.removed[ee],k=y.indexOf(ae);k>=0&&(y[k]=null,_[k].disconnect(ae))}for(let ee=0;ee<z.added.length;ee++){const ae=z.added[ee];let k=y.indexOf(ae);if(-1===k){for(let pe=0;pe<_.length;pe++){if(pe>=y.length){y.push(ae),k=pe;break}if(null===y[pe]){y[pe]=ae,k=pe;break}}if(-1===k)break}const xe=_[k];xe&&xe.connect(ae)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(z){let ee=_[z];return void 0===ee&&(ee=new By,_[z]=ee),ee.getTargetRaySpace()},this.getControllerGrip=function(z){let ee=_[z];return void 0===ee&&(ee=new By,_[z]=ee),ee.getGripSpace()},this.getHand=function(z){let ee=_[z];return void 0===ee&&(ee=new By,_[z]=ee),ee.getHandSpace()},this.setFramebufferScaleFactor=function(z){s=z,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(z){a=z,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(z){c=z},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(){var z=function yz(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){eE(s,i,r,o,a,"next",l)}function a(l){eE(s,i,r,o,a,"throw",l)}o(void 0)})}}(function*(ee){if(r=ee,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",X),r.addEventListener("selectstart",X),r.addEventListener("selectend",X),r.addEventListener("squeeze",X),r.addEventListener("squeezestart",X),r.addEventListener("squeezeend",X),r.addEventListener("end",O),r.addEventListener("inputsourceschange",L),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),v=new ro(f.framebufferWidth,f.framebufferHeight,{format:Ni,type:Js,encoding:e.outputEncoding,stencilBuffer:p.stencil});else{let ae=null,k=null,xe=null;p.depth&&(xe=p.stencil?35056:33190,ae=p.stencil?Sa:Qs,k=p.stencil?Ma:Ks);const pe={colorFormat:32856,depthFormat:xe,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(pe),r.updateRenderState({layers:[h]}),v=new ro(h.textureWidth,h.textureHeight,{format:Ni,type:Js,depthTexture:new jG(h.textureWidth,h.textureHeight,k,void 0,void 0,void 0,void 0,void 0,void 0,ae),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(v).__ignoreDepthValues=h.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),ye.setContext(r),ye.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(ee){return z.apply(this,arguments)}}();const V=new E,J=new E;function j(z,ee){null===ee?z.matrixWorld.copy(z.matrix):z.matrixWorld.multiplyMatrices(ee.matrixWorld,z.matrix),z.matrixWorldInverse.copy(z.matrixWorld).invert()}this.updateCamera=function(z){if(null===r)return;D.near=I.near=S.near=z.near,D.far=I.far=S.far=z.far,(R!==D.near||U!==D.far)&&(r.updateRenderState({depthNear:D.near,depthFar:D.far}),R=D.near,U=D.far);const ee=z.parent,ae=D.cameras;j(D,ee);for(let xe=0;xe<ae.length;xe++)j(ae[xe],ee);D.matrixWorld.decompose(D.position,D.quaternion,D.scale),z.matrix.copy(D.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale);const k=z.children;for(let xe=0,pe=k.length;xe<pe;xe++)k[xe].updateMatrixWorld(!0);2===ae.length?function ie(z,ee,ae){V.setFromMatrixPosition(ee.matrixWorld),J.setFromMatrixPosition(ae.matrixWorld);const k=V.distanceTo(J),xe=ee.projectionMatrix.elements,pe=ae.projectionMatrix.elements,ve=xe[14]/(xe[10]-1),be=xe[14]/(xe[10]+1),Se=(xe[9]+1)/xe[5],Be=(xe[9]-1)/xe[5],Y=(xe[8]-1)/xe[0],Q=(pe[8]+1)/pe[0],oe=ve*Y,De=ve*Q,ue=k/(-Y+Q),He=ue*-Y;ee.matrixWorld.decompose(z.position,z.quaternion,z.scale),z.translateX(He),z.translateZ(ue),z.matrixWorld.compose(z.position,z.quaternion,z.scale),z.matrixWorldInverse.copy(z.matrixWorld).invert();const Re=ve+ue,We=be+ue;z.projectionMatrix.makePerspective(oe-He,De+(k-He),Se*be/We*Re,Be*be/We*Re,Re,We)}(D,S,I):D.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return D},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(z){l=z,null!==h&&(h.fixedFoveation=z),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=z)},this.getPlanes=function(){return x};let K=null;const ye=new sC;ye.setAnimationLoop(function te(z,ee){if(u=ee.getViewerPose(c||o),m=ee,null!==u){const ae=u.views;null!==f&&(e.setRenderTargetFramebuffer(v,f.framebuffer),e.setRenderTarget(v));let k=!1;ae.length!==D.cameras.length&&(D.cameras.length=0,k=!0);for(let xe=0;xe<ae.length;xe++){const pe=ae[xe];let ve=null;if(null!==f)ve=f.getViewport(pe);else{const Se=d.getViewSubImage(h,pe);ve=Se.viewport,0===xe&&(e.setRenderTargetTextures(v,Se.colorTexture,h.ignoreDepthValues?void 0:Se.depthStencilTexture),e.setRenderTarget(v))}let be=w[xe];void 0===be&&(be=new Sn,be.layers.enable(xe),be.viewport=new St,w[xe]=be),be.matrix.fromArray(pe.transform.matrix),be.projectionMatrix.fromArray(pe.projectionMatrix),be.viewport.set(ve.x,ve.y,ve.width,ve.height),0===xe&&D.matrix.copy(be.matrix),!0===k&&D.cameras.push(be)}}for(let ae=0;ae<_.length;ae++){const k=y[ae],xe=_[ae];null!==k&&void 0!==xe&&xe.update(k,ee,c||o)}if(K&&K(z,ee),ee.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:ee.detectedPlanes});let ae=null;for(const k of x)ee.detectedPlanes.has(k)||(null===ae&&(ae=[]),ae.push(k));if(null!==ae)for(const k of ae)x.delete(k),b.delete(k),i.dispatchEvent({type:"planeremoved",data:k});for(const k of ee.detectedPlanes)if(x.has(k)){const xe=b.get(k);k.lastChangedTime>xe&&(b.set(k,k.lastChangedTime),i.dispatchEvent({type:"planechanged",data:k}))}else x.add(k),b.set(k,ee.lastChangedTime),i.dispatchEvent({type:"planeadded",data:k})}m=null}),this.setAnimationLoop=function(z){K=z},this.dispose=function(){}}}function XG(n,e){function r(p,g){p.opacity.value=g.opacity,g.color&&p.diffuse.value.copy(g.color),g.emissive&&p.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.bumpMap&&(p.bumpMap.value=g.bumpMap,p.bumpScale.value=g.bumpScale,g.side===yi&&(p.bumpScale.value*=-1)),g.displacementMap&&(p.displacementMap.value=g.displacementMap,p.displacementScale.value=g.displacementScale,p.displacementBias.value=g.displacementBias),g.emissiveMap&&(p.emissiveMap.value=g.emissiveMap),g.normalMap&&(p.normalMap.value=g.normalMap,p.normalScale.value.copy(g.normalScale),g.side===yi&&p.normalScale.value.negate()),g.specularMap&&(p.specularMap.value=g.specularMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest);const v=e.get(g).envMap;if(v&&(p.envMap.value=v,p.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,p.reflectivity.value=g.reflectivity,p.ior.value=g.ior,p.refractionRatio.value=g.refractionRatio),g.lightMap){p.lightMap.value=g.lightMap;const x=!0===n.useLegacyLights?Math.PI:1;p.lightMapIntensity.value=g.lightMapIntensity*x}let _,y;g.aoMap&&(p.aoMap.value=g.aoMap,p.aoMapIntensity.value=g.aoMapIntensity),g.map?_=g.map:g.specularMap?_=g.specularMap:g.displacementMap?_=g.displacementMap:g.normalMap?_=g.normalMap:g.bumpMap?_=g.bumpMap:g.roughnessMap?_=g.roughnessMap:g.metalnessMap?_=g.metalnessMap:g.alphaMap?_=g.alphaMap:g.emissiveMap?_=g.emissiveMap:g.clearcoatMap?_=g.clearcoatMap:g.clearcoatNormalMap?_=g.clearcoatNormalMap:g.clearcoatRoughnessMap?_=g.clearcoatRoughnessMap:g.iridescenceMap?_=g.iridescenceMap:g.iridescenceThicknessMap?_=g.iridescenceThicknessMap:g.specularIntensityMap?_=g.specularIntensityMap:g.specularColorMap?_=g.specularColorMap:g.transmissionMap?_=g.transmissionMap:g.thicknessMap?_=g.thicknessMap:g.sheenColorMap?_=g.sheenColorMap:g.sheenRoughnessMap&&(_=g.sheenRoughnessMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix)),g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(p,g){g.color.getRGB(p.fogColor.value,rC(n)),g.isFog?(p.fogNear.value=g.near,p.fogFar.value=g.far):g.isFogExp2&&(p.fogDensity.value=g.density)},refreshMaterialUniforms:function i(p,g,v,_,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(p,g):g.isMeshToonMaterial?(r(p,g),function u(p,g){g.gradientMap&&(p.gradientMap.value=g.gradientMap)}(p,g)):g.isMeshPhongMaterial?(r(p,g),function c(p,g){p.specular.value.copy(g.specular),p.shininess.value=Math.max(g.shininess,1e-4)}(p,g)):g.isMeshStandardMaterial?(r(p,g),function d(p,g){p.roughness.value=g.roughness,p.metalness.value=g.metalness,g.roughnessMap&&(p.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(p.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(p.envMapIntensity.value=g.envMapIntensity)}(p,g),g.isMeshPhysicalMaterial&&function h(p,g,v){p.ior.value=g.ior,g.sheen>0&&(p.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),p.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(p.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(p.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(p.clearcoat.value=g.clearcoat,p.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(p.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),p.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===yi&&p.clearcoatNormalScale.value.negate())),g.iridescence>0&&(p.iridescence.value=g.iridescence,p.iridescenceIOR.value=g.iridescenceIOR,p.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(p.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(p.transmission.value=g.transmission,p.transmissionSamplerMap.value=v.texture,p.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(p.transmissionMap.value=g.transmissionMap),p.thickness.value=g.thickness,g.thicknessMap&&(p.thicknessMap.value=g.thicknessMap),p.attenuationDistance.value=g.attenuationDistance,p.attenuationColor.value.copy(g.attenuationColor)),p.specularIntensity.value=g.specularIntensity,p.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(p.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(p.specularColorMap.value=g.specularColorMap)}(p,g,y)):g.isMeshMatcapMaterial?(r(p,g),function f(p,g){g.matcap&&(p.matcap.value=g.matcap)}(p,g)):g.isMeshDepthMaterial?r(p,g):g.isMeshDistanceMaterial?(r(p,g),function m(p,g){p.referencePosition.value.copy(g.referencePosition),p.nearDistance.value=g.nearDistance,p.farDistance.value=g.farDistance}(p,g)):g.isMeshNormalMaterial?r(p,g):g.isLineBasicMaterial?(function s(p,g){p.diffuse.value.copy(g.color),p.opacity.value=g.opacity}(p,g),g.isLineDashedMaterial&&function o(p,g){p.dashSize.value=g.dashSize,p.totalSize.value=g.dashSize+g.gapSize,p.scale.value=g.scale}(p,g)):g.isPointsMaterial?function a(p,g,v,_){let y;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.size.value=g.size*v,p.scale.value=.5*_,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uvTransform.value.copy(y.matrix))}(p,g,v,_):g.isSpriteMaterial?function l(p,g){let v;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.rotation.value=g.rotation,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix))}(p,g):g.isShadowMaterial?(p.color.value.copy(g.color),p.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function YG(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function f(_,y,x){const b=_.value;if(void 0===x[y]){if("number"==typeof b)x[y]=b;else{const S=Array.isArray(b)?b:[b],I=[];for(let w=0;w<S.length;w++)I.push(S[w].clone());x[y]=I}return!0}if("number"==typeof b){if(x[y]!==b)return x[y]=b,!0}else{const S=Array.isArray(x[y])?x[y]:[x[y]],I=Array.isArray(b)?b:[b];for(let w=0;w<S.length;w++){const D=S[w];if(!1===D.equals(I[w]))return D.copy(I[w]),!0}}return!1}function p(_){const y={boundary:0,storage:0};return"number"==typeof _?(y.boundary=4,y.storage=4):_.isVector2?(y.boundary=8,y.storage=8):_.isVector3||_.isColor?(y.boundary=16,y.storage=12):_.isVector4?(y.boundary=16,y.storage=16):_.isMatrix3?(y.boundary=48,y.storage=48):_.isMatrix4?(y.boundary=64,y.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),y}function g(_){const y=_.target;y.removeEventListener("dispose",g);const x=o.indexOf(y.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function l(_,y){i.uniformBlockBinding(_,y.program)},update:function c(_,y){let x=r[_.id];void 0===x&&(function m(_){const y=_.uniforms;let x=0;let S=0;for(let I=0,w=y.length;I<w;I++){const D=y[I],R={boundary:0,storage:0},U=Array.isArray(D.value)?D.value:[D.value];for(let X=0,O=U.length;X<O;X++){const V=p(U[X]);R.boundary+=V.boundary,R.storage+=V.storage}D.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=x,I>0&&(S=x%16,0!==S&&16-S-R.boundary<0&&(x+=16-S,D.__offset=x)),x+=R.storage}S=x%16,S>0&&(x+=16-S),_.__size=x,_.__cache={}}(_),x=function u(_){const y=function d(){for(let _=0;_<a;_++)if(-1===o.indexOf(_))return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();_.__bindingPointIndex=y;const x=n.createBuffer(),b=_.__size,S=_.usage;return n.bindBuffer(35345,x),n.bufferData(35345,b,S),n.bindBuffer(35345,null),n.bindBufferBase(35345,y,x),x}(_),r[_.id]=x,_.addEventListener("dispose",g)),i.updateUBOMapping(_,y.program);const S=e.render.frame;s[_.id]!==S&&(function h(_){const x=_.uniforms,b=_.__cache;n.bindBuffer(35345,r[_.id]);for(let S=0,I=x.length;S<I;S++){const w=x[S];if(!0===f(w,S,b)){const D=w.__offset,R=Array.isArray(w.value)?w.value:[w.value];let U=0;for(let X=0;X<R.length;X++){const O=R[X],L=p(O);"number"==typeof O?(w.__data[0]=O,n.bufferSubData(35345,D+U,w.__data)):O.isMatrix3?(w.__data[0]=O.elements[0],w.__data[1]=O.elements[1],w.__data[2]=O.elements[2],w.__data[3]=O.elements[0],w.__data[4]=O.elements[3],w.__data[5]=O.elements[4],w.__data[6]=O.elements[5],w.__data[7]=O.elements[0],w.__data[8]=O.elements[6],w.__data[9]=O.elements[7],w.__data[10]=O.elements[8],w.__data[11]=O.elements[0]):(O.toArray(w.__data,U),U+=L.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,D,w.__data)}}n.bindBuffer(35345,null)}(_),s[_.id]=S)},dispose:function v(){for(const _ in r)n.deleteBuffer(r[_]);o=[],r={},s={}}}}function Uy(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function ZG(){const n=Mc("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=eo,this.useLegacyLights=!0,this.toneMapping=zr,this.toneMappingExposure=1;const p=this;let g=!1,v=0,_=0,y=null,x=-1,b=null;const S=new St,I=new St;let w=null,D=e.width,R=e.height,U=1,X=null,O=null;const L=new St(0,0,D,R),V=new St(0,0,D,R);let J=!1;const ie=new Ry;let j=!1,K=!1,te=null;const ye=new Ke,z=new E,ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ae(){return null===y?U:1}let pe,ve,be,Se,Be,Y,Q,oe,De,ue,He,Re,We,Mt,pt,T,M,H,re,se,he,Te,A,N,k=t;function xe(C,B){for(let G=0;G<C.length;G++){const $=e.getContext(C[G],B);if(null!==$)return $}return null}try{const C={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Xg}`),e.addEventListener("webglcontextlost",Ce,!1),e.addEventListener("webglcontextrestored",Ie,!1),e.addEventListener("webglcontextcreationerror",Ae,!1),null===k){const B=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&B.shift(),k=xe(B,C),null===k)throw xe(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===k.getShaderPrecisionFormat&&(k.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(C){throw console.error("THREE.WebGLRenderer: "+C.message),C}function me(){pe=new c5(k),ve=new i5(k,pe,n),pe.init(ve),Te=new GG(k,pe,ve),be=new VG(k,pe,ve),Se=new h5,Be=new AG,Y=new HG(k,pe,be,Be,ve,Te,Se),Q=new s5(p),oe=new l5(p),De=new t4(k,ve),A=new t5(k,pe,De,ve),ue=new u5(k,De,Se,A),He=new g5(k,ue,De,Se),re=new m5(k,ve,Y),T=new r5(Be),Re=new TG(p,Q,oe,pe,ve,A,T),We=new XG(p,Be),Mt=new RG,pt=new kG(pe,ve),H=new e5(p,Q,oe,be,He,u,o),M=new zG(p,He,ve),N=new YG(k,Se,ve,be),se=new n5(k,pe,Se,ve),he=new d5(k,pe,Se,ve),Se.programs=Re.programs,p.capabilities=ve,p.extensions=pe,p.properties=Be,p.renderLists=Mt,p.shadowMap=M,p.state=be,p.info=Se}me();const de=new qG(p,k);function Ce(C){C.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ie(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const C=Se.autoReset,B=M.enabled,G=M.autoUpdate,F=M.needsUpdate,$=M.type;me(),Se.autoReset=C,M.enabled=B,M.autoUpdate=G,M.needsUpdate=F,M.type=$}function Ae(C){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",C.statusMessage)}function at(C){const B=C.target;B.removeEventListener("dispose",at),function mt(C){(function Dt(C){const B=Be.get(C).programs;void 0!==B&&(B.forEach(function(G){Re.releaseProgram(G)}),C.isShaderMaterial&&Re.releaseShaderCache(C))})(C),Be.remove(C)}(B)}this.xr=de,this.getContext=function(){return k},this.getContextAttributes=function(){return k.getContextAttributes()},this.forceContextLoss=function(){const C=pe.get("WEBGL_lose_context");C&&C.loseContext()},this.forceContextRestore=function(){const C=pe.get("WEBGL_lose_context");C&&C.restoreContext()},this.getPixelRatio=function(){return U},this.setPixelRatio=function(C){void 0!==C&&(U=C,this.setSize(D,R,!1))},this.getSize=function(C){return C.set(D,R)},this.setSize=function(C,B,G=!0){de.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(D=C,R=B,e.width=Math.floor(C*U),e.height=Math.floor(B*U),!0===G&&(e.style.width=C+"px",e.style.height=B+"px"),this.setViewport(0,0,C,B))},this.getDrawingBufferSize=function(C){return C.set(D*U,R*U).floor()},this.setDrawingBufferSize=function(C,B,G){D=C,R=B,U=G,e.width=Math.floor(C*G),e.height=Math.floor(B*G),this.setViewport(0,0,C,B)},this.getCurrentViewport=function(C){return C.copy(S)},this.getViewport=function(C){return C.copy(L)},this.setViewport=function(C,B,G,F){C.isVector4?L.set(C.x,C.y,C.z,C.w):L.set(C,B,G,F),be.viewport(S.copy(L).multiplyScalar(U).floor())},this.getScissor=function(C){return C.copy(V)},this.setScissor=function(C,B,G,F){C.isVector4?V.set(C.x,C.y,C.z,C.w):V.set(C,B,G,F),be.scissor(I.copy(V).multiplyScalar(U).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(C){be.setScissorTest(J=C)},this.setOpaqueSort=function(C){X=C},this.setTransparentSort=function(C){O=C},this.getClearColor=function(C){return C.copy(H.getClearColor())},this.setClearColor=function(){H.setClearColor.apply(H,arguments)},this.getClearAlpha=function(){return H.getClearAlpha()},this.setClearAlpha=function(){H.setClearAlpha.apply(H,arguments)},this.clear=function(C=!0,B=!0,G=!0){let F=0;C&&(F|=16384),B&&(F|=256),G&&(F|=1024),k.clear(F)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ce,!1),e.removeEventListener("webglcontextrestored",Ie,!1),e.removeEventListener("webglcontextcreationerror",Ae,!1),Mt.dispose(),pt.dispose(),Be.dispose(),Q.dispose(),oe.dispose(),He.dispose(),A.dispose(),N.dispose(),Re.dispose(),de.dispose(),de.removeEventListener("sessionstart",ne),de.removeEventListener("sessionend",we),te&&(te.dispose(),te=null),Ee.stop()},this.renderBufferDirect=function(C,B,G,F,$,Fe){null===B&&(B=ee);const Ye=$.isMesh&&$.matrixWorld.determinant()<0,nt=function j8(C,B,G,F,$){!0!==B.isScene&&(B=ee),Y.resetTextureUnits();const Fe=B.fog,nt=null===y?p.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:eo,st=(F.isMeshStandardMaterial?oe:Q).get(F.envMap||(F.isMeshStandardMaterial?B.environment:null)),gt=!0===F.vertexColors&&!!G.attributes.color&&4===G.attributes.color.itemSize,ut=!!F.normalMap&&!!G.attributes.tangent,dt=!!G.morphAttributes.position,rn=!!G.morphAttributes.normal,Mi=!!G.morphAttributes.color,Zr=F.toneMapped?p.toneMapping:zr,xo=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,sn=void 0!==xo?xo.length:0,ht=Be.get(F),Ev=h.state.lights;!0!==j||!0!==K&&C===b||T.setState(F,C,C===b&&F.id===x);let vn=!1;F.version===ht.__version?(ht.needsLights&&ht.lightsStateVersion!==Ev.state.version||ht.outputEncoding!==nt||$.isInstancedMesh&&!1===ht.instancing||!$.isInstancedMesh&&!0===ht.instancing||$.isSkinnedMesh&&!1===ht.skinning||!$.isSkinnedMesh&&!0===ht.skinning||ht.envMap!==st||!0===F.fog&&ht.fog!==Fe||void 0!==ht.numClippingPlanes&&(ht.numClippingPlanes!==T.numPlanes||ht.numIntersection!==T.numIntersection)||ht.vertexAlphas!==gt||ht.vertexTangents!==ut||ht.morphTargets!==dt||ht.morphNormals!==rn||ht.morphColors!==Mi||ht.toneMapping!==Zr||!0===ve.isWebGL2&&ht.morphTargetsCount!==sn)&&(vn=!0):(vn=!0,ht.__version=F.version);let wo=ht.currentProgram;!0===vn&&(wo=ki(F,B,$));let J1=!1,Xc=!1,Cv=!1;const Qn=wo.getUniforms(),bo=ht.uniforms;if(be.useProgram(wo.program)&&(J1=!0,Xc=!0,Cv=!0),F.id!==x&&(x=F.id,Xc=!0),J1||b!==C){if(Qn.setValue(k,"projectionMatrix",C.projectionMatrix),ve.logarithmicDepthBuffer&&Qn.setValue(k,"logDepthBufFC",2/(Math.log(C.far+1)/Math.LN2)),b!==C&&(b=C,Xc=!0,Cv=!0),F.isShaderMaterial||F.isMeshPhongMaterial||F.isMeshToonMaterial||F.isMeshStandardMaterial||F.envMap){const Si=Qn.map.cameraPosition;void 0!==Si&&Si.setValue(k,z.setFromMatrixPosition(C.matrixWorld))}(F.isMeshPhongMaterial||F.isMeshToonMaterial||F.isMeshLambertMaterial||F.isMeshBasicMaterial||F.isMeshStandardMaterial||F.isShaderMaterial)&&Qn.setValue(k,"isOrthographic",!0===C.isOrthographicCamera),(F.isMeshPhongMaterial||F.isMeshToonMaterial||F.isMeshLambertMaterial||F.isMeshBasicMaterial||F.isMeshStandardMaterial||F.isShaderMaterial||F.isShadowMaterial||$.isSkinnedMesh)&&Qn.setValue(k,"viewMatrix",C.matrixWorldInverse)}if($.isSkinnedMesh){Qn.setOptional(k,$,"bindMatrix"),Qn.setOptional(k,$,"bindMatrixInverse");const Si=$.skeleton;Si&&(ve.floatVertexTextures?(null===Si.boneTexture&&Si.computeBoneTexture(),Qn.setValue(k,"boneTexture",Si.boneTexture,Y),Qn.setValue(k,"boneTextureSize",Si.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Tv=G.morphAttributes;if((void 0!==Tv.position||void 0!==Tv.normal||void 0!==Tv.color&&!0===ve.isWebGL2)&&re.update($,G,wo),(Xc||ht.receiveShadow!==$.receiveShadow)&&(ht.receiveShadow=$.receiveShadow,Qn.setValue(k,"receiveShadow",$.receiveShadow)),F.isMeshGouraudMaterial&&null!==F.envMap&&(bo.envMap.value=st,bo.flipEnvMap.value=st.isCubeTexture&&!1===st.isRenderTargetTexture?-1:1),Xc&&(Qn.setValue(k,"toneMappingExposure",p.toneMappingExposure),ht.needsLights&&function q8(C,B){C.ambientLightColor.needsUpdate=B,C.lightProbe.needsUpdate=B,C.directionalLights.needsUpdate=B,C.directionalLightShadows.needsUpdate=B,C.pointLights.needsUpdate=B,C.pointLightShadows.needsUpdate=B,C.spotLights.needsUpdate=B,C.spotLightShadows.needsUpdate=B,C.rectAreaLights.needsUpdate=B,C.hemisphereLights.needsUpdate=B}(bo,Cv),Fe&&!0===F.fog&&We.refreshFogUniforms(bo,Fe),We.refreshMaterialUniforms(bo,F,U,R,te),Dh.upload(k,ht.uniformsList,bo,Y)),F.isShaderMaterial&&!0===F.uniformsNeedUpdate&&(Dh.upload(k,ht.uniformsList,bo,Y),F.uniformsNeedUpdate=!1),F.isSpriteMaterial&&Qn.setValue(k,"center",$.center),Qn.setValue(k,"modelViewMatrix",$.modelViewMatrix),Qn.setValue(k,"normalMatrix",$.normalMatrix),Qn.setValue(k,"modelMatrix",$.matrixWorld),F.isShaderMaterial||F.isRawShaderMaterial){const Si=F.uniformsGroups;for(let Av=0,Y8=Si.length;Av<Y8;Av++)if(ve.isWebGL2){const K1=Si[Av];N.update(K1,wo),N.bind(K1,wo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return wo}(C,B,G,F,$);be.setMaterial(F,Ye);let st=G.index,gt=1;!0===F.wireframe&&(st=ue.getWireframeAttribute(G),gt=2);const ut=G.drawRange,dt=G.attributes.position;let rn=ut.start*gt,Mi=(ut.start+ut.count)*gt;null!==Fe&&(rn=Math.max(rn,Fe.start*gt),Mi=Math.min(Mi,(Fe.start+Fe.count)*gt)),null!==st?(rn=Math.max(rn,0),Mi=Math.min(Mi,st.count)):null!=dt&&(rn=Math.max(rn,0),Mi=Math.min(Mi,dt.count));const Zr=Mi-rn;if(Zr<0||Zr===1/0)return;A.setup($,F,nt,G,st);let xo,sn=se;if(null!==st&&(xo=De.get(st),sn=he,sn.setIndex(xo)),$.isMesh)!0===F.wireframe?(be.setLineWidth(F.wireframeLinewidth*ae()),sn.setMode(1)):sn.setMode(4);else if($.isLine){let ht=F.linewidth;void 0===ht&&(ht=1),be.setLineWidth(ht*ae()),sn.setMode($.isLineSegments?1:$.isLineLoop?2:3)}else $.isPoints?sn.setMode(0):$.isSprite&&sn.setMode(4);if($.isInstancedMesh)sn.renderInstances(rn,Zr,$.count);else if(G.isInstancedBufferGeometry){const Ev=Math.min(G.instanceCount,void 0!==G._maxInstanceCount?G._maxInstanceCount:1/0);sn.renderInstances(rn,Zr,Ev)}else sn.render(rn,Zr)},this.compile=function(C,B){function G(F,$,Fe){!0===F.transparent&&F.side===fs&&!1===F.forceSinglePass?(F.side=yi,F.needsUpdate=!0,ki(F,$,Fe),F.side=hs,F.needsUpdate=!0,ki(F,$,Fe),F.side=fs):ki(F,$,Fe)}h=pt.get(C),h.init(),m.push(h),C.traverseVisible(function(F){F.isLight&&F.layers.test(B.layers)&&(h.pushLight(F),F.castShadow&&h.pushShadow(F))}),h.setupLights(p.useLegacyLights),C.traverse(function(F){const $=F.material;if($)if(Array.isArray($))for(let Fe=0;Fe<$.length;Fe++)G($[Fe],C,F);else G($,C,F)}),m.pop(),h=null};let P=null;function ne(){Ee.stop()}function we(){Ee.start()}const Ee=new sC;function Ot(C,B,G,F){if(!1===C.visible)return;if(C.layers.test(B.layers))if(C.isGroup)G=C.renderOrder;else if(C.isLOD)!0===C.autoUpdate&&C.update(B);else if(C.isLight)h.pushLight(C),C.castShadow&&h.pushShadow(C);else if(C.isSprite){if(!C.frustumCulled||ie.intersectsSprite(C)){F&&z.setFromMatrixPosition(C.matrixWorld).applyMatrix4(ye);const Ye=He.update(C),nt=C.material;nt.visible&&d.push(C,Ye,nt,G,z.z,null)}}else if((C.isMesh||C.isLine||C.isPoints)&&(C.isSkinnedMesh&&C.skeleton.frame!==Se.render.frame&&(C.skeleton.update(),C.skeleton.frame=Se.render.frame),!C.frustumCulled||ie.intersectsObject(C))){F&&z.setFromMatrixPosition(C.matrixWorld).applyMatrix4(ye);const Ye=He.update(C),nt=C.material;if(Array.isArray(nt)){const st=Ye.groups;for(let gt=0,ut=st.length;gt<ut;gt++){const dt=st[gt],rn=nt[dt.materialIndex];rn&&rn.visible&&d.push(C,Ye,rn,G,z.z,dt)}}else nt.visible&&d.push(C,Ye,nt,G,z.z,null)}const Fe=C.children;for(let Ye=0,nt=Fe.length;Ye<nt;Ye++)Ot(Fe[Ye],B,G,F)}function yn(C,B,G,F){const $=C.opaque,Fe=C.transmissive,Ye=C.transparent;h.setupLightsView(G),!0===j&&T.setGlobalState(p.clippingPlanes,G),Fe.length>0&&function Kn(C,B,G){const F=ve.isWebGL2;null===te&&(te=new ro(1024,1024,{generateMipmaps:!0,type:pe.has("EXT_color_buffer_half_float")?_c:Js,minFilter:Zs,samples:F&&!0===s?4:0}));const $=p.getRenderTarget();p.setRenderTarget(te),p.clear();const Fe=p.toneMapping;p.toneMapping=zr,wr(C,B,G),p.toneMapping=Fe,Y.updateMultisampleRenderTarget(te),Y.updateRenderTargetMipmap(te),p.setRenderTarget($)}($,B,G),F&&be.viewport(S.copy(F)),$.length>0&&wr($,B,G),Fe.length>0&&wr(Fe,B,G),Ye.length>0&&wr(Ye,B,G),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1)}function wr(C,B,G){const F=!0===B.isScene?B.overrideMaterial:null;for(let $=0,Fe=C.length;$<Fe;$++){const Ye=C[$],nt=Ye.object,st=Ye.geometry,gt=null===F?Ye.material:F,ut=Ye.group;nt.layers.test(G.layers)&&Zt(nt,B,G,st,gt,ut)}}function Zt(C,B,G,F,$,Fe){C.onBeforeRender(p,B,G,F,$,Fe),C.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,C.matrixWorld),C.normalMatrix.getNormalMatrix(C.modelViewMatrix),$.onBeforeRender(p,B,G,F,C,Fe),!0===$.transparent&&$.side===fs&&!1===$.forceSinglePass?($.side=yi,$.needsUpdate=!0,p.renderBufferDirect(G,B,F,$,C,Fe),$.side=hs,$.needsUpdate=!0,p.renderBufferDirect(G,B,F,$,C,Fe),$.side=fs):p.renderBufferDirect(G,B,F,$,C,Fe),C.onAfterRender(p,B,G,F,$,Fe)}function ki(C,B,G){!0!==B.isScene&&(B=ee);const F=Be.get(C),$=h.state.lights,Ye=$.state.version,nt=Re.getParameters(C,$.state,h.state.shadowsArray,B,G),st=Re.getProgramCacheKey(nt);let gt=F.programs;F.environment=C.isMeshStandardMaterial?B.environment:null,F.fog=B.fog,F.envMap=(C.isMeshStandardMaterial?oe:Q).get(C.envMap||F.environment),void 0===gt&&(C.addEventListener("dispose",at),gt=new Map,F.programs=gt);let ut=gt.get(st);if(void 0!==ut){if(F.currentProgram===ut&&F.lightsStateVersion===Ye)return br(C,nt),ut}else nt.uniforms=Re.getUniforms(C),C.onBuild(G,nt,p),C.onBeforeCompile(nt,p),ut=Re.acquireProgram(nt,st),gt.set(st,ut),F.uniforms=nt.uniforms;const dt=F.uniforms;(!C.isShaderMaterial&&!C.isRawShaderMaterial||!0===C.clipping)&&(dt.clippingPlanes=T.uniform),br(C,nt),F.needsLights=function X8(C){return C.isMeshLambertMaterial||C.isMeshToonMaterial||C.isMeshPhongMaterial||C.isMeshStandardMaterial||C.isShadowMaterial||C.isShaderMaterial&&!0===C.lights}(C),F.lightsStateVersion=Ye,F.needsLights&&(dt.ambientLightColor.value=$.state.ambient,dt.lightProbe.value=$.state.probe,dt.directionalLights.value=$.state.directional,dt.directionalLightShadows.value=$.state.directionalShadow,dt.spotLights.value=$.state.spot,dt.spotLightShadows.value=$.state.spotShadow,dt.rectAreaLights.value=$.state.rectArea,dt.ltc_1.value=$.state.rectAreaLTC1,dt.ltc_2.value=$.state.rectAreaLTC2,dt.pointLights.value=$.state.point,dt.pointLightShadows.value=$.state.pointShadow,dt.hemisphereLights.value=$.state.hemi,dt.directionalShadowMap.value=$.state.directionalShadowMap,dt.directionalShadowMatrix.value=$.state.directionalShadowMatrix,dt.spotShadowMap.value=$.state.spotShadowMap,dt.spotLightMatrix.value=$.state.spotLightMatrix,dt.spotLightMap.value=$.state.spotLightMap,dt.pointShadowMap.value=$.state.pointShadowMap,dt.pointShadowMatrix.value=$.state.pointShadowMatrix);const rn=ut.getUniforms(),Mi=Dh.seqWithValue(rn.seq,dt);return F.currentProgram=ut,F.uniformsList=Mi,ut}function br(C,B){const G=Be.get(C);G.outputEncoding=B.outputEncoding,G.instancing=B.instancing,G.skinning=B.skinning,G.morphTargets=B.morphTargets,G.morphNormals=B.morphNormals,G.morphColors=B.morphColors,G.morphTargetsCount=B.morphTargetsCount,G.numClippingPlanes=B.numClippingPlanes,G.numIntersection=B.numClipIntersection,G.vertexAlphas=B.vertexAlphas,G.vertexTangents=B.vertexTangents,G.toneMapping=B.toneMapping}Ee.setAnimationLoop(function W(C){P&&P(C)}),typeof self<"u"&&Ee.setContext(self),this.setAnimationLoop=function(C){P=C,de.setAnimationLoop(C),null===C?Ee.stop():Ee.start()},de.addEventListener("sessionstart",ne),de.addEventListener("sessionend",we),this.render=function(C,B){if(void 0===B||!0===B.isCamera){if(!0!==g){if(!0===C.matrixWorldAutoUpdate&&C.updateMatrixWorld(),null===B.parent&&!0===B.matrixWorldAutoUpdate&&B.updateMatrixWorld(),!0===de.enabled&&!0===de.isPresenting&&(!0===de.cameraAutoUpdate&&de.updateCamera(B),B=de.getCamera()),!0===C.isScene&&C.onBeforeRender(p,C,B,y),h=pt.get(C,m.length),h.init(),m.push(h),ye.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),ie.setFromProjectionMatrix(ye),K=this.localClippingEnabled,j=T.init(this.clippingPlanes,K),d=Mt.get(C,f.length),d.init(),f.push(d),Ot(C,B,0,p.sortObjects),d.finish(),!0===p.sortObjects&&d.sort(X,O),!0===j&&T.beginShadows(),M.render(h.state.shadowsArray,C,B),!0===j&&T.endShadows(),!0===this.info.autoReset&&this.info.reset(),H.render(d,C),h.setupLights(p.useLegacyLights),B.isArrayCamera){const F=B.cameras;for(let $=0,Fe=F.length;$<Fe;$++){const Ye=F[$];yn(d,C,Ye,Ye.viewport)}}else yn(d,C,B);null!==y&&(Y.updateMultisampleRenderTarget(y),Y.updateRenderTargetMipmap(y)),!0===C.isScene&&C.onAfterRender(p,C,B),A.resetDefaultState(),x=-1,b=null,m.pop(),h=m.length>0?m[m.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(C,B,G){Be.get(C.texture).__webglTexture=B,Be.get(C.depthTexture).__webglTexture=G;const F=Be.get(C);F.__hasExternalTextures=!0,F.__hasExternalTextures&&(F.__autoAllocateDepthBuffer=void 0===G,F.__autoAllocateDepthBuffer||!0===pe.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),F.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(C,B){const G=Be.get(C);G.__webglFramebuffer=B,G.__useDefaultFramebuffer=void 0===B},this.setRenderTarget=function(C,B=0,G=0){y=C,v=B,_=G;let F=!0,$=null,Fe=!1,Ye=!1;if(C){const st=Be.get(C);void 0!==st.__useDefaultFramebuffer?(be.bindFramebuffer(36160,null),F=!1):void 0===st.__webglFramebuffer?Y.setupRenderTarget(C):st.__hasExternalTextures&&Y.rebindTextures(C,Be.get(C.texture).__webglTexture,Be.get(C.depthTexture).__webglTexture);const gt=C.texture;(gt.isData3DTexture||gt.isDataArrayTexture||gt.isCompressedArrayTexture)&&(Ye=!0);const ut=Be.get(C).__webglFramebuffer;C.isWebGLCubeRenderTarget?($=ut[B],Fe=!0):$=ve.isWebGL2&&C.samples>0&&!1===Y.useMultisampledRTT(C)?Be.get(C).__webglMultisampledFramebuffer:ut,S.copy(C.viewport),I.copy(C.scissor),w=C.scissorTest}else S.copy(L).multiplyScalar(U).floor(),I.copy(V).multiplyScalar(U).floor(),w=J;if(be.bindFramebuffer(36160,$)&&ve.drawBuffers&&F&&be.drawBuffers(C,$),be.viewport(S),be.scissor(I),be.setScissorTest(w),Fe){const st=Be.get(C.texture);k.framebufferTexture2D(36160,36064,34069+B,st.__webglTexture,G)}else if(Ye){const st=Be.get(C.texture);k.framebufferTextureLayer(36160,36064,st.__webglTexture,G||0,B||0)}x=-1},this.readRenderTargetPixels=function(C,B,G,F,$,Fe,Ye){if(!C||!C.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let nt=Be.get(C).__webglFramebuffer;if(C.isWebGLCubeRenderTarget&&void 0!==Ye&&(nt=nt[Ye]),nt){be.bindFramebuffer(36160,nt);try{const st=C.texture,gt=st.format,ut=st.type;if(gt!==Ni&&Te.convert(gt)!==k.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const dt=ut===_c&&(pe.has("EXT_color_buffer_half_float")||ve.isWebGL2&&pe.has("EXT_color_buffer_float"));if(!(ut===Js||Te.convert(ut)===k.getParameter(35738)||ut===ms&&(ve.isWebGL2||pe.has("OES_texture_float")||pe.has("WEBGL_color_buffer_float"))||dt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");B>=0&&B<=C.width-F&&G>=0&&G<=C.height-$&&k.readPixels(B,G,F,$,Te.convert(gt),Te.convert(ut),Fe)}finally{const st=null!==y?Be.get(y).__webglFramebuffer:null;be.bindFramebuffer(36160,st)}}},this.copyFramebufferToTexture=function(C,B,G=0){const F=Math.pow(2,-G),$=Math.floor(B.image.width*F),Fe=Math.floor(B.image.height*F);Y.setTexture2D(B,0),k.copyTexSubImage2D(3553,G,0,0,C.x,C.y,$,Fe),be.unbindTexture()},this.copyTextureToTexture=function(C,B,G,F=0){const $=B.image.width,Fe=B.image.height,Ye=Te.convert(G.format),nt=Te.convert(G.type);Y.setTexture2D(G,0),k.pixelStorei(37440,G.flipY),k.pixelStorei(37441,G.premultiplyAlpha),k.pixelStorei(3317,G.unpackAlignment),B.isDataTexture?k.texSubImage2D(3553,F,C.x,C.y,$,Fe,Ye,nt,B.image.data):B.isCompressedTexture?k.compressedTexSubImage2D(3553,F,C.x,C.y,B.mipmaps[0].width,B.mipmaps[0].height,Ye,B.mipmaps[0].data):k.texSubImage2D(3553,F,C.x,C.y,Ye,nt,B.image),0===F&&G.generateMipmaps&&k.generateMipmap(3553),be.unbindTexture()},this.copyTextureToTexture3D=function(C,B,G,F,$=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Fe=C.max.x-C.min.x+1,Ye=C.max.y-C.min.y+1,nt=C.max.z-C.min.z+1,st=Te.convert(F.format),gt=Te.convert(F.type);let ut;if(F.isData3DTexture)Y.setTexture3D(F,0),ut=32879;else{if(!F.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Y.setTexture2DArray(F,0),ut=35866}k.pixelStorei(37440,F.flipY),k.pixelStorei(37441,F.premultiplyAlpha),k.pixelStorei(3317,F.unpackAlignment);const dt=k.getParameter(3314),rn=k.getParameter(32878),Mi=k.getParameter(3316),Zr=k.getParameter(3315),xo=k.getParameter(32877),sn=G.isCompressedTexture?G.mipmaps[0]:G.image;k.pixelStorei(3314,sn.width),k.pixelStorei(32878,sn.height),k.pixelStorei(3316,C.min.x),k.pixelStorei(3315,C.min.y),k.pixelStorei(32877,C.min.z),G.isDataTexture||G.isData3DTexture?k.texSubImage3D(ut,$,B.x,B.y,B.z,Fe,Ye,nt,st,gt,sn.data):G.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),k.compressedTexSubImage3D(ut,$,B.x,B.y,B.z,Fe,Ye,nt,st,sn.data)):k.texSubImage3D(ut,$,B.x,B.y,B.z,Fe,Ye,nt,st,gt,sn),k.pixelStorei(3314,dt),k.pixelStorei(32878,rn),k.pixelStorei(3316,Mi),k.pixelStorei(3315,Zr),k.pixelStorei(32877,xo),0===$&&F.generateMipmaps&&k.generateMipmap(ut),be.unbindTexture()},this.initTexture=function(C){C.isCubeTexture?Y.setTextureCube(C,0):C.isData3DTexture?Y.setTexture3D(C,0):C.isDataArrayTexture||C.isCompressedArrayTexture?Y.setTexture2DArray(C,0):Y.setTexture2D(C,0),be.unbindTexture()},this.resetState=function(){v=0,_=0,y=null,be.reset(),A.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(Uy.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(n){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!n}}}),class JG extends Uy{}.prototype.isWebGL1Renderer=!0;class NC extends xi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class Jn extends rt{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new E,h=new E,f=[],m=[],p=[],g=[];for(let v=0;v<=i;v++){const _=[],y=v/i;let x=0;0==v&&0==o?x=.5/t:v==i&&l==Math.PI&&(x=-.5/t);for(let b=0;b<=t;b++){const S=b/t;d.x=-e*Math.cos(r+S*s)*Math.sin(o+y*a),d.y=e*Math.cos(o+y*a),d.z=e*Math.sin(r+S*s)*Math.sin(o+y*a),m.push(d.x,d.y,d.z),h.copy(d).normalize(),p.push(h.x,h.y,h.z),g.push(S+x,1-y),_.push(c++)}u.push(_)}for(let v=0;v<i;v++)for(let _=0;_<t;_++){const x=u[v][_],b=u[v+1][_],S=u[v+1][_+1];(0!==v||o>0)&&f.push(u[v][_+1],x,S),(v!==i-1||l<Math.PI)&&f.push(x,b,S)}this.setIndex(f),this.setAttribute("position",new Me(m,3)),this.setAttribute("normal",new Me(p,3)),this.setAttribute("uv",new Me(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jn(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}function Oi(n,e,t){return pv(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function po(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function pv(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}class $h{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class e8 extends $h{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,m=(i-t)/(r-t),p=m*m,g=p*m,v=-h*g+2*h*p-h*m,_=(1+h)*g+(-1.5-2*h)*p+(-.5+h)*m+1,y=(-1-f)*g+(1.5+f)*p+.5*m,x=f*g-f*p;for(let b=0;b!==a;++b)s[b]=v*o[u+b]+_*o[c+b]+y*o[l+b]+x*o[d+b];return s}}class v1 extends $h{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class t8 extends $h{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class xr{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=po(t,this.TimeBufferType),this.values=po(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:po(e.times,Array),values:po(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new t8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new v1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new e8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Oi(i,s,o),this.values=Oi(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&pv(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Oi(this.times),t=Oi(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let m=0;m!==i;++m){const p=t[d+m];if(p!==t[h+m]||p!==t[f+m]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Oi(e,0,o),this.values=Oi(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Oi(this.times,0),t=Oi(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}xr.prototype.TimeBufferType=Float32Array,xr.prototype.ValueBufferType=Float32Array,xr.prototype.DefaultInterpolation=2301;class tl extends xr{}tl.prototype.ValueTypeName="bool",tl.prototype.ValueBufferType=Array,tl.prototype.DefaultInterpolation=2300,tl.prototype.InterpolantFactoryMethodLinear=void 0,tl.prototype.InterpolantFactoryMethodSmooth=void 0;(class _1 extends xr{}).prototype.ValueTypeName="color";(class jh extends xr{}).prototype.ValueTypeName="number";class n8 extends $h{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)jn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class jc extends xr{InterpolantFactoryMethodLinear(e){return new n8(this.times,this.values,this.getValueSize(),e)}}jc.prototype.ValueTypeName="quaternion",jc.prototype.DefaultInterpolation=2301,jc.prototype.InterpolantFactoryMethodSmooth=void 0;class nl extends xr{}nl.prototype.ValueTypeName="string",nl.prototype.ValueBufferType=Array,nl.prototype.DefaultInterpolation=2300,nl.prototype.InterpolantFactoryMethodLinear=void 0,nl.prototype.InterpolantFactoryMethodSmooth=void 0;(class qh extends xr{}).prototype.ValueTypeName="vector";const il={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class x1{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],m=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return m}return null}}}const s8=new x1;class w1{constructor(e){this.manager=void 0!==e?e:s8,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}class o8 extends Error{constructor(e,t){super(e),this.response=t}}class Yh extends w1{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=il.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Mc("img");function l(){u(),il.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class oi extends w1{constructor(e){super(e)}load(e,t,i,r){const s=new ys,o=new Yh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class b1 extends xi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new _e(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const yv=new Ke,M1=new E,S1=new E;class l8{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new q(512,512),this.map=null,this.mapPass=null,this.matrix=new Ke,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ry,this._frameExtents=new q(1,1),this._viewportCount=1,this._viewports=[new St(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;M1.setFromMatrixPosition(e.matrixWorld),t.position.copy(M1),S1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(S1),t.updateMatrixWorld(),yv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(yv),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(yv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const D1=new Ke,qc=new E,vv=new E;class d8 extends l8{constructor(){super(new Sn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new q(4,2),this._viewportCount=6,this._viewports=[new St(2,1,1,1),new St(0,1,1,1),new St(3,1,1,1),new St(1,1,1,1),new St(3,0,1,1),new St(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),qc.setFromMatrixPosition(e.matrixWorld),i.position.copy(qc),vv.copy(i.position),vv.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(vv),i.updateMatrixWorld(),r.makeTranslation(-qc.x,-qc.y,-qc.z),D1.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(D1)}}class E1 extends b1{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new d8}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class C1 extends b1{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}const xv="\\[\\]\\.:\\/",S8=new RegExp("["+xv+"]","g"),wv="[^"+xv+"]",D8="[^"+xv.replace("\\.","")+"]",I8=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",wv)+/(WCOD+)?/.source.replace("WCOD",D8)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",wv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",wv)+"$"),R8=["material","materials","bones","map"];class P8{constructor(e,t,i){const r=i||Ft.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Ft=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(S8,"")}static parseTrackName(t){const i=I8.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==R8.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=P8,n})();Ft.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ft.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ft.prototype.GetterByBindingType=[Ft.prototype._getValue_direct,Ft.prototype._getValue_array,Ft.prototype._getValue_arrayElement,Ft.prototype._getValue_toArray],Ft.prototype.SetterByBindingTypeAndVersioning=[[Ft.prototype._setValue_direct,Ft.prototype._setValue_direct_setNeedsUpdate,Ft.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ft.prototype._setValue_array,Ft.prototype._setValue_array_setNeedsUpdate,Ft.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ft.prototype._setValue_arrayElement,Ft.prototype._setValue_arrayElement_setNeedsUpdate,Ft.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ft.prototype._setValue_fromArray,Ft.prototype._setValue_fromArray_setNeedsUpdate,Ft.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class U1{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Xt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Xg}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Xg);const Y1={type:"change"},Dv={type:"start"},Z1={type:"end"};class z8 extends no{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new E,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:_a.ROTATE,MIDDLE:_a.DOLLY,RIGHT:_a.PAN},this.touches={ONE:xa.ROTATE,TWO:xa.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(A){A.addEventListener("keydown",pt),this._domElementKeyEvents=A},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",pt),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(Y1),i.update(),s=r.NONE},this.update=function(){const A=new E,N=(new jn).setFromUnitVectors(e.up,new E(0,1,0)),me=N.clone().invert(),de=new E,Ce=new jn,Ie=2*Math.PI;return function(){const at=i.object.position;A.copy(at).sub(i.target),A.applyQuaternion(N),a.setFromVector3(A),i.autoRotate&&s===r.NONE&&D(function I(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let mt=i.minAzimuthAngle,Dt=i.maxAzimuthAngle;return isFinite(mt)&&isFinite(Dt)&&(mt<-Math.PI?mt+=Ie:mt>Math.PI&&(mt-=Ie),Dt<-Math.PI?Dt+=Ie:Dt>Math.PI&&(Dt-=Ie),a.theta=mt<=Dt?Math.max(mt,Math.min(Dt,a.theta)):a.theta>(mt+Dt)/2?Math.max(mt,a.theta):Math.min(Dt,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),A.setFromSpherical(a),A.applyQuaternion(me),at.copy(i.target).add(A),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||de.distanceToSquared(i.object.position)>o||8*(1-Ce.dot(i.object.quaternion))>o)&&(i.dispatchEvent(Y1),de.copy(i.object.position),Ce.copy(i.object.quaternion),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",H),i.domElement.removeEventListener("pointerdown",oe),i.domElement.removeEventListener("pointercancel",He),i.domElement.removeEventListener("wheel",Mt),i.domElement.removeEventListener("pointermove",De),i.domElement.removeEventListener("pointerup",ue),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",pt),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new U1,l=new U1;let c=1;const u=new E;let d=!1;const h=new q,f=new q,m=new q,p=new q,g=new q,v=new q,_=new q,y=new q,x=new q,b=[],S={};function w(){return Math.pow(.95,i.zoomSpeed)}function D(A){l.theta-=A}function R(A){l.phi-=A}const U=function(){const A=new E;return function(me,de){A.setFromMatrixColumn(de,0),A.multiplyScalar(-me),u.add(A)}}(),X=function(){const A=new E;return function(me,de){!0===i.screenSpacePanning?A.setFromMatrixColumn(de,1):(A.setFromMatrixColumn(de,0),A.crossVectors(i.object.up,A)),A.multiplyScalar(me),u.add(A)}}(),O=function(){const A=new E;return function(me,de){const Ce=i.domElement;if(i.object.isPerspectiveCamera){A.copy(i.object.position).sub(i.target);let Ae=A.length();Ae*=Math.tan(i.object.fov/2*Math.PI/180),U(2*me*Ae/Ce.clientHeight,i.object.matrix),X(2*de*Ae/Ce.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(U(me*(i.object.right-i.object.left)/i.object.zoom/Ce.clientWidth,i.object.matrix),X(de*(i.object.top-i.object.bottom)/i.object.zoom/Ce.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function L(A){i.object.isPerspectiveCamera?c/=A:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*A)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function V(A){i.object.isPerspectiveCamera?c*=A:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/A)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function J(A){h.set(A.clientX,A.clientY)}function j(A){p.set(A.clientX,A.clientY)}function ae(){1===b.length?h.set(b[0].pageX,b[0].pageY):h.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function k(){1===b.length?p.set(b[0].pageX,b[0].pageY):p.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function xe(){const A=b[0].pageX-b[1].pageX,N=b[0].pageY-b[1].pageY,me=Math.sqrt(A*A+N*N);_.set(0,me)}function be(A){if(1==b.length)f.set(A.pageX,A.pageY);else{const me=Te(A);f.set(.5*(A.pageX+me.x),.5*(A.pageY+me.y))}m.subVectors(f,h).multiplyScalar(i.rotateSpeed);const N=i.domElement;D(2*Math.PI*m.x/N.clientHeight),R(2*Math.PI*m.y/N.clientHeight),h.copy(f)}function Se(A){if(1===b.length)g.set(A.pageX,A.pageY);else{const N=Te(A);g.set(.5*(A.pageX+N.x),.5*(A.pageY+N.y))}v.subVectors(g,p).multiplyScalar(i.panSpeed),O(v.x,v.y),p.copy(g)}function Be(A){const N=Te(A),me=A.pageX-N.x,de=A.pageY-N.y,Ce=Math.sqrt(me*me+de*de);y.set(0,Ce),x.set(0,Math.pow(y.y/_.y,i.zoomSpeed)),L(x.y),_.copy(y)}function oe(A){!1!==i.enabled&&(0===b.length&&(i.domElement.setPointerCapture(A.pointerId),i.domElement.addEventListener("pointermove",De),i.domElement.addEventListener("pointerup",ue)),function re(A){b.push(A)}(A),"touch"===A.pointerType?function T(A){switch(he(A),b.length){case 1:switch(i.touches.ONE){case xa.ROTATE:if(!1===i.enableRotate)return;ae(),s=r.TOUCH_ROTATE;break;case xa.PAN:if(!1===i.enablePan)return;k(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case xa.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function pe(){i.enableZoom&&xe(),i.enablePan&&k()})(),s=r.TOUCH_DOLLY_PAN;break;case xa.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ve(){i.enableZoom&&xe(),i.enableRotate&&ae()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Dv)}(A):function Re(A){let N;switch(A.button){case 0:N=i.mouseButtons.LEFT;break;case 1:N=i.mouseButtons.MIDDLE;break;case 2:N=i.mouseButtons.RIGHT;break;default:N=-1}switch(N){case _a.DOLLY:if(!1===i.enableZoom)return;(function ie(A){_.set(A.clientX,A.clientY)})(A),s=r.DOLLY;break;case _a.ROTATE:if(A.ctrlKey||A.metaKey||A.shiftKey){if(!1===i.enablePan)return;j(A),s=r.PAN}else{if(!1===i.enableRotate)return;J(A),s=r.ROTATE}break;case _a.PAN:if(A.ctrlKey||A.metaKey||A.shiftKey){if(!1===i.enableRotate)return;J(A),s=r.ROTATE}else{if(!1===i.enablePan)return;j(A),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Dv)}(A))}function De(A){!1!==i.enabled&&("touch"===A.pointerType?function M(A){switch(he(A),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;be(A),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;Se(A),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Y(A){i.enableZoom&&Be(A),i.enablePan&&Se(A)})(A),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Q(A){i.enableZoom&&Be(A),i.enableRotate&&be(A)})(A),i.update();break;default:s=r.NONE}}(A):function We(A){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function K(A){f.set(A.clientX,A.clientY),m.subVectors(f,h).multiplyScalar(i.rotateSpeed);const N=i.domElement;D(2*Math.PI*m.x/N.clientHeight),R(2*Math.PI*m.y/N.clientHeight),h.copy(f),i.update()}(A);break;case r.DOLLY:if(!1===i.enableZoom)return;!function te(A){y.set(A.clientX,A.clientY),x.subVectors(y,_),x.y>0?L(w()):x.y<0&&V(w()),_.copy(y),i.update()}(A);break;case r.PAN:if(!1===i.enablePan)return;!function ye(A){g.set(A.clientX,A.clientY),v.subVectors(g,p).multiplyScalar(i.panSpeed),O(v.x,v.y),p.copy(g),i.update()}(A)}}(A))}function ue(A){se(A),0===b.length&&(i.domElement.releasePointerCapture(A.pointerId),i.domElement.removeEventListener("pointermove",De),i.domElement.removeEventListener("pointerup",ue)),i.dispatchEvent(Z1),s=r.NONE}function He(A){se(A)}function Mt(A){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(A.preventDefault(),i.dispatchEvent(Dv),function z(A){A.deltaY<0?V(w()):A.deltaY>0&&L(w()),i.update()}(A),i.dispatchEvent(Z1))}function pt(A){!1===i.enabled||!1===i.enablePan||function ee(A){let N=!1;switch(A.code){case i.keys.UP:A.ctrlKey||A.metaKey||A.shiftKey?R(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):O(0,i.keyPanSpeed),N=!0;break;case i.keys.BOTTOM:A.ctrlKey||A.metaKey||A.shiftKey?R(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):O(0,-i.keyPanSpeed),N=!0;break;case i.keys.LEFT:A.ctrlKey||A.metaKey||A.shiftKey?D(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):O(i.keyPanSpeed,0),N=!0;break;case i.keys.RIGHT:A.ctrlKey||A.metaKey||A.shiftKey?D(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):O(-i.keyPanSpeed,0),N=!0}N&&(A.preventDefault(),i.update())}(A)}function H(A){!1!==i.enabled&&A.preventDefault()}function se(A){delete S[A.pointerId];for(let N=0;N<b.length;N++)if(b[N].pointerId==A.pointerId)return void b.splice(N,1)}function he(A){let N=S[A.pointerId];void 0===N&&(N=new q,S[A.pointerId]=N),N.set(A.pageX,A.pageY)}function Te(A){return S[(A.pointerId===b[0].pointerId?b[1]:b[0]).pointerId]}i.domElement.addEventListener("contextmenu",H),i.domElement.addEventListener("pointerdown",oe),i.domElement.addEventListener("pointercancel",He),i.domElement.addEventListener("wheel",Mt,{passive:!1}),this.update()}}function V8(n,e){if(1&n){const t=em();wt(0,"main")(1,"section")(2,"p",3)(3,"a",4),Wi("click",function(){return Bn(t),Un(bn().showing())}),In(4,"span",5),Vt(5," Back !!!"),bt()()()()}if(2&n){const t=bn();fi(4),ii("innerHtml",t.youtubeSymbol,Hi)}}function H8(n,e){if(1&n){const t=em();wt(0,"main")(1,"header")(2,"h1"),Vt(3,"Kak Nanda"),In(4,"span",5),bt()(),In(5,"blockquote"),wt(6,"section")(7,"p"),Vt(8,"Hi, My name is Muhammad Ananda Pratama."),bt(),wt(9,"p"),Vt(10,"After earning my Diploma from State Polytechnic of Lampung in 2013, I entered the Technology and Information world to explore my passion for Designing and Programming."),bt(),wt(11,"p"),Vt(12,"I\u2019ve build many monolithic and microservices architecture projects for almost 10 years. Apart from a full time job, i am a freelancer who helping out with client jobs or teach a programming languages. "),bt(),wt(13,"p"),Vt(14,"Best Regards,"),bt(),wt(15,"p"),Vt(16,"Muhammad Ananda Pratama"),bt()(),wt(17,"section",6)(18,"h2",7),Vt(19,"Recent Personal Projects"),bt(),wt(20,"p",7),Vt(21,"Yes, this is only personal projects"),bt(),wt(22,"img",8),Wi("mouseover",function(){return Bn(t),Un(bn().createPorto1())})("mouseleave",function(){return Bn(t),Un(bn().removePorto1())}),bt(),wt(23,"p",7)(24,"a",9),In(25,"span",5),Vt(26," SIPJKPCD"),bt()(),wt(27,"img",10),Wi("mouseover",function(){return Bn(t),Un(bn().createPorto2())})("mouseleave",function(){return Bn(t),Un(bn().removePorto2())}),bt(),wt(28,"p",7)(29,"a",11),In(30,"span",5),Vt(31," Youtube Channel"),bt()(),wt(32,"img",12),Wi("mouseover",function(){return Bn(t),Un(bn().createPorto3())})("mouseleave",function(){return Bn(t),Un(bn().removePorto3())}),bt(),wt(33,"p",7)(34,"a",13),In(35,"span",5),Vt(36," The Imperil Ground Website"),bt()(),wt(37,"img",14),Wi("mouseover",function(){return Bn(t),Un(bn().createPorto4())})("mouseleave",function(){return Bn(t),Un(bn().removePorto4())}),bt(),wt(38,"p",7)(39,"a",15),In(40,"span",5),Vt(41," Kak Nanda Playground"),bt()(),wt(42,"img",16),Wi("mouseover",function(){return Bn(t),Un(bn().createPorto5())})("mouseleave",function(){return Bn(t),Un(bn().removePorto5())}),bt(),wt(43,"p",7)(44,"a",17),In(45,"span",5),Vt(46," Password Managers"),bt()(),wt(47,"img",18),Wi("mouseover",function(){return Bn(t),Un(bn().createPorto6())})("mouseleave",function(){return Bn(t),Un(bn().removePorto6())}),bt(),wt(48,"p",7)(49,"a",17),In(50,"span",5),Vt(51," KakNanda.com"),bt()(),wt(52,"blockquote")(53,"p",7),Vt(54,"Thank you for visiting me"),bt(),wt(55,"p",7),Vt(56,"NB : I'm a back end not front end "),In(57,"span",5),bt()()(),wt(58,"section")(59,"p",7)(60,"a",4),Wi("click",function(){return Bn(t),Un(bn().hide())}),In(61,"span",5),Vt(62," Click Me !!!"),bt()(),wt(63,"p",7),Vt(64,"LinkedIn : "),wt(65,"a",19),Vt(66," Muhammad Ananda Pratama"),bt()(),wt(67,"p",7),Vt(68,"KakNanda@2023"),bt()()()}if(2&n){const t=bn();fi(4),ii("innerHtml",t.badgeSymbol,Hi),fi(21),ii("innerHtml",t.symbol,Hi),fi(5),ii("innerHtml",t.youtubeSymbol,Hi),fi(5),ii("innerHtml",t.moneySymbol,Hi),fi(5),ii("innerHtml",t.gameSymbol,Hi),fi(5),ii("innerHtml",t.phoneSymbol,Hi),fi(5),ii("innerHtml",t.shitSymbol,Hi),fi(7),ii("innerHtml",t.badgeSymbol,Hi),fi(4),ii("innerHtml",t.gameSymbol,Hi)}}let G8=(()=>{class n{constructor(){this.show=!0,this.badgeSymbol="&#x1F396;",this.shitSymbol="&#128169",this.phoneSymbol="&#128241",this.gameSymbol="&#127918",this.moneySymbol="&#128178",this.youtubeSymbol="&#128250",this.symbol="&#128223",this.scene=new NC,this.renderer=new Uy,this.t=document.body.getBoundingClientRect().top,this.avaTexture=(new oi).load("/assets/ava.png"),this.ava=new ft(new Jn(2,32,32),new Tt({map:this.avaTexture})),this.porto1Texture=(new oi).load("/assets/sipjkpcd.png"),this.porto1=new ft(new Xn(4,2.2,2.2),new Tt({map:this.porto1Texture})),this.porto2Texture=(new oi).load("/assets/youtube.png"),this.porto2=new ft(new Jn(2,32,32),new Tt({map:this.porto2Texture})),this.porto3Texture=(new oi).load("/assets/theimperilground.png"),this.porto3=new ft(new Jn(2,32,32),new Tt({map:this.porto3Texture})),this.porto4Texture=(new oi).load("/assets/game.png"),this.porto4=new ft(new Jn(2,32,32),new Tt({map:this.porto4Texture})),this.porto5Texture=(new oi).load("/assets/password managers.png"),this.porto5=new ft(new Jn(2,32,32),new Tt({map:this.porto5Texture})),this.porto6Texture=(new oi).load("/assets/personal.png"),this.porto6=new ft(new Xn(4,2.2,2.2),new Tt({map:this.porto6Texture})),this.porto1Far=new ft(new Xn(20,15,15),new Tt({map:this.porto1Texture})),this.porto2Far=new ft(new Jn(20,32,32),new Tt({map:this.porto2Texture})),this.porto3Far=new ft(new Jn(20,32,32),new Tt({map:this.porto3Texture})),this.porto4Far=new ft(new Jn(20,32,32),new Tt({map:this.porto4Texture})),this.porto5Far=new ft(new Jn(20,32,32),new Tt({map:this.porto5Texture})),this.porto6Far=new ft(new Xn(20,15,15),new Tt({map:this.porto6Texture}))}ngOnInit(){const t=new Sn(75,window.innerWidth/window.innerHeight,.1,1e3);this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement);const i=new E1(16777215);i.position.set(5,5,5);const r=new C1(16777215);this.scene.add(i,r);const s=new z8(t,this.renderer.domElement),o=(new oi).load("/assets/spring.png"),a=new ft(new Jn(3,32,32),new Tt({map:o}));this.scene.add(a);const l=(new oi).load("/assets/swift.png"),c=new ft(new Xn(4,4,4),new Tt({map:l}));this.scene.add(c);const u=(new oi).load("/assets/oracle-db.png"),d=new ft(new Xn(3,3,3),new Tt({map:u}));this.scene.add(d);const h=(new oi).load("/assets/logo.png"),f=new ft(new Jn(3,32,32),new Tt({map:h}));this.scene.add(f);const m=(new oi).load("/assets/nodejs.jpeg"),p=new ft(new Xn(3,3,3),new Tt({map:m}));this.scene.add(p);const g=(new oi).load("/assets/nginx.jpeg"),v=new ft(new Xn(5,3,3),new Tt({map:g}));this.scene.add(v);const _=(new oi).load("/assets/ionic.png"),y=new ft(new Xn(4,4,4),new Tt({map:_}));this.scene.add(y);let x=1,b=1;const S=()=>{requestAnimationFrame(S),x+=.01,b+=.05,this.ava.rotation.x+=.001,this.ava.rotation.y+=.01,this.ava.rotation.z+=.001,a.rotation.x+=.01,a.rotation.y+=.005,a.rotation.z+=.01,a.position.x=5*Math.sin(x)+0,a.position.y=10*Math.cos(x)+0,a.position.z=15*Math.tan(x)+0,c.rotation.x+=.01,c.rotation.y+=.005,c.rotation.z+=.01,c.position.y=5*Math.sin(x)+0,c.position.x=15*Math.cos(x)+0,c.position.z=15*Math.tan(x)+0,d.rotation.x+=.01,d.rotation.y+=.005,d.rotation.z+=.01,d.position.x=15*Math.sin(x)+0,d.position.y=5*Math.cos(x)+0,d.position.z=15*Math.tan(x)+0,f.rotation.x+=.01,f.rotation.y+=.005,f.rotation.z+=.01,f.position.x=10*Math.tan(x)+0,f.position.y=25*Math.cos(x)+0,f.position.z=50*Math.sin(x)+0,p.rotation.x+=.01,p.rotation.y+=.005,p.rotation.z+=.01,p.position.x=25*Math.cos(x)+0,p.position.y=10*Math.tan(x)+0,p.position.z=50*Math.sin(x)+0,v.rotation.x+=.01,v.rotation.y+=.005,v.rotation.z+=.01,v.position.x=5*Math.cos(x)+0,v.position.y=5*Math.tan(x)+0,v.position.z=50*Math.sin(x)+0,y.rotation.x+=.01,y.rotation.y+=.005,y.rotation.z+=.01,y.position.x=15*Math.cos(x)+0,y.position.y=15*Math.tan(x)+0,y.position.z=50*Math.sin(x)+0,this.porto1.rotation.x+=.001,this.porto1.rotation.y+=.01,this.porto1.rotation.z+=.001,this.porto2.rotation.x+=.001,this.porto2.rotation.y+=.01,this.porto2.rotation.z+=.001,this.porto3.rotation.x+=.001,this.porto3.rotation.y+=.01,this.porto3.rotation.z+=.001,this.porto4.rotation.x+=.001,this.porto4.rotation.y+=.01,this.porto4.rotation.z+=.001,this.porto5.rotation.x+=.001,this.porto5.rotation.y+=.01,this.porto5.rotation.z+=.001,this.porto6.rotation.x+=.001,this.porto6.rotation.y+=.01,this.porto6.rotation.z+=.001,this.porto1Far.rotation.x+=.001,this.porto1Far.rotation.y+=.01,this.porto1Far.rotation.z+=.001,this.porto1Far.position.x=30*Math.cos(x)+0,this.porto1Far.position.y=0,this.porto1Far.position.z=30*Math.sin(x)+0,this.porto2Far.rotation.x+=.001,this.porto2Far.rotation.y+=.01,this.porto2Far.rotation.z+=.001,this.porto2Far.position.x=70*Math.sin(x)+0,this.porto2Far.position.y=0,this.porto2Far.position.z=70*Math.cos(x)+0,this.porto3Far.rotation.x+=.001,this.porto3Far.rotation.y+=.01,this.porto3Far.rotation.z+=.001,this.porto3Far.position.x=130*Math.cos(x)+0,this.porto3Far.position.y=0,this.porto3Far.position.z=130*Math.sin(x)+0,this.porto4Far.rotation.x+=.001,this.porto4Far.rotation.y+=.01,this.porto4Far.rotation.z+=.001,this.porto4Far.position.x=180*Math.cos(b)+5,this.porto4Far.position.y=0,this.porto4Far.position.z=180*Math.sin(b)+5,this.porto5Far.rotation.x+=.001,this.porto5Far.rotation.y+=.01,this.porto5Far.rotation.z+=.001,this.porto5Far.position.x=220*Math.sin(b)+5,this.porto5Far.position.y=0,this.porto5Far.position.z=220*Math.cos(b)+5,this.porto6Far.rotation.x+=.001,this.porto6Far.rotation.y+=.01,this.porto6Far.rotation.z+=.001,this.porto6Far.position.x=270*Math.cos(b)+5,this.porto6Far.position.y=0,this.porto6Far.position.z=270*Math.sin(b)+5,s.update(),this.renderer.render(this.scene,t)};t.position.z=5,this.renderer.render(this.scene,t),s.update(),S()}createPorto1(){this.porto1.position.x=3,this.porto1.position.y=0,this.porto1.position.z=0,this.scene.add(this.porto1)}removePorto1(){this.scene.remove(this.porto1)}createPorto2(){this.porto2.position.x=3,this.porto2.position.y=0,this.porto2.position.z=0,this.scene.add(this.porto2)}removePorto2(){this.scene.remove(this.porto2)}createPorto3(){this.porto3.position.x=3,this.porto3.position.y=0,this.porto3.position.z=0,this.scene.add(this.porto3)}removePorto3(){this.scene.remove(this.porto3)}createPorto4(){this.porto4.position.x=3,this.porto4.position.y=0,this.porto4.position.z=0,this.scene.add(this.porto4)}removePorto4(){this.scene.remove(this.porto4)}createPorto5(){this.porto5.position.x=3,this.porto5.position.y=0,this.porto5.position.z=0,this.scene.add(this.porto5)}removePorto5(){this.scene.remove(this.porto5)}createPorto6(){this.porto6.position.x=3,this.porto6.position.y=0,this.porto6.position.z=0,this.scene.add(this.porto6)}removePorto6(){this.scene.remove(this.porto6)}hide(){this.createPorto1Far(),this.createPorto2Far(),this.createPorto3Far(),this.createPorto4Far(),this.createPorto5Far(),this.createPorto6Far(),this.show=!1}showing(){this.removePorto1Far(),this.removePorto2Far(),this.removePorto3Far(),this.removePorto4Far(),this.removePorto5Far(),this.removePorto6Far(),this.show=!0}createPorto1Far(){this.porto1Far.position.x=20,this.porto1Far.position.y=0,this.porto1Far.position.z=-80,this.scene.add(this.porto1Far)}removePorto1Far(){this.scene.remove(this.porto1Far)}createPorto2Far(){this.porto2Far.position.x=-50,this.porto2Far.position.y=-20,this.porto2Far.position.z=-50,this.scene.add(this.porto2Far)}removePorto2Far(){this.scene.remove(this.porto2Far)}createPorto3Far(){this.porto3Far.position.x=30,this.porto3Far.position.y=0,this.porto3Far.position.z=30,this.scene.add(this.porto3Far)}removePorto3Far(){this.scene.remove(this.porto3Far)}createPorto4Far(){this.porto4Far.position.x=-20,this.porto4Far.position.y=0,this.porto4Far.position.z=80,this.scene.add(this.porto4Far)}removePorto4Far(){this.scene.remove(this.porto4Far)}createPorto5Far(){this.porto5Far.position.x=20,this.porto5Far.position.y=0,this.porto5Far.position.z=-130,this.scene.add(this.porto5Far)}removePorto5Far(){this.scene.remove(this.porto5Far)}createPorto6Far(){this.porto6Far.position.x=-20,this.porto6Far.position.y=0,this.porto6Far.position.z=130,this.scene.add(this.porto6Far)}removePorto6Far(){this.scene.remove(this.porto6Far)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=hl({type:n,selectors:[["app-cube"]],decls:4,vars:2,consts:[["id","canvas",2,"height","100%","width","100%"],["canvas",""],[4,"ngIf"],[1,"font-center"],[3,"click"],[3,"innerHtml"],[1,"light"],[1,"center","font-center"],["src","/assets/sipjkpcd.png","alt","Game",1,"center",3,"mouseover","mouseleave"],["href","https://sipjkpcd.theimperilground.com/home","target","_blank"],["src","/assets/youtube.png","alt","Game",1,"center",3,"mouseover","mouseleave"],["href","https://www.youtube.com/watch?v=K2hz-WiUDbE","target","_blank"],["src","/assets/theimperilground.png","alt","Game",1,"center",3,"mouseover","mouseleave"],["href","https://staging.theimperilground.com/","target","_blank"],["src","/assets/game.png","alt","Game",1,"center",3,"mouseover","mouseleave"],["href","https://simmer.io/@KakNanda/kak-nanda-playground","target","_blank"],["src","/assets/password managers.png","alt","Game",1,"center",3,"mouseover","mouseleave"],["href","https://play.google.com/store/apps/details?id=com.juniorprogrammer.starter","target","_blank"],["src","/assets/personal.png","alt","Game",1,"center",3,"mouseover","mouseleave"],["href","https://www.linkedin.com/in/muhammad-ananda-pratama-914030118","target","_blank"]],template:function(t,i){1&t&&(In(0,"canvas",0,1),Zp(2,V8,6,1,"main",2),Zp(3,H8,69,9,"main",2)),2&t&&(fi(2),ii("ngIf",!i.show),fi(1),ii("ngIf",i.show))},dependencies:[dS]}),n})(),W8=(()=>{class n{constructor(){this.title="profile-page-2023"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=hl({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&In(0,"app-cube")},dependencies:[G8]}),n})(),$8=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=As({type:n,bootstrap:[W8]}),n.\u0275inj=Kr({imports:[Mk,gz]}),n})();bk().bootstrapModule($8).catch(n=>console.error(n))}},At=>{At(At.s=493)}]);